 <chapter id="features.safe-mode">
  <title>Safe mode</title>
  <para>
   Le "Safe Mode" est le mode de s&eacute;curit&eacute; de PHP : une solution au probl&egrave;me
   de partage de PHP sur un serveur. Ce syst&egrave;me p&ecirc;che au niveau de l'architecture
   car il n'est pas correct de tenter de r&eacute;soudre ce probl&egrave;me au niveau
   de PHP, mais les solutions alternatives bas&eacute;es sur le serveur web et l'OS
   ne sont pas r&eacute;alistes. De nombreux acteurs, notamment les fournisseurs
   d'h&eacute;bergement, utilise le "Safe Mode".
  </para>
  <para>
   Les directives de configuration qui contr&ocirc;lent le safe mode sont :
   <informalexample>
    <programlisting role="ini">
safe_mode = Off
open_basedir =
safe_mode_exec_dir =
safe_mode_allowed_env_vars = PHP_
safe_mode_protected_env_vars = LD_LIBRARY_PATH
disable_functions =
    </programlisting>
   </informalexample>
  </para>
  <para>
   Lorsque safe mod est actif, PHP v&eacute;rifie que le propri&eacute;taire du script
   courant est le m&ecirc;me que le propri&eacute;taire de fichier qui seront manipul&eacute;
   par ce script. Par exemple, si on a la situation suivante :
   <informalexample>
    <programlisting role="ls">
-rw-rw-r--    1 rasmus   rasmus       33 Jul  1 19:20 script.php
-rw-r--r--    1 root     root       1116 May 26 18:01 /etc/passwd
    </programlisting>
   </informalexample>
   Ex&eacute;cuter le script <filename>script.php</filename>
   <informalexample>
    <programlisting role="php">
&lt;?php
 readfile('/etc/passwd');
?&gt;
    </programlisting>
   </informalexample>
   g&eacute;n&eacute;rera cette erreur, si le safe mode est activ&eacute; :
   <informalexample>
    <programlisting role="php">
Warning: SAFE MODE Restriction in effect. The script whose uid is 500 is not
allowed to access /etc/passwd owned by uid 0 in /docroot/script.php on line 2
   </programlisting>
  </informalexample>
 </para>
  <para>
   Si vou utilisez la directive open_basedir au lieu du safe mode, alors les
   manipulations seront limit&eacute;es aux fichiers situ&eacute;s dans les dossiers
   sp&eacute;cifi&eacute;s. Par exemple :
   <informalexample>
    <programlisting role="ini">
&lt;Directory /docroot&gt;
php_admin_value open_basedir /docroot
&lt;/Directory&gt;
   </programlisting>
  </informalexample>
  Si vous ex&eacute;cutez le script <filename>script.php</filename> ci-dessus avec
   la configuration d'open_basedir le r&eacute;sultat sera l'affichage suivant :
   <informalexample>
    <programlisting role="php">
Warning: open_basedir restriction in effect. File is in wrong directory in
/docroot/script.php on line 2
    </programlisting>
   </informalexample>
  </para>
  <para>
   Vous pouvez aussi d&eacute;sactiver individuellement les fonctions. Par exemple,
   en ajoutant cette ligne dans le fichier <filename>php.ini</filename> :
   <informalexample>
    <programlisting role="ini">
disable_functions readfile,system
    </programlisting>
   </informalexample>
   toute utilisation des fonctions  <function>readfile</function> et
   <function>system</function> g&eacute;n&eacute;rera l'affichage suivant :
   <informalexample>
    <programlisting role="php">
Warning: readfile() has been disabled for security reasons in
/docroot/script.php on line 2
    </programlisting>
   </informalexample>
  </para>
 </chapter>
<!-- Keep this comment at the end of the file
Local variables:
mode: sgml
sgml-omittag:t
sgml-shorttag:t
sgml-minimize-attributes:nil
sgml-always-quote-attributes:t
sgml-indent-step:1
sgml-indent-data:t
sgml-parent-document:nil
sgml-default-dtd-file:"../manual.ced"
sgml-exposed-tags:nil
sgml-local-catalogs:nil
sgml-local-ecat-files:nil
End:
-->
