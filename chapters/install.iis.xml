<?xml version="1.0" encoding="iso-8859-1"?>
<!-- $Revision: 1.3 $ -->
  <sect1 id="install.iis">
 <title>Installation avec les serveurs IIS/PWS</title>
 <para>
  Cette section contient des notes sur l'installation de PHP avec IIS (
  Microsoft Internet Information Server) :
  <link linkend="install.iis.iis3">PWS/IIS 3</link>,
  <link linkend="install.iis.pws4">PWS 4 ou plus r&eacute;cent</link> et
  <link linkend="install.iis.iis4">IIS 4 ou plus r&eacute;cent</link>.
 </para>
 <sect2 id="install.iis.iis3">
 <title>Windows et PWS/IIS 3</title>
 <simpara>
  La m&eacute;thode recommand&eacute;e pour configurer ces serveurs
  est d'utiliser le fichier INF inclus dans la distribution
  (<filename>php_iis_reg.inf</filename>).
  Vous pouvez &eacute;diter ce fichier, pour vous assurer que les
  extensions et les dossiers d'installation de PHP sont bien
  ceux de votre configuration. Ou alors, vous pouvez suivre les
  instructions suivantes :
 </simpara>
 <warning>
 <para>
  ATTENTION: Ces instructions requi&egrave;rent la manipulation du fichier de
  registre de Windows. Une erreur peut laisser votre syst&egrave;me dans un
  &eacute;tat instable. Nous vous recommandons vivement de sauvegarder ce
  fichier en lieu s&ucirc;r. L'&eacute;quipe de d&eacute;veloppement et les
  traducteurs de cette documentation ne pourront pas &ecirc;tre tenus responsable
  d'un quelconque dommage qui pourrait survenir dans votre registre.
 </para>
 </warning>

 <para>
  <itemizedlist>
   <listitem>
    <simpara>
     Lancez Regedit.
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     Naviguez jusqu'&agrave; : <literal>HKEY_LOCAL_MACHINE /System
     /CurrentControlSet /Services /W3Svc /Parameters
     /ScriptMap</literal>.
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     Dans le menu "edit", s&eacute;lectionnez : <literal>New->String Value</literal>.
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     Entrez l'extension que vous voulez utiliser pour les scripts PHP.
     Par exemple : <literal>.php</literal>
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     Double-cliquez sur la cha&icirc;ne, et entrez le chemin jusqu'&agrave;
     <literal>php.exe</literal> dans le champ "value data". ex:
     <literal>c:\php\php.exe</literal>.
    </simpara>
   </listitem>
  </itemizedlist>
    </para>
    <para>
  Les &eacute;tapes suivantes n'affectent pas la configuration du serveur
  web, et ne s'appliquent que si vous voulez que vos scripts PHP
  soient ex&eacute;cut&eacute;s lorsqu'il sont ex&eacute;cut&eacute;s en ligne de commande
  (par exemple, run <filename>c:\messcripts\test.php</filename>)
  ou en double-cliquant sur l'icone. Vous pouvez ignorer
  ces &eacute;tapes si vous pr&eacute;f&eacute;rez que vos scripts PHP s'ouvrent dans un
  &eacute;diteur de texte, plut&ocirc;t que de les voir s'ex&eacute;cuter lorsque vous
  double-cliquez dessus.
    </para>
    <para>
 <itemizedlist>
   <listitem>
    <simpara>
     R&eacute;p&eacute;tez ces instructions pour toutes les extensions que vous voulez
     associer aux scripts PHP.
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     Naviguez jusqu'&agrave; : <literal>HKEY_CLASSES_ROOT</literal>
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     Dans le menu edit, s&eacute;lectionnez: <literal>New->Key</literal>.
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     Donnez le nom de votre extension &agrave; la cl&eacute; :
     ex: <literal>.php</literal>
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     S&eacute;lectionnez le nom de la nouvelle cl&eacute; dans le panneau de
     droite, et double-cliquez dans "default value", puis entrez
     <literal>phpfile</literal>.
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     R&eacute;p&eacute;tez ces instructions pour toutes les extensions que vous avez
     associ&eacute; aux scripts PHP.
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     Cr&eacute;ez une autre <literal>New->Key</literal> sous
     <literal>HKEY_CLASSES_ROOT</literal> et nommez-la
     <literal>phpfile</literal>.
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     S&eacute;lectionnez la nouvelle cl&eacute; <literal>phpfile</literal>  et dans
     le panneau de droite, double-cliquez dans "default value" et
     entrez <literal>PHP Script</literal>.
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     Faites un clic droit dans <literal>phpfile</literal> et s&eacute;lectionnez
     <literal>New->Key</literal>, appelez-le <literal>Shell</literal>.
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     Faites un clic droit dans <literal>Shell</literal> et s&eacute;lectionnez
     <literal>New->Key</literal>, appelez-le <literal>open</literal>.
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     Faites un clic droit dans <literal>open</literal> et s&eacute;lectionnez
     <literal>New->Key</literal>, appelez-le
     <literal>command</literal>.
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     S&eacute;lectionnez la nouvelle cl&eacute; <literal>command</literal> et dans le
     panneau de droite, faites un double-clic dans "default value", puis entrez
     le chemin jusqu'&agrave; <literal>php.exe</literal>. ex:
     <literal>c:\php\php.exe -q %1</literal>. (n'oubliez pas le
     <literal>%1</literal>).
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     Quittez Regedit.
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     Si vous utilisez PWS sous Windows, red&eacute;marrez pour prendre en
     compte le nouveau registre.
    </simpara>
   </listitem>
  </itemizedlist>
    </para>
 <simpara>
  Les utilisateurs de PWS et IIS 3 sont pr&ecirc;ts &agrave; utiliser
  leur serveur. Avec IIS 3, vous pouvez utiliser un <ulink
  url="&url.iiscfg;">outil</ulink> bien pratique de
  Steven Genusa pour configurer votre carte des scripts.
 </simpara>
 </sect2>
 <sect2 id="install.iis.pws4">
 <title>Windows et PWS 4 ou plus r&eacute;cent</title>
 <simpara>
  Pour installer PHP sous Windows avec PWS 4 ou plus r&eacute;cent,
  vous avez deux options : l'une est d'avoir PHP sous
  forme de CGI, l'autre est d'utiliser les modules
  ISAPI, sous forme de DLL.
 </simpara>
     
<para>
  Si vous optez pour le CGI, faites ceci :
  <itemizedlist>
   <listitem>
    <simpara>
     Editez le fichier <filename>pws-php4cgi.reg</filename>
     (dans le dossier <filename>sapi</filename>) pour indiquer la
     localisation de votre fichier <filename>php.exe</filename>.
     Les slash doivent &ecirc;tre &eacute;chapp&eacute;s. Par exemple :
     <literal>[HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Services\w3svc\parameters\Script Map] ".php"="C:\\PHP\\php.exe"</literal>
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     Dans le gestionnaire PWS Manager, faites un clic droit sur les
     dossiers qui supporteront PHP, et s&eacute;lectionnez "Properties".
     Cochez l'option "Execute" et confirmez.
    </simpara>
   </listitem>
  </itemizedlist>
 </para>
 <para>
  Si vous optez pour les modules ISAPI, faites ceci :
  <itemizedlist>
   <listitem>
    <simpara>
     Editez le fichier <filename>pws-php4isapi.reg</filename>
     (dans le dossier <filename>sapi</filename>) pour indiquer la
     localisation de votre fichier <filename>php4isapi.dll</filename>.
     Les slash doivent &ecirc;tre &eacute;chapp&eacute;s. Par exemple :
     <literal>[HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Services\w3svc\parameters\Script Map] ".php"="C:\\PHP\\sapi\\php4isapi.dll"</literal>
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     Dans le gestionnaire PWS Manager, faites un clic droit sur les
     dossiers qui supporteront PHP, et s&eacute;lectionnez "Properties".
     Cochez l'option "Execute" et confirmez.
    </simpara>
   </listitem>
  </itemizedlist>
 </para>
 </sect2>

   <sect2 id="install.iis.iis4">
 <title>Windows NT/2000 et IIS 4 ou plus r&eacute;cent</title>
 <simpara>
  Pour installer PHP sous Windows  NT/2000 server avec IIS 4
  ou plus r&eacute;cent, vous avez deux options : l'une est d'avoir PHP sous
  forme de CGI, l'autre est d'utiliser les modules
  SAPI, sous forme de DLL.
 </simpara>
 <simpara>
  Dans les deux cas, vous devez lancer la console "Microsoft Management"
  (elle peut aussi s'appeler "Internet Services Manager". Elle est situ&eacute;e
  soit dans "Windows NT 4.0 Option Pack" ou dans "Control
  Panel=&gt;Administrative Tools" sous Windows 2000). Puis, faites un
  clic droit sur votre dossier web (qui apparaitra probablement
  comme <filename>Default Web Server</filename>), et s&eacute;lectionnez "Properties".
 </simpara>
 <para>
  Si vous optez pour le CGI, faites ceci :
  <itemizedlist>
   <listitem>
    <simpara>
     Sous "Home Directory", "Virtual Directory", ou
     "Directory", cliquez sur le bouton "Configuration",
     et s&eacute;lectionnez l'onglet "App Mappings".
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     Cliquez sur "Add", puis dans la bo&icirc;te "Executable", tapez :
     <literal>c:\php\php.exe</literal> (si vous avez install&eacute; PHP
     dans le dossier <literal>c:\php\</literal>.)
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     Dans la bo&icirc;te "Extension", tapez le nom de l'extension que vous voulez
     associer aux scripts PHP. Laissez "Method exclusions"
     vide, et cochez "Script engine". Vous pouvez aussi pr&eacute;f&eacute;rer cocher
     la bo&icirc;te 'check that file exists' - pour un co&ucirc;t faible,
     IIS (ou PWS) s'assurera que le script existe, et r&eacute;soudra
     les probl&egrave;mes d'autentification avant de d&eacute;marrer PHP.
     Cela signifie que vous obtiendrez des messages d'erreur 404 intelligents,
     plut&ocirc;t que d'avoir simplement une plainte du serveur comme quoi les
     CGI n'ont rien retourn&eacute;.
    </simpara>
    <simpara>
     R&eacute;p&eacute;tez les &eacute;tapes 3 et 4 pour chaque extension que vous
     souhaitez associer aux scripts PHP.
     (<literal>.php</literal> et <literal>.phtml</literal>
     sont les plus r&eacute;pandues.)
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     Configurer la s&eacute;curit&eacute; n&eacute;cessaire (dans "Internet
     Service Manager"), et si votre serveur NT utilise NTFS,
     ajoutez les droits ad&eacute;quats pour I_USR_, au dossier qui
     contient <literal>php.exe</literal>.
    </simpara>
   </listitem>
  </itemizedlist>
    </para>
    
<para>
  Si vous optez pour les modules ISAPI, faites ceci :
  <itemizedlist>
   <listitem>
    <simpara>
     Si vous ne voulez pas effectuer des authentifications HTTP avec
     PHP, vous pouvez (et devez) sauter cette &eacute;tape. Avec
     ISAPI Filters, ajoutez un nouveau filtre ISAPI. Utilisez
     PHP comme nom de filtre, et ajoutez simplement le chemin
     jusqu'&agrave; <filename>php4isapi.dll</filename>.
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     Sous "Home Directory", cliquez sur le bouton "Configuration".
     Ajoutez une nouvelle entr&eacute;e dans "Application Mappings". Utilisez le
     chemin jusqu'&agrave; <filename>php4isapi.dll</filename> comme "Executable",
     indiquez ".php" comme extension, laissez "Method exclusions" vide, et
     cochez "Script engine".
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     Arr&ecirc;tez totalement IIS (NET STOP iisadmin)
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     D&eacute;marrez IIS (NET START w3svc)
    </simpara>
   </listitem>
  </itemizedlist>
 </para>
   </sect2>
  </sect1>

<!-- Keep this comment at the end of the file
Local variables:
mode: sgml
sgml-omittag:t
sgml-shorttag:t
sgml-minimize-attributes:nil
sgml-always-quote-attributes:t
sgml-indent-step:1
sgml-indent-data:t
indent-tabs-mode:nil
sgml-parent-document:nil
sgml-default-dtd-file:"../../manual.ced"
sgml-exposed-tags:nil
sgml-local-catalogs:nil
sgml-local-ecat-files:nil
End:
vim600: syn=xml fen fdm=syntax fdl=2 si
vim: et tw=78 syn=sgml
vi: ts=1 sw=1
-->
