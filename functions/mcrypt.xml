 <reference id="ref.mcrypt">
  <title>Fonctions de cryptage</title>
  <titleabbrev>mcrypt</titleabbrev>
  
  <partintro>
   <para>
     Ces fonctions utilisent <ulink url="&url.mcrypt;">mcrypt</ulink>.
   </para>

   <para>
     Ces fonctions permettent d'acc&eacute;der &agrave; la librairie mcrypt, qui dispose d'une 
     grande vari&eacute;t&eacute; d'algorithmes de cryptage, tels que DES, TripleDES, Blowfish 
     (par d&eacute;faut), 3-WAY, SAFER-SK64, SAFER-SK128, TWOFISH, TEA, RC2 et GOST 
     en modes CBC, OFB, CFB et ECB. De plus, elle accepte aussi RC6 et IDEA qui sont 
     consid&eacute;r&eacute;s comme "non libre".
   </para>

   <para>
     Pour l'utiliser, t&eacute;l&eacute;chargez la librairie libmcrypt-x.x.tar.gz grâce par 
     <ulink url="&url.mcrypt;">ici</ulink> et suivez les instructions d'installations 
     incluses. Vous aurez aussi besoin de compiler PHP avec le param&egrave;tre 
     <option role="configure">--with-mcrypt</option> pour activer cette extension.
   </para>

   <para>
     mcrypt permet de crypter et de d&eacute;crypter, en utilisant les m&eacute;thodes mentionn&eacute;es 
     ci-dessus. Les 4 commandes importantes <function>mcrypt_cfb</function>, 
     <function>mcrypt_cbc</function>, <function>mcrypt_ecb</function> et 
     <function>mcrypt_ofb</function>) peuvent toutes op&eacute;rer en mode MCRYPT_ENCRYPT 
     et MCRYPT_DECRYPT. 
    <example>
     <title>Crypte une valeur avec un TripleDES, en mode ECB. </title>
     <programlisting role="php">
&lt;?php
$key = "Cette cle est ultra secrete";
$input = "Rencontrons nous dans notre place secrete a 9 h 00."

$encrypted_data = mcrypt_ecb(MCRYPT_TripleDES, $key, $input, MCRYPT_ENCRYPT);
?&gt;
     </programlisting>
    </example>
	  
   Cet exemple va retourner les donn&eacute;es crypt&eacute;es dans la variable $encrypted_data.</para> 

   <para>
     mcrypt peut op&eacute;rer en 4 modes de cryptage (CBC, OFB, CFB, and ECB). Nous allons 
     pr&eacute;senter la technique d'utilisation de ces modes. Pour plus de r&eacute;f&eacute;rences et de 
     d&eacute;tails, reportez vous au livre suivant : Applied Cryptography by Schneier 
     (ISBN 0-471-11709-9).

    <itemizedlist>
     <listitem><simpara>
      ECB (electronic codebook) ECB (electronic codebook) est pr&eacute;vu pour des donn&eacute;es al&eacute;atoires, telles que des cl&eacute;s. Etant donn&eacute; que les donn&eacute;es sont peu nombreuses et al&eacute;taoires, les inconv&eacute;nients de l'ECB ont ici un effet n&eacute;gatif favorable.
</simpara></listitem>

     <listitem><simpara>
       CBC (cipher block chaining) est sp&eacute;cialement pratique avec les fichiers dont la 
       s&eacute;curit&eacute; ECB n'est pas suffisante.
     </simpara></listitem> 

     <listitem><simpara>
       CFB (cipher feedback) est la meilleure m&eacute;thode pour crypter des flots d'octets, 
       quand les octets doivent &ecirc;tre encrypt&eacute;s un par un.
     </simpara></listitem>

     <listitem><simpara>
       OFB (output feedback) est comparable &agrave; CFB, mais peut &ecirc;tre utilis&eacute; lorsque 
       des erreurs ne doivent pas &ecirc;tre propag&eacute;es.
     </simpara></listitem>
   </itemizedlist></para>

   <para>
       PHP ne supporte par encore le cryptage des flots d'octets. Pour l'instant, PHP 
       n'accepte que le cryptage de cha&icirc;ne.
   </para>

   <para>
    Pour obtenir la liste compl&egrave;te des modes de chiffrement, reportez vous aux derniers 
    #define, dans le fichier <filename>mcrypt.h</filename>. En r&egrave;gle g&eacute;n&eacute;rale, vous 
    pouvez acc&eacute;der &agrave; une m&eacute;thode de chiffrement avec l'option MCRYPT_nomDuChiffrement.
    </para> 
   
   <para>
     Voici une liste non exhaustive des modes de chiffrements de l'extension mcrypt. 
     Si un chiffrement n'est pas dans cette liste, mais disponible dans la librairie, 
     vous pouvez supposer que cette documentation est hors d'age.
    <itemizedlist>

     <listitem><simpara>
      MCRYPT_BLOWFISH</simpara></listitem>
     <listitem><simpara>
      MCRYPT_DES</simpara></listitem>
     <listitem><simpara>
      MCRYPT_TripleDES</simpara></listitem>
     <listitem><simpara>
      MCRYPT_ThreeWAY</simpara></listitem>
     <listitem><simpara>
      MCRYPT_GOST</simpara></listitem>
     <listitem><simpara>
      MCRYPT_CRYPT</simpara></listitem>
     <listitem><simpara>
      MCRYPT_DES_COMPAT</simpara></listitem>
     <listitem><simpara>
      MCRYPT_SAFER64</simpara></listitem>
     <listitem><simpara>
      MCRYPT_SAFER128</simpara></listitem>
     <listitem><simpara>
      MCRYPT_CAST128</simpara></listitem>
     <listitem><simpara>
      MCRYPT_TEAN</simpara></listitem>
     <listitem><simpara>
      MCRYPT_RC2</simpara></listitem>
     <listitem><simpara>
      MCRYPT_TWOFISH (pour les versions mcrypt 2.x )</simpara></listitem>
     <listitem><simpara>
      MCRYPT_TWOFISH128 (TWOFISHxxx est disponible dans les nouvelles versions de mcrypt 2.x )</simpara></listitem>
     <listitem><simpara>
      MCRYPT_TWOFISH192</simpara></listitem>
     <listitem><simpara>
      MCRYPT_TWOFISH256</simpara></listitem>
     <listitem><simpara>
      MCRYPT_RC6</simpara></listitem>
     <listitem><simpara>
      MCRYPT_IDEA</simpara></listitem>

    </itemizedlist></para>

   <para>
    Vous devez (mode CFB et OFB) ou pouvez (mode CBC) fournir un vecteur d'initialisation 
    (IV) pour ces modes de chiffrement. IV doit &ecirc;tre unique, et avoir la m&ecirc;me valeur 
    au chiffrement et au d&eacute;chiffrement. Pour des donn&eacute;es qui seront enregistr&eacute;es apr&egrave;s 
    encryptage, vous pouvez prendre le r&eacute;sultat d'une fonction telle que MD5, 
    appliqu&eacute;e sur le nom du fichier. Sinon, vous pouvez envoyer IV avec les donn&eacute;es 
    chiffr&eacute;es, (reportez vous au chapitre 9.3 de Applied Cryptography by Schneier 
    (ISBN 0-471-11709-9) pour plus de d&eacute;tails sur le sujet).
  </para>

  </partintro>
  
  <refentry id="function.mcrypt-get-cipher-name">
   <refnamediv>
    <refname>mcrypt_get_cipher_name</refname>
    <refpurpose>Lit le nom du chiffrement utilis&eacute;.</refpurpose>
   </refnamediv>
   <refsect1>
    <title>Description</title>
    <funcsynopsis>
     <funcdef>string <function>mcrypt_get_cipher_name</function></funcdef>
     <paramdef>int <parameter>cipher</parameter></paramdef>
    </funcsynopsis>
	
    <para>
      <function>mcrypt_get_cipher_name</function> retourne le nom du chiffrement 
      utilis&eacute;.
    </para>

    <para>
      <function>mcrypt_get_cipher_name</function> prend le num&eacute;ro de chiffrement 
      comme param&egrave;tre, et retourne le nom du chiffrement, ou FALSE, si ce chiffrement 
      n'existe pas.
    </para>
     
    <para>
     <example>
      <title>Exemple avec mcrypt_get_cipher_name</title>
      <programlisting>
&lt;?php
$cipher = MCRYPT_TripleDES;

print mcrypt_get_cipher_name($cipher);
?&gt;
      </programlisting>
     </example></para>
	 
    <para>
     L'exemple ci dessus va donner :
     <programlisting>
TripleDES
     </programlisting></para>
	
   </refsect1>
  </refentry>
  
  <refentry id="function.mcrypt-get-block-size">
   <refnamediv>
    <refname>mcrypt_get_block_size</refname>
    <refpurpose>Retourne la taille de bloc d'un chiffrement.</refpurpose>
   </refnamediv>
   <refsect1>
    <title>Description</title>
    <funcsynopsis>
     <funcdef>int <function>mcrypt_get_block_size</function></funcdef>
     <paramdef>int <parameter>cipher</parameter></paramdef>
    </funcsynopsis>
	
    <para>
     <function>mcrypt_get_block_size</function> sert &agrave; lire la taille de bloc du 
     chiffrement <parameter>cipher</parameter>.
    </para>

    <para>
      <function>mcrypt_get_block_size</function> prend comme argument le chiffrement 
      <parameter>cipher</parameter> et retourne une taille en octets.
    </para> 

    <para>
     Voir aussi : <function>mcrypt_get_key_size</function>.
    </para>

   </refsect1>
  </refentry>
  
  <refentry id="function.mcrypt-get-key-size">
   <refnamediv>
    <refname>mcrypt_get_key_size</refname>
    <refpurpose>Retourne la taille de la cl&eacute; d'un chiffrement.</refpurpose>
   </refnamediv>
   <refsect1>
    <title>Description</title>
    <funcsynopsis>
     <funcdef>int <function>mcrypt_get_key_size</function></funcdef>
     <paramdef>int <parameter>cipher</parameter></paramdef>
    </funcsynopsis>
	
    <para>
     <function>mcrypt_get_key_size</function> sert &agrave; lire la taille de cl&eacute; du 
     chiffrement <parameter>cipher</parameter>.
    </para>

    <para>
     <function>mcrypt_get_block_size</function> prend comme argument le chiffrement 
     <parameter>cipher</parameter> et retourne une taille en octets.
    </para> 

    <para>
     Voir aussi: <function>mcrypt_get_block_size</function>.
    </para>

   </refsect1>
  </refentry>
  
  <refentry id="function.mcrypt-create-iv">
   <refnamediv>
    <refname>mcrypt_create_iv</refname>
    <refpurpose>Cr&eacute;e un vecteur d'initialisation &agrave; partir d'une source al&eacute;atoire.</refpurpose>
   </refnamediv>
   <refsect1>
    <title>Description</title>
    <funcsynopsis>
     <funcdef>string
     <function>mcrypt_create_iv</function></funcdef>
     <paramdef>int <parameter>size</parameter></paramdef>
     <paramdef>int <parameter>source</parameter></paramdef>
    </funcsynopsis>
	
    <para>
     <function>mcrypt_create_iv</function> sert &agrave; cr&eacute;er un IV 
     (vecteur d'initialisation).
    </para>

    <para>
     <function>mcrypt_create_iv</function> prend deux arguments, 
     <parameter>size</parameter> d&eacute;termine la taille de IV, <parameter>source</parameter>
     sp&eacute;cifie la source de IV. 
    </para> 
     
    <para>
      La source peut &ecirc;tre MCRYPT_RAND (g&eacute;n&eacute;rateur de nombres al&eacute;atoires syst&egrave;me), 
      MCRYPT_DEV_RANDOM (lecture des donn&eacute;es depuis le fichier /dev/random) et 
      MCRYPT_DEV_URANDOM (lecture des donn&eacute;es depuis le fichier /dev/urandom). Si vous 
      utilisez MCRYPT_RAND, assurez vous de bien appeler <function>srand</function> pour 
      initialiser le g&eacute;n&eacute;rateur de nombres al&eacute;atoires.
    </para>

    <para>
     <example>
      <title>Exemple avec mcrypt_create_iv</title>
      <programlisting>
&lt;?php
$cipher = MCRYPT_TripleDES;
$block_size = mcrypt_get_block_size($cipher);
$iv = mcrypt_create_iv($block_size, MCRYPT_DEV_RANDOM);
?&gt;
      </programlisting>
     </example></para>

   </refsect1>
  </refentry>
 
  <refentry id="function.mcrypt-cbc">
   <refnamediv>
    <refname>mcrypt_cbc</refname>
    <refpurpose>Encrypte/d&eacute;crypte des donn&eacute;es en mode CBC.</refpurpose>
   </refnamediv>
   <refsect1>
    <title>Description</title>
    <funcsynopsis>
     <funcdef>int <function>mcrypt_cbc</function></funcdef>
     <paramdef>int <parameter>cipher</parameter></paramdef>
     <paramdef>string <parameter>key</parameter></paramdef>
     <paramdef>string <parameter>data</parameter></paramdef>
     <paramdef>int <parameter>mode</parameter></paramdef>
     <paramdef>string <parameter><optional>iv</optional></parameter></paramdef>
    </funcsynopsis>
	
    <para>
     <function>mcrypt_cbc</function> crypte ou d&eacute;crypte (suivant le mode 
      <parameter>mode</parameter>) les donn&eacute;es <parameter>data</parameter> avec le 
      chiffrement <parameter>cipher</parameter> et la cl&eacute; <parameter>key</parameter> 
      en mode CBC et retourne la cha&icirc;ne r&eacute;sultat.
    </para>
    
    <para>
      <parameter>cipher</parameter> est une des constantes de type 
      MCRYPT_ciphername.
    </para>

    <para>
     <parameter>key</parameter> est la cl&eacute; &agrave; fournir &agrave; l'algorithme. Cette cl&eacute; doit 
     rester secr&egrave;te.
    </para>  

    <para>
     <parameter>data</parameter> sont les donn&eacute;es &agrave; crypter/d&eacute;crypter.
    </para> 
     
    <para>
     <parameter>mode</parameter> vaut MCRYPT_ENCRYPT or MCRYPT_DECRYPT.
    </para>

    <para>
     <parameter>iv</parameter> est le vecteur d'initialisation.
    </para>

    <para>
      Voir aussi:
      <function>mcrypt_cfb</function>, <function>mcrypt_ecb</function>, 
      <function>mcrypt_ofb</function>.
    </para>
	 
   </refsect1>
  </refentry>

  <refentry id="function.mcrypt-cfb">
   <refnamediv>
    <refname>mcrypt_cfb</refname>
    <refpurpose>Encrypte/d&eacute;crypte des donn&eacute;es en mode CFB.</refpurpose>
   </refnamediv>
   <refsect1>
    <title>Description</title>
    <funcsynopsis>
     <funcdef>int <function>mcrypt_cfb</function></funcdef>
     <paramdef>int <parameter>cipher</parameter></paramdef>
     <paramdef>string <parameter>key</parameter></paramdef>
     <paramdef>string <parameter>data</parameter></paramdef>
     <paramdef>int <parameter>mode</parameter></paramdef>
     <paramdef>string <parameter>iv</parameter></paramdef>
    </funcsynopsis>
	
    <para>
      <function>mcrypt_cfb</function> crypte ou d&eacute;crypte (suivant le mode 
      <parameter>mode</parameter>) les donn&eacute;es <parameter>data</parameter> avec le 
      chiffrement <parameter>cipher</parameter> et la cl&eacute; <parameter>key</parameter>
      en mode CFB et retourne la cha&icirc;ne r&eacute;sultat.
    </para>
    
    <para>
       <parameter>cipher</parameter> est une des constantes de type MCRYPT_ciphername.
    </para>

    <para>
     <parameter>key</parameter> est la cl&eacute; &agrave; fournir &agrave; l'algorithme. Cette cl&eacute; doit 
     rester secr&egrave;te.
    </para>  

    <para>
      <parameter>data</parameter> sont les donn&eacute;es &agrave; crypter/d&eacute;crypter.
    </para> 
     
    <para>
       <parameter>mode</parameter> vaut MCRYPT_ENCRYPT ou MCRYPT_DECRYPT.
    </para>

    <para>
       <parameter>iv</parameter> est le vecteur d'initialisation.
    </para>

    <para>
     Voir aussi:
     <function>mcrypt_cbc</function>, <function>mcrypt_ecb</function>,
     <function>mcrypt_ofb</function>.
    </para>
	 
   </refsect1>
  </refentry>
  
  <refentry id="function.mcrypt-ecb">
   <refnamediv>
    <refname>mcrypt_ecb</refname>
    <refpurpose>Encrypte/d&eacute;crypte des donn&eacute;es en mode ECB.</refpurpose>
   </refnamediv>
   <refsect1>
    <title>Description</title>
    <funcsynopsis>
     <funcdef>int <function>mcrypt_ecb</function></funcdef>
     <paramdef>int <parameter>cipher</parameter></paramdef>
     <paramdef>string <parameter>key</parameter></paramdef>
     <paramdef>string <parameter>data</parameter></paramdef>
     <paramdef>int <parameter>mode</parameter></paramdef>
    </funcsynopsis>
	
    <para>
     <function>mcrypt_ecb</function> crypte ou d&eacute;crypte (suivant le mode 
     <parameter>mode</parameter>) les donn&eacute;es <parameter>data</parameter> avec le 
     chiffrement <parameter>cipher</parameter> et la cl&eacute; <parameter>key</parameter> 
     en mode ECB et retourne la cha&icirc;ne r&eacute;sultat.
    </para>
    
    <para>
      <parameter>cipher</parameter> est une des constantes de type MCRYPT_ciphername.
    </para>

    <para>
       <parameter>key</parameter> est la cl&eacute; &agrave; fournir &agrave; l'algorithme. Cette cl&eacute; 
       doit rester secr&egrave;te.
    </para>  

    <para>
       <parameter>data</parameter>sont les donn&eacute;es &agrave; crypter/d&eacute;crypter.
    </para> 
     
    <para>
       <parameter>mode</parameter> vaut MCRYPT_ENCRYPT ou MCRYPT_DECRYPT.
    </para>

    <para>
      Voir aussi:
      <function>mcrypt_cbc</function>, <function>mcrypt_cfb</function>,
      <function>mcrypt_ofb</function>.
     </para>
	 
   </refsect1>
  </refentry>

  <refentry id="function.mcrypt-ofb">
   <refnamediv>
    <refname>mcrypt_ofb</refname>
    <refpurpose>Crypte/d&eacute;crypte en mode OFB.</refpurpose>
   </refnamediv>
   <refsect1>
    <title>Description</title>
    <funcsynopsis>
     <funcdef>int <function>mcrypt_ofb</function></funcdef>
     <paramdef>int <parameter>cipher</parameter></paramdef>
     <paramdef>string <parameter>key</parameter></paramdef>
     <paramdef>string <parameter>data</parameter></paramdef>
     <paramdef>int <parameter>mode</parameter></paramdef>
     <paramdef>string <parameter>iv</parameter></paramdef>
    </funcsynopsis>
	
    <para>
     <function>mcrypt_ofb</function> crypte ou d&eacute;crypte (suivant le mode 
     <parameter>mode</parameter>) les donn&eacute;es <parameter>data</parameter> avec le 
     chiffrement <parameter>cipher</parameter> et la cl&eacute; <parameter>key</parameter> 
     en mode OFB et retourne la cha&icirc;ne r&eacute;sultat.
    </para>
    
    <para>
       <parameter>cipher</parameter> est une des constantes de type MCRYPT_ciphername.
    </para>

    <para>
      <parameter>key</parameter> est la cl&eacute; &agrave; fournir &agrave; l'algorithme. 
      Cette cl&eacute; doit rester secr&egrave;te.
    </para>  

    <para>
       <parameter>data</parameter>sont les donn&eacute;es &agrave; crypter/d&eacute;crypter.
    </para> 
     
    <para>
       <parameter>mode</parameter> vaut MCRYPT_ENCRYPT ou MCRYPT_DECRYPT.
    </para>

    <para>
       <parameter>iv</parameter> est le vecteur d'initialisation.
    </para>

    <para>
     Voir aussi :
     <function>mcrypt_cbc</function>, <function>mcrypt_cfb</function> et
     <function>mcrypt_ecb</function>.
    </para>
	 
   </refsect1>
  </refentry>
 
 </reference> 

<!-- Keep this comment at the end of the file
Local variables:
mode: sgml
sgml-omittag:t
sgml-shorttag:t
sgml-minimize-attributes:nil
sgml-always-quote-attributes:t
sgml-indent-step:1
sgml-indent-data:t
sgml-parent-document:nil
sgml-default-dtd-file:"../manual.ced"
sgml-exposed-tags:nil
sgml-local-catalogs:nil
sgml-local-ecat-files:nil
End:
-->
