<?xml version="1.0" encoding="iso-8859-1"?>
<!-- $Revision: 1.8 $ -->
<reference id="ref.curl">
 <title>CURL</title>
 <titleabbrev>CURL</titleabbrev>
 <partintro id="curl.partintro">
  <title>Introduction &agrave; CURL</title>
  <para>
   PHP supporte libcurl, une librairie cr&eacute;&eacute;e par Daniel Stenberg,
   qui vous permet de vous connecter de communiquer avec de nombreux serveurs,
   gr&acirc;ce &agrave; de nombreux protocoles. libcurl supporte actuellement
   les protocoles suivants : http, https, ftp, gopher, telnet, dict, file, et
   ldap.  libcurl supporte aussi les certificats HTTPS, les POST HTTP, PUT HTTP,
   le chargement par FTP (ce qui peut &ecirc;tre fait par l'extension FTP),
   les chargement par formulaire HTTP, les proxies, les cookies et
   l'authentification par mot de passe et nom de compte.
  </para>
  <para>
   Pour pouvoir utiliser les fonctions CURL, vous devez installer le
   package <ulink url="&url.curl;">CURL</ulink>. PHP requiert la version
   CURL 7.0.2-beta ou plus r&eacute;cente. PHP ne fonctionnera pas avec
   une version inf&eacute;rieure &agrave; la version 7.0.2-beta.
  </para>
  <para>
   Pour utiliser CURL depuis les scripts PHP, vous devez aussi compiler PHP
   avec l'option <link linkend="install.configure.with-curl"><option role="configure">--with-curl[=DIR]</option></link>
   o&ugrave; DIR est le chemin jusqu'au dossier contenant les dossiers
   <filename>lib</filename> et <filename>include</filename>. Dans le
   dossier <filename>include</filename> il doit se trouver un dossier
   appel&eacute; <filename>curl</filename>, qui contient notamment les
   fichiers <filename>easy.h</filename> et <filename>curl.h</filename>.
   Il doit aussi se trouver un fichier nomm&eacute;
   <filename>libcurl.a</filename> dans le dossier <filename>lib</filename>.
  </para>
  <para>
   Une fois que vous avez compil&eacute; PHP avec le support CURL, vous
   pouvez commencer &agrave; l'exploiter avec vos scripts PHP. Le principe
   de fonctionnement est d'initialiser une session CURL avec
   <function>curl_init</function>, puis de choisir toutes vos options
   de transfert avec <function>curl_exec</function> et de finir votre
   session avec <function>curl_close</function>.  Voici un exemple
   d'utilisation des fonctions CURL, qui r&eacute;cup&egrave;re la
   page principale de PHP :
   <example>
    <title>Utilisation de CURL et PHP pour r&eacute;cup&eacute;rer une page</title>
    <programlisting role="php">
&lt;?php
$ch = curl_init ("http://www.php.net/");
$fp = fopen ("php_homepage.txt", "w");
curl_setopt ($ch, CURLOPT_INFILE, $fp);
curl_setopt ($ch, CURLOPT_HEADER, 0);
curl_exec ($ch);
curl_close ($ch);
fclose ($fp);
?&gt;
    </programlisting>
   </example>
  </para>
 </partintro>
 <refentry id="function.curl-init">
  <refnamediv>
   <refname>curl_init</refname>
   <refpurpose>Initialise une session CURL</refpurpose>
  </refnamediv>
  <refsect1>
   <title>Description</title>
   <funcsynopsis>
    <funcprototype>
     <funcdef>resource
      <function>curl_init</function>
     </funcdef>
     <paramdef>string
      <parameter>
      <optional>url</optional>
      </parameter>
     </paramdef>
    </funcprototype>
   </funcsynopsis>
   <para>
    <function>curl_init</function> initialise une nouvelle session et retourne un
    identifiant de session CURL, &agrave; utiliser avec les fonctions
    <function>curl_setopt</function>, <function>curl_exec</function>
    et <function>curl_close</function>. Si le param&egrave;tre optionnel
    <parameter>url</parameter> est fourni, alors CURLOPT_URL prendra cette
    valeur. Vous pouvez manuellement fixer cette valeur avec la fonction
    <function>curl_setopt</function>.
    <example>
     <title>
      Initialiser une session CURL et r&eacute;cup&egrave;ration d'une page web.
     </title>
     <programlisting role="php">
&lt;?php
$ch = curl_init();
curl_setopt ($ch, CURLOPT_URL, "http://www.zend.com/");
curl_setopt ($ch, CURLOPT_HEADER, 0);
curl_exec ($ch);
curl_close ($ch);
?&gt;
     </programlisting>
    </example>
   </para>
   <para>
    Voir aussi : <function>curl_close</function>, <function>curl_setopt</function>.
   </para>
  </refsect1>
 </refentry>
 <refentry id="function.curl-setopt">
  <refnamediv>
   <refname>curl_setopt</refname>
   <refpurpose>Modifie une option de transfert CURL</refpurpose>
  </refnamediv>
  <refsect1>
   <title>Description</title>
   <funcsynopsis>
    <funcprototype>
     <funcdef>boolean
      <function>curl_setopt</function>
     </funcdef>
     <paramdef>resource
      <parameter>ch</parameter>
     </paramdef>
     <paramdef>string
      <parameter>option</parameter>
     </paramdef>
     <paramdef>mixed
      <parameter>value</parameter>
     </paramdef>
    </funcprototype>
   </funcsynopsis>
   <para>
    <function>curl_setopt</function> fixe les options de transfert de la
    session CURL identifi&eacute;e par <parameter>ch</parameter>.
    <parameter>option</parameter> est le nom de l'option &agrave; fixer,
    et <parameter>value</parameter> est sa valeur.
   </para>
   <para>
    <parameter>value</parameter> doit &ecirc;tre de type "long" pour
    les options suivantes (sp&eacute;cifi&eacute;e par <parameter>option</parameter>) :
    <itemizedlist>
     <listitem>
      <simpara>
       <parameter>CURLOPT_INFILESIZE</parameter>: Lorsque vous
       t&eacute;l&eacute;chargez un fichier sur un site distant, cette
       option sert &agrave; indiquer &agrave; PHP la taille maximale du
       fichier attendu.
      </simpara>
     </listitem>
     <listitem>
      <simpara>
       <parameter>CURLOPT_VERBOSE</parameter>: Choisissez une valeur non nulle
       pour que CURL vous affiche tous les &eacute;v&eacute;nements.
      </simpara>
     </listitem>
     <listitem>
      <simpara>
       <parameter>CURLOPT_HEADER</parameter>: Choisissez une valeur non nulle
       pour que CURL inclut l'en-t&ecirc;te dans la valeur de retour.
      </simpara>
     </listitem>
     <listitem>
      <para>
       <parameter>CURLOPT_NOPROGRESS</parameter>: Choisissez une valeur non nulle
       pour que PHP n'affiche pas l'&eacute;tat des transferts CURL.
       <note>
        <simpara>
         PHP choisit automatiquement une valeur non nulle. Ne changez cette valeur
         que le temps du d&eacute;buggage.
        </simpara>
       </note>
      </para>
     </listitem>
     <listitem>
      <simpara>
       <parameter>CURLOPT_NOBODY</parameter>: Choisissez une valeur non nulle
       pour que le corps du transfert ne soit pas inclus dans la valeur de retour.
      </simpara>
     </listitem>
     <listitem>
      <simpara>
       <parameter>CURLOPT_FAILONERROR</parameter>: Choisissez une valeur non nulle
       pour que PHP traite silencieusement les codes HTTP sup&eacute;rieurs
       &agrave; 300. Le comportement par d&eacute;faut est de retourner la
       page normalement, en ignorant ce code.
      </simpara>
     </listitem>
     <listitem>
      <simpara>
       <parameter>CURLOPT_UPLOAD</parameter>: Choisissez une valeur non nulle
       pour que PHP pr&eacute;pare un chargement.
      </simpara>
     </listitem>
     <listitem>
      <simpara>
       <parameter>CURLOPT_POST</parameter>: Choisissez une valeur non nulle
       pour que PHP fasse un HTTP POST. Un POST est un encodage normal
       "application/x-www-from-url", utilis&eacute; couramment par les formulaires
       HTML.
      </simpara>
     </listitem>
     <listitem>
      <simpara>
       <parameter>CURLOPT_FTPLISTONLY</parameter>: Choisissez une valeur non nulle
       pour que PHP ne fasse que lister les noms d'un dossier FTP.
      </simpara>
     </listitem>
     <listitem>
      <simpara>
       <parameter>CURLOPT_FTPAPPEND</parameter>: Choisissez une valeur non nulle
       pour que PHP concat&egrave;ne le fichier distant, plut&ocirc;t que de
       l'&eacute;craser.
      </simpara>
     </listitem>
     <listitem>
      <simpara>
       <parameter>CURLOPT_NETRC</parameter>: Choisissez une valeur non nulle
       pour que PHP scanne votre fichier ~./netrc et utilise votre nom de
       compte et mot de passe sur le site distant que vous souhaitez contacter.
      </simpara>
     </listitem>
     <listitem>
      <simpara>
       <parameter>CURLOPT_FOLLOWLOCATION</parameter>: Choisissez une valeur
       non nulle pour suivre toutes les en-t&ecirc;tes "Location: " que le
       serveur envoie dans les en-t&ecirc;tes HTTP (notez que cette fonction
       est r&eacute;cursive, et que PHP suivra toutes les en-t&ecirc;tes
       "Location: " qu'il trouvera).
      </simpara>
     </listitem>
     <listitem>
      <simpara>
       <parameter>CURLOPT_PUT</parameter>: Choisissez une valeur non nulle
       pour que pour chargement se fasse par HTTP PUT. Le fichier &agrave;
       charger doit &ecirc;tre fix&eacute; avec les options CURLOPT_INFILE
       et CURLOPT_INFILESIZE.
      </simpara>
     </listitem>
     <listitem>
      <simpara>
       <parameter>CURLOPT_MUTE</parameter>: Choisissez une valeur non nulle
       pour que PHP soit totalement silencieux concernant toutes les fonctions
       CURL.
      </simpara>
     </listitem>
     <listitem>
      <simpara>
       <parameter>CURLOPT_TIMEOUT</parameter>: Passez un entier "long" comme
       param&egrave;tre qui repr&eacute;sente le temps maximum d'ex&eacute;cution
       de la fonction CURL.
      </simpara>
     </listitem>
     <listitem>
      <simpara>
       <parameter>CURLOPT_LOW_SPEED_LIMIT</parameter>: Passez un entier long
       qui repr&eacute;sente la vitesse minimale en octets par secondes en
       dessous de laquelle, et pendant CURLOPT_LOW_SPEED secondes, PHP
       consid&egrave;rera qu'elle est trop lente, et annulera le transfert.
      </simpara>
     </listitem>
     <listitem>
      <simpara>
       <parameter>CURLOPT_LOW_SPEED_TIME</parameter>: Passez un entier "long"
       qui repr&eacute;sente le temps en secondes, qui, si la vitesse de
       transfert reste en dessous de CURLOPT_LOW_SPEED_LIMIT, PHP
       consid&egrave;rera que la connexion est trop lente, et l'annulera.
      </simpara>
     </listitem>
     <listitem>
      <simpara>
       <parameter>CURLOPT_RESUME_FROM</parameter>: Passez un entier "long",
       qui repr&eacute;sente l'offset, en octets, &agrave; partir duquel vous voulez
       commencer le transfert.
      </simpara>
     </listitem>
     <listitem>
      <simpara>
       <parameter>CURLOPT_SSLVERSION</parameter>: Passez un entier "long"
       qui contient la version de SSL (2 ou 3) &agrave; utiliser.  Par
       d&eacute;faut, PHP essaiera de le d&eacute;terminer par
       lui-m&ecirc;me, bien que dans certains cas, il vous faudra
       le faire manuellement.
      </simpara>
     </listitem>
     <listitem>
      <simpara>
       <parameter>CURLOPT_TIMECONDITION</parameter>: Passez un entier "long"
       qui d&eacute;finit comment CURLOPT_TIMEVALUE est utilis&eacute;.
       Vous pouvez choisir entre les valeurs TIMECOND_IFMODSINCE ou
       TIMECOND_ISUNMODSINCE. C'est une fonctionnalit&eacute; HTTP.
      </simpara>
     </listitem>
     <listitem>
      <simpara>
       <parameter>CURLOPT_TIMEVALUE</parameter>: Passez un entier "long"
       qui repr&eacute;sente le temps en secondes depuis le 1er janvier 1970.
       Cette valeur sera utilis&eacute;e comme sp&eacute;cifi&eacute; dans
       l'option CURLOPT_TIMEVALUE. Par d&eacute;faut, TIMECOND_IFMODSINCE
       sera utilis&eacute;.
      </simpara>
     </listitem>
    </itemizedlist>
   </para>
   <para>
    <parameter>value</parameter> doit &ecirc;tre une cha&icirc;ne de
    caract&egrave;res pour les valeurs suivantes de <parameter>option</parameter>
    <itemizedlist>
     <listitem>
      <simpara>
       <parameter>CURLOPT_URL</parameter>: L'URL que PHP va r&eacute;cup&eacute;rer.
       Vous pouvez aussi choisir cette valeur lors de l'appel &agrave;
       <function>curl_init</function>.
      </simpara>
     </listitem>
     <listitem>
      <simpara>
       <parameter>CURLOPT_USERPWD</parameter>: Passez une cha&icirc;ne de
       caract&egrave;res au format [nom]:[mot de passe], pour que PHP
       l'utilise lors de la connexion.
      </simpara>
     </listitem>
     <listitem>
      <simpara>
       <parameter>CURLOPT_PROXYUSERPWD</parameter>: Passez une cha&icirc;ne
       de caract&egrave;res au format [nom]:[mot de passe ], pour que PHP
       l'utilise lors de la connexion &agrave; un proxy HTTP.
      </simpara>
     </listitem>
     <listitem>
      <simpara>
       <parameter>CURLOPT_RANGE</parameter>: Passez une cha&icirc;ne de
       caract&egrave;res qui repr&eacute;sente la plage de valeur que
       vous d&eacute;sirez. Elle est au format "X-Y", o&ugrave; les
       valeurs de X ou Y peuvent &ecirc;tre omises. Le transfert HTTP
       supporte aussi plusieurs intervalles, s&eacute;par&eacute; par
       des virgules : X-Y,N-M.
      </simpara>
     </listitem>
     <listitem>
      <simpara>
       <parameter>CURLOPT_POSTFIELDS</parameter>: Passez une cha&icirc;ne
       de caract&egrave;res qui contient toutes les donn&eacute;es &agrave;
       passer lors d'une op&eacute;ration de HTTP POST.
      </simpara>
     </listitem>
     <listitem>
      <simpara>
       <parameter>CURLOPT_REFERER</parameter>: Passez une cha&icirc;ne de
       caract&egrave;res qui contient l'en-t&ecirc;te de "REFERER",
       utilis&eacute; lors d'une requ&ecirc;te HTTP.
      </simpara>
     </listitem>
     <listitem>
      <simpara>
       <parameter>CURLOPT_USERAGENT</parameter>: Passez une cha&icirc;ne
       de caract&egrave;res qui contient l'en-t&ecirc;te "user-agent"
       utilis&eacute; dans une requ&ecirc;te HTTP.
      </simpara>
     </listitem>
     <listitem>
      <simpara>
       <parameter>CURLOPT_FTPPORT</parameter>: Passez une cha&icirc;ne de
       caract&egrave;res qui d&eacute;signera l'adresse IP utilis&eacute;e
       pour l'instruction FTP "PORT". L'instruction POST indique au serveur
       distant de se connecter cette adresse IP. La cha&icirc;ne peut
       &ecirc;tre une adresse IP, un nom d'h&ocirc;te, un nom d'interface
       r&eacute;seau (sous UNIX), ou juste '-', pour utiliser les IP par
       d&eacute;faut du syst&egrave;me.
      </simpara>
     </listitem>
     <listitem>
      <simpara>
       <parameter>CURLOPT_COOKIE</parameter>: Passez une cha&icirc;ne de
       caract&egrave;res qui contiendra le contenu du cookie, &agrave;
       transmettre dans l'en-t&ecirc;te HTTP.
      </simpara>
     </listitem>
     <listitem>
      <simpara>
       <parameter>CURLOPT_SSLCERT</parameter>: Passez une cha&icirc;ne de
       caract&egrave;res qui contiendra le nom de fichier du certificat,
       au format PEM.
      </simpara>
     </listitem>
     <listitem>
      <simpara>
       <parameter>CURLOPT_SSLCERTPASSWD</parameter>: Passez une cha&icirc;ne
       de caract&egrave;res qui contient le mot de passe n&eacute;cessaire
       pour utiliser le certificat CURLOPT_SSLCERT.
      </simpara>
     </listitem>
     <listitem>
      <simpara>
       <parameter>CURLOPT_COOKIEFILE</parameter>: Passez une cha&icirc;ne de
       caract&egrave;res qui contiendra le nom du fichier contenant les
       donn&eacute;es de cookie. Le fichier de cookie peut &ecirc;tre au
       format Netscape, ou simplement des en-t&ecirc;tes HTTP &eacute;crites
       dans un fichier.
      </simpara>
     </listitem>
     <listitem>
      <para>
       <parameter>CURLOPT_CUSTOMREQUEST</parameter>: Passez une cha&icirc;ne
       de caract&egrave;res qui sera utilis&eacute; &agrave; la place de GET
       ou HEAD lors des requ&ecirc;tes HTTP. Cette commande est pratique pour
       effectuer un DELETE, ou une autre commande HTTP exotique.
       <note>
        <simpara>
         N'utilisez pas cette commande sans vous assurer que le serveur l'accepte.
        </simpara>
       </note>
      </para>
     </listitem>
    </itemizedlist>
   </para>
   <para>
    Les options suivantes requi&egrave;rent un pointeur de fichier, qui est
    obtenu avec la fonction <function>fopen</function> :
    <itemizedlist>
     <listitem>
      <simpara>
       <parameter>CURLOPT_FILE</parameter>: Le fichier de sortie de votre transfert.
       Par d&eacute;faut, STDOUT.
      </simpara>
     </listitem>
     <listitem>
      <simpara>
       <parameter>CURLOPT_INFILE</parameter>: Le fichier d'entr&eacute;e de
       votre transfert.
      </simpara>
     </listitem>
     <listitem>
      <simpara>
       <parameter>CURLOPT_WRITEHEADER</parameter>: Le fichier de destination
       de l'en-t&ecirc;te de la sortie du transfert.
      </simpara>
     </listitem>
     <listitem>
      <simpara>
       <parameter>CURLOPT_STDERR</parameter>: Le fichier d'erreurs.
      </simpara>
     </listitem>
    </itemizedlist>
   </para>
  </refsect1>
 </refentry>
 <refentry id="function.curl-exec">
  <refnamediv>
   <refname>curl_exec</refname>
   <refpurpose>Ex&eacute;cute une session CURL</refpurpose>
  </refnamediv>
  <refsect1>
   <title>Description</title>
   <funcsynopsis>
    <funcprototype>
     <funcdef>boolean
      <function>curl_exec</function>
     </funcdef>
     <paramdef>resource
      <parameter>ch</parameter>
     </paramdef>
    </funcprototype>
   </funcsynopsis>
   <para>
    Cette fonction doit &ecirc;tre appel&eacute;e apr&egrave;s
    l'initialisation et le param&egrave;trage d'une session CURL.
    Son but est simplement d'&eacute;x&eacute;cuter la session
    <parameter>ch</parameter>.
   </para>
  </refsect1>
 </refentry>
 <refentry id="function.curl-close">
  <refnamediv>
   <refname>curl_close</refname>
   <refpurpose>Ferme une session CURL</refpurpose>
  </refnamediv>
  <refsect1>
   <title>Description</title>
   <funcsynopsis>
    <funcprototype>
     <funcdef>void
      <function>curl_close</function>
     </funcdef>
     <paramdef>int
      <parameter>ch</parameter>
     </paramdef>
    </funcprototype>
   </funcsynopsis>
   <para>
    <function>curl_close</function> ferme une session CURL et lib&egrave;re
    toutes les ressources r&eacute;serv&eacute;es. L'identifiant CURL,
    <parameter>ch</parameter>, est aussi effac&eacute;.
   </para>
  </refsect1>
 </refentry>
 <refentry id="function.curl-version">
  <refnamediv>
   <refname>curl_version</refname>
   <refpurpose>Retourne la version courante de CURL</refpurpose>
  </refnamediv>
  <refsect1>
   <title>Description</title>
   <funcsynopsis>
    <funcprototype>
     <funcdef>string
      <function>curl_version</function>
     </funcdef>
     <paramdef>void</paramdef>
    </funcprototype>
   </funcsynopsis>
   <para>
    <function>curl_version</function> retourne une cha&icirc;ne
    avec la version courante de la librairie CURL.
   </para>
  </refsect1>
 </refentry>
</reference>
<!-- Keep this comment at the end of the file
Local variables:
mode: sgml
sgml-omittag:t
sgml-shorttag:t
sgml-minimize-attributes:nil
sgml-always-quote-attributes:t
sgml-indent-step:1
sgml-indent-data:t
indent-tabs-mode:nil
sgml-parent-document:nil
sgml-default-dtd-file:"../../manual.ced"
sgml-exposed-tags:nil
sgml-local-catalogs:nil
sgml-local-ecat-files:nil
End:
-->
