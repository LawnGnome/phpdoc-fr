<?xml version="1.0" encoding="iso-8859-1"?>
<!-- $Revision: 1.1 $ -->
 <reference id="ref.mcrypt">
  <title>Chiffrage mcrypt</title>
  <titleabbrev>mcrypt</titleabbrev>
  <partintro>
   <para>
     Ces fonctions utilisent <ulink url="&url.mcrypt;">mcrypt</ulink>.
   </para>
   <para>
     Ces fonctions permettent d'acc&eacute;der &agrave; la librairie
     mcrypt, qui dispose d'une grande vari&eacute;t&eacute; d'algorithmes
     de chiffrage, tels que DES, TripleDES, Blowfish (par d&eacute;faut), 3-WAY,
     SAFER-SK64, SAFER-SK128, TWOFISH, TEA, RC2 et GOST en modes CBC,
     OFB, CFB et ECB. De plus, elle accepte aussi RC6 et IDEA qui sont
     consid&eacute;r&eacute;s comme "non libre".
   </para>
  <para>
    Si vous compilez PHP avec la librairie <literal>libmcrypt 2.4.x</literal>, les algorithmes
    suivants sont support&eacute;s : CAST, LOKI97, RIJNDAEL, SAFERPLUS,
    SERPENT ainsi que les chiffrements suivants : ENIGMA (chiffrage), PANAMA,
    RC4 et WAKE. Avec <literal>libmcrypt 2.4.x</literal> un autre mode de chiffrement
    est disponible : nOFB.
   </para>
   <para>
     Pour l'utiliser, t&eacute;l&eacute;chargez la librairie
     <literal>libmcrypt-x.x.tar.gz</literal> par <ulink url="&url.mcrypt;">ici</ulink>
     et suivez les instructions d'installations incluses. Vous aurez aussi besoin
     de compiler PHP avec le param&egrave;tre
     <link linkend="install.configure.with-mcrypt"><option role="configure">--with-mcrypt</option></link>
     pour activer cette extension.
   </para>
   <para>
     Mcrypt permet de chiffrer et de d&eacute;chiffrer, en utilisant les m&eacute;thodes
     mentionn&eacute;es ci-dessus. Les 4 commandes importantes
     <function>mcrypt_cfb</function>, <function>mcrypt_cbc</function>,
     <function>mcrypt_ecb</function> et <function>mcrypt_ofb</function>)
     peuvent toutes op&eacute;rer en mode MCRYPT_ENCRYPT et MCRYPT_DECRYPT.
    <example>
     <title>Chiffre une valeur avec un TripleDES, en mode ECB. </title>
     <programlisting role="php">
&lt;?php
$key = "Cette cle est ultra-secrete";
$input = "Rencontrons-nous dans notre place secrete a 9 h 00.";
$encrypted_data = mcrypt_ecb(MCRYPT_TripleDES, $key, $input, MCRYPT_ENCRYPT);
?&gt;
     </programlisting>
    </example>
   Cet exemple va retourner les donn&eacute;es crypt&eacute;es dans la variable
   $encrypted_data.
   </para>
   <para>
    Si vous avez compil&eacute; PHP avec libmcrypt 2.4.x, ces fonctions sont toujours
    disponibles, mais il est vivement conseill&eacute; d'utiliser les nouvelles
    fonctions avanc&eacute;es.
    <example>
     <title>Encryption d'une valeur avec TripleDES sous 2.4.x en mode ECB</title>
     <programlisting role="php">
&lt;?php
$key = "Ceci est une vraie cle secrete";
$input = "Rendez-vous &agrave; 9 heures, dans notre planque.";
$td = mcrypt_module_open (MCRYPT_TripleDES, "", MCRYPT_MODE_ECB, "");
$iv = mcrypt_create_iv (mcrypt_enc_get_iv_size ($td), MCRYPT_RAND);
mcrypt_generic_init ($td, $key, $iv);
$encrypted_data = mcrypt_generic ($td, $input);
mcrypt_generic_end ($td);
?&gt;
     </programlisting>
    </example>
     Cet exemple va retourner les donn&eacute;es crypt&eacute;es dans la variable
    <literal>$encrypted_data</literal>.
   </para>
   <para>
     Mcrypt peut op&eacute;rer en 4 modes de chiffrage (CBC, OFB, CFB, et ECB).
     Nous allons pr&eacute;senter la technique d'utilisation de ces modes. Pour
     plus de r&eacute;f&eacute;rences et de d&eacute;tails, reportez-vous au livre
     suivant : Applied Cryptography par Schneier (ISBN 0-471-11709-9).
    <itemizedlist>
     <listitem>
      <simpara>
       ECB (electronic codebook) ECB (electronic codebook) est pr&eacute;vu pour
       des donn&eacute;es al&eacute;atoires, telles que des cl&eacute;s. Etant
       donn&eacute; que les donn&eacute;es sont peu nombreuses et al&eacute;atoires,
       les inconv&eacute;nients de l'ECB ont ici un effet n&eacute;gatif favorable.
      </simpara>
     </listitem>
     <listitem>
      <simpara>
       CBC (cipher block chaining) est sp&eacute;cialement pratique avec les
       fichiers dont la s&eacute;curit&eacute; ECB n'est pas suffisante.
      </simpara>
     </listitem>
     <listitem>
      <simpara>
       CFB (cipher feedback) est la meilleure m&eacute;thode pour chiffrer des
       flots d'octets, quand les octets doivent &ecirc;tre encrypt&eacute;s un
       par un.
      </simpara>
     </listitem>
     <listitem>
      <simpara>
       OFB (output feedback) est comparable &agrave; CFB, mais peut &ecirc;tre
       utilis&eacute; lorsque des erreurs ne doivent pas &ecirc;tre propag&eacute;es.
      </simpara>
     </listitem>
     <listitem>
      <simpara>
       nOFB (output feedback, in nbit) est comparable &agrave; OFB, mais
       plus s&ucirc;r, car il op&egrave;re avec la taille de blocs de l'algorithme.
      </simpara>
     </listitem>
     <listitem>
      <simpara>
       STREAM est un mode suppl&eacute;mentaire, pour permettre l'utilisation d'
       algorithmes tels que WAKE ou RC4.
      </simpara>
     </listitem>
    </itemizedlist>
   </para>
   <para>
     PHP ne supporte par encore le chiffrage des flots d'octets.
     Pour l'instant, PHP n'accepte que le chiffrage de cha&icirc;ne.
   </para>
   <para>
    Pour obtenir la liste compl&egrave;te des modes de chiffrement, reportez
    vous aux derniers #define, dans le fichier <filename>mcrypt.h</filename>.
    En r&egrave;gle g&eacute;n&eacute;rale, vous pouvez acc&eacute;der &agrave;
    une m&eacute;thode de chiffrement avec l'option MCRYPT_nomDuChiffrement.
    </para>
   <para>
     Voici une liste non exhaustive des modes de chiffrement de l'extension
     mcrypt. Si un chiffrement n'est pas dans cette liste, mais disponible dans
     la librairie, vous pouvez supposer que cette documentation est hors d'&acirc;ge.
   </para>
 <itemizedlist>
     <listitem>
      <simpara>
       MCRYPT_3DES
      </simpara>
     </listitem>
     <listitem>
      <simpara>
       MCRYPT_ARCFOUR_IV (libmcrypt 2.4.x seulement)
      </simpara>
     </listitem>
     <listitem>
      <simpara>
       MCRYPT_ARCFOUR (libmcrypt 2.4.x seulement)
      </simpara>
     </listitem>
     <listitem>
      <simpara>
       MCRYPT_BLOWFISH
      </simpara>
     </listitem>
     <listitem>
      <simpara>
       MCRYPT_CAST_128
      </simpara>
     </listitem>
     <listitem>
      <simpara>
       MCRYPT_CAST_256
      </simpara>
     </listitem>
     <listitem>
      <simpara>
       MCRYPT_CRYPT
      </simpara>
     </listitem>
     <listitem>
      <simpara>
       MCRYPT_DES
      </simpara>
     </listitem>
     <listitem>
      <simpara>
       MCRYPT_DES_COMPAT (libmcrypt 2.2.x seulement)
      </simpara>
     </listitem>
     <listitem>
      <simpara>
       MCRYPT_ENIGMA (libmcrypt 2.4.x seulement, alias de MCRYPT_CRYPT)
      </simpara>
     </listitem>
     <listitem>
      <simpara>
       MCRYPT_GOST
      </simpara>
     </listitem>
     <listitem>
      <simpara>
       MCRYPT_IDEA (payant)
      </simpara>
     </listitem>
     <listitem>
      <simpara>
       MCRYPT_LOKI97 (libmcrypt 2.4.x seulement)
      </simpara>
     </listitem>
     <listitem>
      <simpara>
       MCRYPT_MARS (libmcrypt 2.4.x seulement, payant)
      </simpara>
     </listitem>
     <listitem>
      <simpara>
       MCRYPT_PANAMA (libmcrypt 2.4.x seulement)
      </simpara>
     </listitem>
     <listitem>
      <simpara>
       MCRYPT_RIJNDAEL_128 (libmcrypt 2.4.x seulement)
      </simpara>
     </listitem>
     <listitem>
      <simpara>
       MCRYPT_RIJNDAEL_192 (libmcrypt 2.4.x seulement)
      </simpara>
     </listitem>
     <listitem>
      <simpara>
       MCRYPT_RIJNDAEL_256 (libmcrypt 2.4.x seulement)
      </simpara>
     </listitem>
     <listitem>
      <simpara>
       MCRYPT_RC2
      </simpara>
     </listitem>
     <listitem>
      <simpara>
       MCRYPT_RC4 (libmcrypt 2.2.x seulement)
      </simpara>
     </listitem>
     <listitem>
      <simpara>
       MCRYPT_RC6 (libmcrypt 2.4.x seulement)
      </simpara>
     </listitem>
     <listitem>
      <simpara>
       MCRYPT_RC6_128 (libmcrypt 2.2.x seulement)
      </simpara>
     </listitem>
     <listitem>
      <simpara>
       MCRYPT_RC6_192 (libmcrypt 2.2.x seulement)
      </simpara>
     </listitem>
     <listitem>
      <simpara>
       MCRYPT_RC6_256 (libmcrypt 2.2.x seulement)
      </simpara>
     </listitem>
     <listitem>
      <simpara>
       MCRYPT_SAFER64
      </simpara>
     </listitem>
     <listitem>
      <simpara>
       MCRYPT_SAFER128
      </simpara>
     </listitem>
     <listitem>
      <simpara>
       MCRYPT_SAFERPLUS (libmcrypt 2.4.x seulement)
      </simpara>
     </listitem>
     <listitem>
      <simpara>
       MCRYPT_SERPENT (libmcrypt 2.4.x seulement)
      </simpara>
     </listitem>
     <listitem>
      <simpara>
       MCRYPT_SERPENT_128 (libmcrypt 2.2.x seulement)
      </simpara>
     </listitem>
     <listitem>
      <simpara>
       MCRYPT_SERPENT_192 (libmcrypt 2.2.x seulement)
      </simpara>
     </listitem>
     <listitem>
      <simpara>
       MCRYPT_SERPENT_256 (libmcrypt 2.2.x seulement)
      </simpara>
     </listitem>
     <listitem>
      <simpara>
       MCRYPT_SKIPJACK (libmcrypt 2.4.x seulement)
      </simpara>
     </listitem>
     <listitem>
      <simpara>
       MCRYPT_TEAN (libmcrypt 2.2.x seulement)
      </simpara>
     </listitem>
     <listitem>
      <simpara>
       MCRYPT_THREEWAY
      </simpara>
     </listitem>
     <listitem>
      <simpara>
       MCRYPT_TRIPLEDES (libmcrypt 2.4.x seulement)
      </simpara>
     </listitem>
     <listitem>
      <simpara>
       MCRYPT_TWOFISH (Pour les anciennes versions de mcrypt 2.x versions,
       ou mcrypt 2.4.x )
      </simpara>
     </listitem>
     <listitem>
      <simpara>
       MCRYPT_TWOFISH128 (TWOFISHxxx sont disponibles avec les nouvelles
       versions de 2.x, mais pas dans les versions 2.4.x)
      </simpara>
     </listitem>
     <listitem>
      <simpara>
       MCRYPT_TWOFISH192
      </simpara>
     </listitem>
     <listitem>
      <simpara>
       MCRYPT_TWOFISH256
      </simpara>
     </listitem>
     <listitem>
      <simpara>
       MCRYPT_WAKE (libmcrypt 2.4.x seulement)
      </simpara>
     </listitem>
     <listitem>
      <simpara>
       MCRYPT_XTEA (libmcrypt 2.4.x seulement)
      </simpara>
     </listitem>
    </itemizedlist>
   <para>
    Vous devez (mode CFB et OFB) ou pouvez (mode CBC) fournir un vecteur
    d'initialisation (IV) pour ces modes de chiffrement. IV doit &ecirc;tre
    unique, et avoir la m&ecirc;me valeur au chiffrement et au d&eacute;chiffrement.
    Pour des donn&eacute;es qui seront enregistr&eacute;es apr&egrave;s chiffrement,
    vous pouvez prendre le r&eacute;sultat d'une fonction telle que MD5,
    appliqu&eacute;e sur le nom du fichier. Sinon, vous pouvez envoyer IV avec
    les donn&eacute;es chiffr&eacute;es, (reportez-vous au chapitre 9.3 de
    Applied Cryptography by Schneier (ISBN 0-471-11709-9) pour plus de
    d&eacute;tails sur le sujet).
  </para>
  </partintro>
&reference.mcrypt.functions;

 </reference>
<!-- Keep this comment at the end of the file
Local variables:
mode: sgml
sgml-omittag:t
sgml-shorttag:t
sgml-minimize-attributes:nil
sgml-always-quote-attributes:t
sgml-indent-step:1
sgml-indent-data:t
indent-tabs-mode:nil
sgml-parent-document:nil
sgml-default-dtd-file:"../manual.ced"
sgml-exposed-tags:nil
sgml-local-catalogs:nil
sgml-local-ecat-files:nil
End:
-->

