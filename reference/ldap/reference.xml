<?xml version="1.0" encoding="iso-8859-1"?>
<!-- $Revision: 1.4 $ -->
 <reference id="ref.ldap">
  <title>LDAP</title>
  <titleabbrev>LDAP</titleabbrev>

  <partintro>
   <section id="ldap.intro">
    &reftitle.intro;
    <para>
     LDAP siginifie : Lightweight Directory Access Protocol 
     (Protocole d'acc&egrave;s aux annuaires l&eacute;ger). C'est un protocole
     utilis&eacute; pour acc&eacute;der aux "serveurs de dossiers". Ces serveurs
     sont des bases de donn&eacute;es particuli&egrave;res, qui stockent les informations
     sous forme d'arborescence.
    </para>
    <para> 
     Le concept d'arborescence est similaire &agrave; celui de la structure de votre
     syst&egrave;me de fichier, hormis le fait que dans ce contexte, la racine
     s'appelle "le monde", et que le premier niveau de sous-dossier
     s'appelle "pays". Les niveaux encore en dessous sont des "compagnies"
     "organisation" ou "places", et encore plus bas, vous trouverez des
     "personnes" et m&ecirc;me, des "&eacute;quipements" et "documents".
    </para>
    <para>
     Pour identifier un fichier dans votre disque, vous utilisez un chemin tel
     que 
    </para>
    <literallayout>
    /usr/local/mon_application/documents
    </literallayout>
    <para>
     Le slash indique une division dans la r&eacute;f&eacute;rence, et la s&eacute;quence est lue de
     gauche &agrave; droite.
    </para>
    <para> 
     l'&eacute;quivalent d'une r&eacute;f&eacute;rence globale en LDAP s'appelle 
     un "nom distingu&eacute;" ("distinguished name"), aussi appel&eacute; "dn". Un exemple de
     dn serait : 
    </para>
    <literallayout>
    cn=Jean Dupond,ou=Comptabilit&eacute;,o=Ma Compagnie,c=FR
    </literallayout>
    <para>
     La virgule marque la s&eacute;paration de chaque division comme r&eacute;f&eacute;rence, et la s&eacute;quence est
     lue de droite &agrave; gauche. Il faut donc lire : 
    </para>
    <literallayout>
    country = FR
    organization = Ma Compagnie
    organizationalUnit = Comptabilit&eacute;
    commonName = Jean Dupond
    </literallayout>
    <para>
     De la m&ecirc;me fa&ccedil;on qu'il n'y a pas de r&egrave;gle obligatoire sur 
     comment organiser les fichiers sur un disque dur, un 
     responsable de serveur de dossiers peut organiser le serveur
     comme cela lui semble le plus pratique. Cependant, il y a 
     des conventions &agrave; utiliser. Le principe est que vous ne pouvez
     pas &eacute;crire acc&eacute;der &agrave; un serveur de dossier &agrave; moins que vous
     ne connaissiez sa structure, de m&ecirc;me que vous ne pouvez
     une base de donn&eacute;es sans en conna&icirc;tre les tables et les bases.
    </para>
    <para>
      Bien plus d'informations sont disponibles aux URL suivantes (en anglais) : 
     </para>

    <itemizedlist>
     <listitem>
      <para>
       <ulink url="&url.ldap.netscape;">Netscape</ulink>
      </para>
     </listitem>
     <listitem>
      <para>
       <ulink url="&url.ldap.michigan;">University of Michigan</ulink>
      </para>
     </listitem>
     <listitem>
      <para>
       <ulink url="&url.ldap.openldap;">OpenLDAP Project</ulink>
      </para>
     </listitem>
     <listitem>
      <para>
       <ulink url="&url.ldap.ldapworld;">LDAP World</ulink>
      </para>
     </listitem>
    </itemizedlist>

     <para>    
      Le SDK Netscape contient un guide du programmeur tr&egrave;s utile, au format
      HTML (et en anglais).
     </para>

   </section>

  <section id="ldap.requirements">
    &reftitle.required;
    <para>
     Vous devez télécharger et compiler les librairies clients
     LDAP, soit celles de University of Michigan ldap-3.3,
     soit le Netscape Directory SDK 3.0.
    </para>
   </section>

   <section id="ldap.installation">
    &reftitle.install;
    <para>
     Le support LDAP de PHP n'est pas activé par défaut. Vous devez
     utiliser l'option de configuration 
     <link linkend="install.configure.with-ldap">--with-ldap</link>
     lorsque vous compilez PHP.
    </para>
   </section>

   &reference.ldap.ini;

   <section id="ldap.resources">
    &reftitle.resources;
    &no.resource;
   </section>

   &reference.ldap.constants;
   <section id="ldap-example">
    <title>Exemple complet de code LDAP</title>
     <para>
      Lit les informations sur toutes les entr&eacute;es dont le nom
      commence par "S" sur le serveur de dossier, puis affiche
      le nom et l'adresse email.
     </para>

    <example>
     <title>Recherche avec LDAP</title>
     <programlisting role="php">
<![CDATA[
<?php
// La s&eacute;quence de base avec LDAP est 
// connexion, liaison, recherche, interpr&eacute;tation du r&eacute;sultat
// d&eacute;connexion

echo "<h3>requ&ecirc;te de test de LDAP</h3>";
echo "Connexion ...";
$ds=ldap_connect("localhost");  // doit &ecirc;tre un serveur LDAP valide!
echo "Le r&eacute;sultat de connexion est ".$ds."<p>";

if ($ds) { 
    echo "Liaison ..."; 
    $r=ldap_bind($ds);     // this is an "anonymous" bind, typically
                           // read-only access
    echo "Le r&eacute;sultat de connexion est ".$r."<p>";

    echo "Recherchons (sn=S*) ...";
    // Recherche par nom
    $sr=ldap_search($ds,"o=My Company, c=US", "sn=S*");  
    echo "Le r&eacute;sultat de la recherche est ".$sr."<p>";

    echo "Le nombre d'entr&eacute;es retourn&eacute;es est ".ldap_count_entries($ds,$sr)."<p>";

    echo "Lecture des entr&eacute;es ...<p>";
    $info = ldap_get_entries($ds, $sr);
    echo "Donn&eacute;es pour ".$info["count"]." entr&eacute;es:<p>";

    for ($i=0; $i<$info["count"]; $i++) {
        echo "dn est : ". $info[$i]["dn"] ."<br>";
        echo "premiere entree cn : ". $info[$i]["cn"][0] ."<br>";
        echo "premier email : ". $info[$i]["mail"][0] ."<p>";
    }

    echo "Fermeture de la connexion";
    ldap_close($ds);

} else {
    echo "<h4>Impossible de se connecter au serveur LDAP.</h4>";
}
?>
]]>
    </programlisting>
   </example>

   <section id="ldap.using">
    <title>Utiliser les fonctions LDAP de PHP</title>
     <para>
      Avant d'utiliser les fonctions LDAP, vous devez conna&icirc;tre
    <itemizedlist>
     <listitem>
      <para>
       Le nom ou l'adresse du serveur de dossiers que vous voudrez utiliser
      </para>
     </listitem>
     <listitem>
      <para>
       Le "base dn" du serveur (la partie du dossier monde
       qui est disponible sur ce serveur, ce qui peut &ecirc;tre
       "o=Ma Compagnie,c=FR")
      </para>
     </listitem>
     <listitem>
      <para>
       Le mot de passe &eacute;ventuel d'acc&egrave;s au serveur (de nombreux
       serveurs fournissent un acc&egrave;s anonyme en lecture, mais 
       requi&egrave;rent des mots de passe pour tout le reste.
      </para>
     </listitem>
    </itemizedlist>
   </para>
   <para>
    La s&eacute;quence LDAP typique que vous ex&eacute;cuterez sera la
    suivante : 
    <literallayout>
  ldap_connect()    // &eacute;tablit une connexion au serveur
     |
  ldap_bind()       // connexion anonyme ou identifi&eacute;e
     |
  r&eacute;alisation de commadnes comme des recherches ou des
  modifications, puis affichage du r&eacute;sultat.
     |
  ldap_close()      // d&eacute;connexion
     </literallayout>
    </para>
   </section>
  </partintro>
&reference.ldap.functions;
 </reference>
<!-- Keep this comment at the end of the file
Local variables:
mode: sgml
sgml-omittag:t
sgml-shorttag:t
sgml-minimize-attributes:nil
sgml-always-quote-attributes:t
sgml-indent-step:1
sgml-indent-data:t
indent-tabs-mode:nil
sgml-parent-document:nil
sgml-default-dtd-file:"../../../manual.ced"
sgml-exposed-tags:nil
sgml-local-catalogs:nil
sgml-local-ecat-files:nil
End:
vim600: syn=xml fen fdm=syntax fdl=2 si
vim: et tw=78 syn=sgml
vi: ts=1 sw=1
-->
