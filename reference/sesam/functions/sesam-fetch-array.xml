<?xml version="1.0" encoding="iso-8859-1"?>
<!-- $Revision: 1.17 $ -->
<!-- EN-Revision: 1.9 Maintainer: yannick Status: ready -->
<!-- Reviewed: yes -->

<refentry xml:id="function.sesam-fetch-array" xmlns="http://docbook.org/ns/docbook">
 <refnamediv>
  <refname>sesam_fetch_array</refname>
  <refpurpose>Lit une ligne dans un tableau associatif</refpurpose>
 </refnamediv>

 <refsect1 role="description">
  &reftitle.description;
  <methodsynopsis>
   <type>array</type><methodname>sesam_fetch_array</methodname>
   <methodparam><type>string</type><parameter>result_id</parameter></methodparam>
   <methodparam choice="opt"><type>int</type><parameter>whence</parameter></methodparam>
   <methodparam choice="opt"><type>int</type><parameter>offset</parameter></methodparam>
  </methodsynopsis>
  <para>
   <function>sesam_fetch_array</function> est une version alternative de
   <function>sesam_fetch_row</function>. Au lieu de stocker les
   données dans un tableau à indice numérique, il enregistre les
   données dans un tableau associatif, en utilisant les noms
   des champs comme clés.
  </para>
  <para>
   <function>sesam_fetch_array</function> lit une ligne de données dans
   le résultat <parameter>result_id</parameter>. La ligne est
   retournée sous forme d'un tableau associatif. Chaque colonne est
   enregistrée avec son nom comme index. Les noms des colonnes
   sont convertis en minuscules.
  </para>
  <para>
   Les colonnes sans nom (par exemple, les résultats d'opérations
   arithmétiques) et les champs vides ne sont pas stockés dans
   ce tableau. De plus, si deux colonnes ont le même nom, la dernière
   colonne écrasera la précédente. Dans cette situation, utilisez
   de préférence <function>sesam_fetch_row</function> ou bien, faites un
   alias de la colonne.
   <informalexample>
    <programlisting role="sesam">
<![CDATA[
SELECT TBL1.COL AS FOO, TBL2.COL AS BAR FROM TBL1, TBL2
]]>
    </programlisting>
   </informalexample>
  </para>
  <para>
   Une gestion spéciale permet de lire les champs multiples, qui
   sinon, auraient toutes le même nom. Pour chaque colonne d'un
   champ multiple, le nom d'index est créé en ajoutant le
   numéro de sous-index à la suite du nom de la colonne. Ces sous-index
   sont numérotés à partir de 1.
   <informalexample>
    <programlisting role="sesam">
<![CDATA[
CREATE TABLE ... ( ... MULTI(3) INT )
]]>
    </programlisting>
   </informalexample>
   Les index associatifs utilisés pour les valeurs individuelles
   du champ multiple sont : <literal>"multi(1)"</literal>,
   <literal>"multi(2)"</literal>, et <literal>"multi(3)"</literal>,
   respectivement.
  </para>
  <para>
   Les prochains appels à <function>sesam_fetch_array</function> liront la
   prochaine ligne (ou la précédente, ou la n-ième, suivant les
   attributs de défilement), jusqu'à ce qu'il n'y ait plus de lignes.
  </para>
 </refsect1>

 <refsect1 role="parameters">
  &reftitle.parameters;
  <para>
   <variablelist>
    <varlistentry>
     <term><parameter>result_id</parameter></term>
     <listitem>
      <para>
       Un identifiant de résultats valide, retourné par la fonction
       <function>sesam_query</function>.
      </para>
     </listitem>
    </varlistentry>
    <varlistentry>
     <term><parameter>whence</parameter></term>
     <listitem>
      <para>
       <parameter>whence</parameter> est un paramètre optionnel pour
       une opération de récupération sur des curseurs scrollables,
       qui peut être défini à une constante prédéfinie parmis la liste
       suivante :
       <table>
        <title>Valeurs valides pour le paramètre <parameter>"whence"</parameter></title>
        <tgroup cols="3">
         <thead>
          <row>
           <entry>Valeur</entry>
           <entry>Constante</entry>
           <entry>Signification</entry>
          </row>
         </thead>
         <tbody>
          <row>
           <entry>0</entry>
           <entry><constant>SESAM_SEEK_NEXT</constant></entry>
           <entry>
            lecture séquentielle (après une récupération, le pointeur interne
            est défini à <constant>SESAM_SEEK_NEXT</constant>)
           </entry>
          </row>
          <row>
           <entry>1</entry>
           <entry><constant>SESAM_SEEK_PRIOR</constant></entry>
           <entry>
            lecture séquentielle en arrière (après une récupération,
            le pointeur interne est défini à <constant>SESAM_SEEK_PRIOR</constant>)
           </entry>
          </row>
          <row>
           <entry>2</entry>
           <entry><constant>SESAM_SEEK_FIRST</constant></entry>
           <entry>
            Revient à la première ligne (après une récupération, le pointeur
            interne est défini à <constant>SESAM_SEEK_NEXT</constant>)
           </entry>
          </row>
          <row>
           <entry>3</entry>
           <entry><constant>SESAM_SEEK_LAST</constant></entry>
           <entry>
            Se place à la dernière ligne (après une récupération, le pointeur
            interne est défini à <constant>SESAM_SEEK_PRIOR</constant>)
           </entry>
          </row>
          <row>
           <entry>4</entry>
           <entry><constant>SESAM_SEEK_ABSOLUTE</constant></entry>
           <entry>
            Se place à un numéro absolu de ligne donné
            par le paramètre <parameter>offset</parameter> (Commence à zéro.
            Après une récupération, le pointeur interne est défini à
            <constant>SESAM_SEEK_ABSOLUTE</constant>, et la valeur interne de la position
            est auto_incrémenté)
           </entry>
          </row>
          <row>
           <entry>5</entry>
           <entry><constant>SESAM_SEEK_RELATIVE</constant></entry>
           <entry>
            Se déplace par rapport à la position courante du curseur, où
            <parameter>offset</parameter> peut être une valeur de position
            positive ou négative.
           </entry>
          </row>
         </tbody>
        </tgroup>
       </table>
       Ce paramètre n'est valide que pour les curseurs scrollables.
      </para>
      <para>
       Lors de l'utilisation de curseurs scrollables, le curseur peut être
       positionné sur le jeu de résultats librement. Si le paramètre
       <parameter>whence</parameter> est omis, les valeurs par défaut globales
       pour le type de scrollage (initialisé à
       <constant>SESAM_SEEK_NEXT</constant>, et définissable par la fonction
       <function>sesam_seek_row</function>) sont utilisées. Si le paramètre
       <parameter>whence</parameter> est fourni, ses valeurs remplacent les valeurs
       globales par défaut.
      </para>
     </listitem>
    </varlistentry>
    <varlistentry>
     <term><parameter>offset</parameter></term>
     <listitem>
      <para>
       Uniquement évalué (et nécessaire) si le paramètre
       <parameter>whence</parameter> vaut soit
       <constant>SESAM_SEEK_RELATIVE</constant>, soit
       <constant>SESAM_SEEK_ABSOLUTE</constant>. Ce paramètre est uniquement
       valide pourles curseurs scrollables.
      </para>
     </listitem>
    </varlistentry>
   </variablelist>
  </para>
 </refsect1>

 <refsect1 role="returnvalues">
  &reftitle.returnvalues;
  <para>
   Retourne un tableau qui correspond à la ligne lue dans le
   résultat <parameter>result_id</parameter>, ou &false; s'il
   n'y a pas d'autres lignes.
  </para>
 </refsect1>

 <refsect1 role="examples">
  &reftitle.examples;
  <para>
   <example>
    <title>Exemple avec <function>sesam_fetch_array</function></title>
    <programlisting role="php">
<![CDATA[
<?php
$result = sesam_query("SELECT * FROM phone\n" .
                       "  WHERE LASTNAME='" . strtoupper($name) . "'\n".
                       "  ORDER BY FIRSTNAME", 1);
if (!$result) {
    /* ... erreur ... */
}
// Affiche la table
echo "<table border=\"1\">\n";
while (($row = sesam_fetch_array($result)) && count($row) > 0) {
    echo "<tr>\n";
    echo "<td>" . htmlspecialchars($row["firstname"]) . "</td>\n";
    echo "<td>" . htmlspecialchars($row["lastname"]) . "</td>\n";
    echo "<td>" . htmlspecialchars($row["phoneno"]) . "</td>\n";
    echo "</tr>\n";
}
echo "</table>\n";
sesam_free_result($result);
?>
]]>
    </programlisting>
   </example>
  </para>
 </refsect1>

 <refsect1 role="seealso">
  &reftitle.seealso;
  <para>
   <simplelist>
    <member><function>sesam_fetch_row</function></member>
   </simplelist>
  </para>
 </refsect1>

</refentry>

<!-- Keep this comment at the end of the file
Local variables:
mode: sgml
sgml-omittag:t
sgml-shorttag:t
sgml-minimize-attributes:nil
sgml-always-quote-attributes:t
sgml-indent-step:1
sgml-indent-data:t
indent-tabs-mode:nil
sgml-parent-document:nil
sgml-default-dtd-file:"../../../../manual.ced"
sgml-exposed-tags:nil
sgml-local-catalogs:nil
sgml-local-ecat-files:nil
End:
vim600: syn=xml fen fdm=syntax fdl=2 si
vim: et tw=78 syn=sgml
vi: ts=1 sw=1
-->