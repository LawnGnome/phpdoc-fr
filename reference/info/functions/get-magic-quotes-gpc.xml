<?xml version="1.0" encoding="iso-8859-1"?>
<!-- $Revision: 1.9 $ -->
<!-- EN-Revision: 1.9 Maintainer: didou Status: ready -->
<!-- Reviewed: no -->
 <refentry id="function.get-magic-quotes-gpc">
  <refnamediv>
   <refname>get_magic_quotes_gpc</refname>
   <refpurpose>Retourne la configuration actuelle de l'option magic_quotes_gpc</refpurpose>
  </refnamediv>
  <refsect1>
   <title>Description</title>
     <methodsynopsis>
      <type>int</type><methodname>get_magic_quotes_gpc</methodname>
      <void/>
     </methodsynopsis>
   <simpara>
    <function>get_magic_quotes_gpc</function> retourne la configuration actuelle
    de l'option <link linkend="ini.magic-quotes-gpc">magic_quotes_gpc</link>
    (0 pour l'option désactivée, 1 pour l'option activée).
   </simpara>
    <note>
     <para>
      Si la directive <link linkend="ini.magic-quotes-sybase">magic_quotes_sybase</link>
      est activée, elle remplacera complètement <parameter>magic_quotes_gpc</parameter>.
      Ce qui fait que même si <function>get_magic_quotes</function> retourne
      &true; les guillemets doubles, les anti-slashes ou les caractères
      NULL ne seront pas protégés. Seul les guillemets simples le seront. Dans
      ce cas, ils ressembleront à <emphasis>''</emphasis>.
     </para>
    </note>
    <simpara>
     Gardez en tête que la configuration de 
     <link linkend="ini.magic-quotes-gpc">magic_quotes_gpc</link> ne fonctionnera pas
     durant l'exécution du script.
    </simpara>
    <para>
     <example>
      <title>Exemple avec <function>get_magic_quotes_gpc</function></title>
      <programlisting role="php">
<![CDATA[
<?php
echo get_magic_quotes_gpc();         // 1
echo $_POST['lastname'];             // O\'reilly
echo addslashes($_POST['lastname']); // O\\\'reilly

if (!get_magic_quotes_gpc()) {
    $lastname = addslashes($_POST['lastname']);
} else {
    $lastname = $_POST['lastname'];
}

echo $lastname; // O\'reilly
$sql = "INSERT INTO lastnames (lastname) VALUES ('$lastname')";
?>
]]>
      </programlisting>
     </example>
    </para>
    <para>
     Dans le but d'écrire du code portable (code qui fonctionne sur n'importe quel environnement),
     ou si vous n'avez pas accès au php.ini, vous devriez désactiver l'effet des maquic quotes.
     Celà peut se faire de deux façons, avec une directive dans un fichier .htaccess 
     (php_value magic_quotes_gpc 0) ou en ajoutant le code ci-dessous en haut de  vos scripts.
     <example>
      <title>Désactivation des magic quotes lors de l'exécution</title>
      <programlisting role="php">
<![CDATA[
<?php
if (get_magic_quotes_gpc()) {
    $_POST = array_map('stripslashes', $_POST);
    $_GET = array_map('stripslashes', $_GET);
    $_COOKIE = array_map('stripslashes', $_COOKIE);
}
]]>
      </programlisting>
     </example>
     Magic-quotes a été ajouté pour réduire l'écriture de codes dangereux par les débutant.
     Si vous désactivez les magic quotes, vous devez être très prudent 
     en vous protégeant des attaques injections SQL.
    </para>
    <simpara>
     Voir aussi
     <function>addslashes</function>,
     <function>stripslashes</function>,
     <function>get_magic_quotes_runtime</function> et
     <function>ini_get</function>.
    </simpara>
  </refsect1>
 </refentry>

<!-- Keep this comment at the end of the file
Local variables:
mode: sgml
sgml-omittag:t
sgml-shorttag:t
sgml-minimize-attributes:nil
sgml-always-quote-attributes:t
sgml-indent-step:1
sgml-indent-data:t
indent-tabs-mode:nil
sgml-parent-document:nil
sgml-default-dtd-file:"../../../../manual.ced"
sgml-exposed-tags:nil
sgml-local-catalogs:nil
sgml-local-ecat-files:nil
End:
vim600: syn=xml fen fdm=syntax fdl=2 si
vim: et tw=78 syn=sgml
vi: ts=1 sw=1
-->
