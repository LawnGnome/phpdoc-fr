<?xml version="1.0" encoding="iso-8859-1"?>
<!-- $Revision: 1.1 $ -->
 <reference id="ref.oci8">
  <title>Oracle 8</title>
  <titleabbrev>oci8</titleabbrev>
  <partintro>
   <para>
     Ces fonctions vous permettront d'acc&eacute;der aux serveurs Oracle8 et
     Oracle7. Elles utilisent l'interface Oracle8 Call-Interface (oci8).
     Vous aurez donc besoin des librairies clientes Oracle8 pour pouvoir
     les utiliser.
   </para>
   <para>
     Il faut noter que cette extension est plus souple que l'extension Oracle
     officielle. Elle supporte notamment les liaisons entre les variables
     globales et locales de PHP avec des emplacements Oracle; elle supporte
     compl&egrave;tement les types LOB, FILE et ROWID et vous permet
     d'utiliser des variables de d&eacute;finitions personnalisables.
  </para>
   <para>
    Avant d'utiliser cette extension, assurez-vous que vous avez bien
    param&eacute;tr&eacute; vos variables d'environnement Oracle, ainsi que votre
    d&eacute;mon utilisateur. Les variables dont vous pouvez avoir besoin sont :
    <itemizedlist>
     <listitem>
      <simpara>
       ORACLE_HOME
      </simpara>
     </listitem>
     <listitem>
      <simpara>
       ORACLE_SID
      </simpara>
     </listitem>
     <listitem>
      <simpara>
       LD_PRELOAD
      </simpara>
     </listitem>
     <listitem>
      <simpara>
       LD_LIBRARY_PATH
      </simpara>
     </listitem>
     <listitem>
      <simpara>
       NLS_LANG
      </simpara>
     </listitem>
     <listitem>
      <simpara>
       ORA_NLS33
      </simpara>
     </listitem>
    </itemizedlist>
   </para>
   <para>
    Apr&egrave;s avoir configur&eacute; ces variables pour votre utilisateur "serveur
    web", assurez-vous aussi d'ajouter cet utilisateur (nobody, www)
    au group Oracle.
   </para>
   <note>
    <title>
      Si votre serveur web ne d&eacute;marre pas, ou crashe au d&eacute;marrage
     </title>
    <para>
     V&eacute;rifiez que Apache a bien &eacute;t&eacute; compil&eacute; avec la librairie pthread :
    </para>
    <para>
     <informalexample>
      <programlisting>
# ldd /www/apache/bin/httpd
    libpthread.so.0 => /lib/libpthread.so.0 (0x4001c000)
    libm.so.6 => /lib/libm.so.6 (0x4002f000)
    libcrypt.so.1 => /lib/libcrypt.so.1 (0x4004c000)
    libdl.so.2 => /lib/libdl.so.2 (0x4007a000)
    libc.so.6 => /lib/libc.so.6 (0x4007e000)
    /lib/ld-linux.so.2 => /lib/ld-linux.so.2 (0x40000000)
      </programlisting>
     </informalexample>
    </para>
    <para>
     Si la libpthread n'est pas list&eacute;e, vous devez r&eacute;installer Apache :
    </para>
    <para>
     <informalexample>
      <programlisting>
# cd /usr/src/apache_1.3.xx
# make clean
# LIBS=-lpthread ./config.status
# make
# make install
      </programlisting>
     </informalexample>
    </para>
   </note>
   <para>
    <example>
     <title>Aide oci</title>
      <programlisting role="php">
&lt;?php
// par sergo@bacup.ru
// Utilisez l'option : oci_DEFAULT pour &eacute;x&eacute;cuter les commandes avec un d&eacute;lai
ociExecute($stmt, oci_DEFAULT);
// pour lire les donn&eacute;es apr&egrave;s lecture, utilisez :
$result = ociResult($stmt, $n);
if (is_object ($result)) $result = $result->load();
// Pour les commandes INSERT ou UPDATE utilisez:
$sql = "insert into table (field1, field2) values (field1 = 'value',
 field2 = empty_clob()) returning field2 into :field2";
ociparse($conn, $sql);
$clob = ociNewDescriptor($conn, oci_D_LOB);
ociBindByName ($stmt, ":field2", &amp;$clob, -1, oci_B_CLOB);
ociexecute($stmt, oci_DEFAULT);
$clob->save ("Du texte");
ocicommit($conn);
?&gt;
     </programlisting>
    </example>
   </para>
   <para>
    Vous pouvez facilement acc&eacute;der aux proc&eacute;dures stock&eacute;es, de la m&ecirc;me
    fa&ccedil;on que vous le feriez par ligne de commande :
    <example>
     <title>Utilisation de proc&eacute;dures stock&eacute;es</title>
      <programlisting role="php">
&lt;?php
// par webmaster@remoterealty.com
$sth = ociparse ( $dbh, "begin sp_newaddress( :address_id, '$firstname',
 '$lastname', '$company', '$address1', '$address2', '$city', '$state',
 '$postalcode', '$country', :error_code );end;" );
// Ce script appelle la proc&eacute;dure stock&eacute;e sp_newaddress, avec address_id qui est
// une variable entrante/sortante et :error_code une variable sortante.
// Lorsque vous les liez :
   ociBindByName ( $sth, ":address_id", $addr_id, 10 );
   ociBindByName ( $sth, ":error_code", $errorcode, 10 );
   ociExecute ( $sth );
?&gt;
     </programlisting>
    </example>
   </para>
  </partintro>
&reference.oci8.functions;

 </reference>
<!-- Keep this comment at the end of the file
Local variables:
mode: sgml
sgml-omittag:t
sgml-shorttag:t
sgml-minimize-attributes:nil
sgml-always-quote-attributes:t
sgml-indent-step:1
sgml-indent-data:t
indent-tabs-mode:nil
sgml-parent-document:nil
sgml-default-dtd-file:"../manual.ced"
sgml-exposed-tags:nil
sgml-local-catalogs:nil
sgml-local-ecat-files:nil
End:
-->

