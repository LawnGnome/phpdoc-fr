<?xml version="1.0" encoding="iso-8859-1"?>
<!-- $Revision: 1.7 $ -->
<!-- EN-Revision: 1.3 Maintainer: yannick Status: ready -->
<!-- Reviewed: yes -->
  <refentry id="function.mysqli-stmt-prepare">
   <refnamediv>
    <refname>mysqli_stmt_prepare</refname>
    <refname>stmt->prepare</refname>
    <refpurpose>
     Prépare une requête SQL pour l'exécution
    </refpurpose>
   </refnamediv>
   <refsect1>
    &reftitle.description;
     &title.procedural;
     <methodsynopsis>
      <type>bool</type><methodname>mysqli_stmt_prepare</methodname>
      <methodparam><type>mysqli_stmt</type><parameter>stmt</parameter></methodparam>
      <methodparam><type>string</type><parameter>query</parameter></methodparam>
     </methodsynopsis>
    &title.oop;
     <classsynopsis>
      <ooclass><classname>mysqli_stmt</classname></ooclass>
      <methodsynopsis>
       <type>mixed</type><methodname>prepare</methodname>
       <methodparam><type>string</type><parameter>query</parameter></methodparam>
      </methodsynopsis>
     </classsynopsis>
     <para>
      <function>mysqli_stmt_prepare</function> prépare la requête SQL
      <parameter>query</parameter>, pour la session de travail
      <parameter>stmt</parameter>. <parameter>stmt</parameter> doit
      avoir été alloué par <function>mysqli_stmt_init</function>.
      La requête doit être une seule requête SQL.
     </para>
     <note>
      <para>
       Il ne faut pas ajouter de point-virgule ou de <literal>\g</literal>
       à la fin de la requête.
      </para>
     </note>
     <para>
      Le paramètre <parameter>query</parameter> peut inclure une ou plusieurs
      variables SQL, en utilisant des points d'interrogation 
      (<literal>?</literal>) aux bons endroits.
     </para>
     <note>
      <para>
       Les variables SQL ne sont possibles que dans certaines clauses
       de la requête SQL. Par exemple, elles peuvent être placées dans
       des clause VALUES() d'une requête INSERT (pour spécifier une 
       valeur à insérer), ou dans une clause de condition WHERE.
      </para>
      <para>
       Cependant, elles ne sont pas autorisées pour les identifiants
       (de tables ou de colonnes), dans les listes de colonnes d'un SELECT,
       ou pour spécifier des opérateurs comme <literal>=</literal>. Cette
       dernière restriction est liée au fait qu'il est impossible de déterminer
       le type. En général, les variables SQL ne sont valides que dans 
       les commandes de manipulation de données (Data Manipulation Languange (DML)),
       et non dans les structures du langages SQL (Data Defination Language (DDL)).
      </para>
     </note>
     <para>
      Les variables SQL doivent être associées à une variable &php; à l'aide de
      la fonction <function>mysqli_stmt_bind_param</function> et/ou 
      <function>mysqli_stmt_bind_result</function>, avant d'exécuter la
      requête.
     </para>
   </refsect1>
   <refsect1>
    &reftitle.returnvalues;
    <para>
     &return.success;
    </para>
   </refsect1>
   <refsect1>
    &reftitle.seealso;
    <para>
     <function>mysqli_stmt_init</function>,
     <function>mysqli_stmt_execute</function>,
     <function>mysqli_stmt_fetch</function>,
     <function>mysqli_stmt_bind_param</function>,
     <function>mysqli_stmt_bind_result</function> et
     <function>mysqli_stmt_close</function>.
    </para>
   </refsect1>
   <refsect1>
    &reftitle.examples;
    <example>
     <title>Style orienté objet</title>
     <programlisting role="php">
<![CDATA[
<?php
$mysqli = new mysqli("localhost", "utilisateur", "mot_de_passe", "base");

/* Vérification de la connexion */
if (mysqli_connect_errno()) {
    printf("Connect failed: %s\n", mysqli_connect_error());
    exit();
}

$city = "Amersfoort";

/* Création d'une requête préparée */
$stmt =  $mysqli->stmt_init();
if ($stmt->prepare("SELECT Region FROM Ville WHERE Name=?")) {

    /* Association des variables SQL */
    $stmt->bind_param("s", $city);

    /* Exécution de la requête */
    $stmt->execute();

    /* Association des variables de résultats */
    $stmt->bind_result($district);

    /* Lecture des valeurs */
    $stmt->fetch();

    printf("%s est dans la région de %s\n", $city, $district);

    /* Fermeture de la commande */
    $stmt->close();
} 

/* Fermeture de la connexion */
$mysqli->close();
?>
]]>
    </programlisting>
    </example>
    <example>
     <title>Style procédural</title>
     <programlisting role="php">
<![CDATA[
<?php
$link = mysqli_connect("localhost", "utilisateur", "mot_de_passe", "base");

/* Vérification de la connexion */
if (mysqli_connect_errno()) {
    printf("Connect failed: %s\n", mysqli_connect_error());
    exit();
}

$city = "Amersfoort";

/* Création d'une requête préparée */
$stmt = mysqli_stmt_init();
if ($stmt = mysqli_stmt_prepare($stmt, "SELECT Region FROM Ville WHERE Name=?")) {

    /* Association des variables SQL */
    mysqli_stmt_bind_param($stmt, "s", $city);

    /* Exécution de la requête */
    mysqli_stmt_execute($stmt);

    /* Association des variables de résultats */
    mysqli_stmt_bind_result($stmt, $district);

    /* Lecture des valeurs */
    mysqli_stmt_fetch($stmt);

    printf("%s est dans la région de %s\n", $city, $district);

    /* Fermeture de la commande */
    mysqli_stmt_close($stmt);
} 

/* Fermeture de la connexion */
mysqli_close($link);
?>
]]>
     </programlisting>
    </example>
    &example.outputs;
    <screen>
<![CDATA[
Amersfoort est dans la région de Utrecht
]]>
    </screen>
   </refsect1>
  </refentry>

<!-- Keep this comment at the end of the file
Local variables:
mode: sgml
sgml-omittag:t
sgml-shorttag:t
sgml-minimize-attributes:nil
sgml-always-quote-attributes:t
sgml-indent-step:1
sgml-indent-data:t
indent-tabs-mode:nil
sgml-parent-document:nil
sgml-default-dtd-file:"../../../../manual.ced"
sgml-exposed-tags:nil
sgml-local-catalogs:nil
sgml-local-ecat-files:nil
End:
vim600: syn=xml fen fdm=syntax fdl=2 si
vim: et tw=78 syn=sgml
vi: ts=1 sw=1
-->
