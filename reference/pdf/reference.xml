<?xml version="1.0" encoding="iso-8859-1"?>
 <reference id="ref.pdf">
  <title>PDF</title>
  <titleabbrev>PDF</titleabbrev>
  <partintro>
   <simpara>
     Vous disposez de fonctions <acronym>PDF</acronym> en PHP pour cr&eacute;er des
     fichiers PDF, pour peu que vous ayez la biblioth&egrave;que PDF
     de Thomas Merz (disponible &agrave; :
     <ulink url="&url.pdf;">&url.pdf;</ulink> (site anglais)). Vous aurez
     aussi besoin des librairies <ulink url="&url.jpeg;">JPEG library</ulink>,
     <ulink url="&url.tiff;">the TIFF library</ulink>, pour compiler cette
     librairie. Ces deux librairies posent pas mal de probl&egrave;mes lors
     de la configuration. Suivez attentivement les messages d'erreur.
   </simpara>
   <simpara>
     Reportez vous &agrave; l'excellente documentation de PDFLib, disponible
     avec la  distribution de PDFLib. C'est une introduction tr&egrave;s
     pratique des possibilit&eacute;s de PDFLib et elle contient la liste
     la plus compl&egrave;te et les descriptions les plus &agrave; jours des fonctions.
    </simpara>
    <simpara>
     Toutes les fonctions de PDFLib se retrouvent dans PHP sous le m&ecirc;me nom.
     De m&ecirc;me, les param&egrave;tres sont identiques.
     Vous devez conna&icirc;tre les concepts
     de base de PDF ou de Postscript pour utiliser efficacement ce module.
     Toutes les longueurs et coordonn&eacute;es sont mesur&eacute;es en
     points Postscript points. Il y a g&eacute;n&eacute;ralement
     72 points PostScript par pouce, mais cela d&eacute;pend en
     fait de la r&eacute;solution d'affichage.
   </simpara>
   <simpara>
     Il y a un autre module PHP pour cr&eacute;er des document PDF,
     bas&eacute; sur la biblioth&egrave;que
     <ulink url="&url.cpdf;">FastIO's</ulink>'s ClibPDF.
     Les API sont l&eacute;g&egrave;rement diff&eacute;rentes.
     Reportez-vous &agrave; la section
     <link linkend="ref.cpdf">fonctions ClipPDF</link> pour plus de d&eacute;tails.
   </simpara>
   <simpara>
     Le module PDF introduit un nouveau type de variables. C'est
     <parameter>pdfdoc</parameter> : c'est un pointeur sur un
     document PDF et toutes les fonctions l'utilise comme premier
     param&egrave;tre.
   </simpara>
   <section id="pdf.oldlibs.confusion">
    <title>Confusion entre les vieilles versions de PDFLib</title>
    <simpara>
     Depuis le d&eacute;but du support de PDF sous PHP,
     (commen&ccedil;ant avec la version PDFLib 0.6), il y a eu des milliers
     de modifications dans les API de PDFLib. La plus part de ces modifications
     ont &eacute;t&eacute; suivies par PHP, et parfois m&ecirc;me au prix
     de modifications des API PHP. Depuis la version 3.x, ces API semblent
     s'&ecirc;tre stabilis&eacute;es, et PHP 4 a adopt&eacute;e cette
     version comme le minimum n&eacute;cessaire pour supporter PDF.
     En cons&eacute;quence de quoi, un grand nombre de fonction vont
     dispara&icirc;tre, ou &ecirc;tre remplac&eacute;e. Le support de
     PDFLib 0.6 est compl&eacute;tement abandonn&eacute;. La liste suivante
     indique quelles sont les fonctions obsol&egrave;tes en PHP 4.02, et qui
     devraient &ecirc;tre remplac&eacute;es par de nouvelles versions.
    </simpara>
    <para>
     <table>
      <title>Fonctions obsol&egrave;tes et leur remplacements</title>
      <tgroup cols="2">
       <thead>
        <row>
         <entry>Anciennes fonctions</entry>
         <entry>Nouvelles fonctions</entry>
        </row>
       </thead>
       <tbody>
        <row>
         <entry>pdf_put_image()</entry>
         <entry>D&eacute;sormais inutile</entry>
        </row>
        <row>
         <entry>pdf_execute_image()</entry>
         <entry>D&eacute;sormais inutile</entry>
        </row>
        <row>
         <entry>pdf_get_annotation()</entry>
         <entry>
          <function>pdf_get_bookmark</function> avec les m&ecirc;mes param&egrave;tres.
         </entry>
        </row>
        <row>
         <entry>pdf_get_font()</entry>
         <entry><function>pdf_get_value</function> avec
         <literal>"font"</literal> comme second param&egrave;tre.</entry>
        </row>
        <row>
         <entry>pdf_get_fontsize()</entry>
         <entry><function>pdf_get_value</function> avec
                <literal>"fontsize"</literal> comme second param&egrave;tre.</entry>
        </row>
        <row>
         <entry>pdf_get_fontname()</entry>
         <entry><function>pdf_get_parameter</function>  avec
         <literal>"fontname"</literal> comme second param&egrave;tre.</entry>
        </row>
        <row>
         <entry>pdf_set_info_creator()</entry>
         <entry><function>pdf_set_info</function> avec
         <literal>"Creator"</literal> comme second param&egrave;tre.</entry>
        </row>
        <row>
         <entry>pdf_set_info_title()</entry>
         <entry><function>pdf_set_info</function> avec
         <literal>"Title"</literal> comme second param&egrave;tre.</entry>
        </row>
        <row>
         <entry>pdf_set_info_subject()</entry>
         <entry><function>pdf_set_info</function> avec
         <literal>"Subject"</literal> comme second param&egrave;tre.</entry>
        </row>
        <row>
         <entry>pdf_set_info_author()</entry>
         <entry><function>pdf_set_info</function> avec
         <literal>"Author"</literal> comme second param&egrave;tre.</entry>
        </row>
        <row>
         <entry>pdf_set_info_keywords()</entry>
         <entry><function>pdf_set_info</function> avec
         <literal>"Keywords"</literal> comme second param&egrave;tre.</entry>
        </row>
        <row>
         <entry>pdf_set_leading()</entry>
         <entry><function>pdf_set_value</function> avec
         <literal>"leading"</literal> comme second param&egrave;tre.</entry>
        </row>
        <row>
         <entry>pdf_set_text_rendering()</entry>
         <entry><function>pdf_set_value</function> avec
         <literal>"textrendering"</literal> comme second param&egrave;tre.</entry>
        </row>
        <row>
         <entry>pdf_set_text_rise()</entry>
         <entry><function>pdf_set_value</function> avec
         <literal>"textrise"</literal> comme second param&egrave;tre.</entry>
        </row>
        <row>
         <entry>pdf_set_horiz_scaling()</entry>
         <entry><function>pdf_set_value</function> avec
         <literal>"horizscaling"</literal> comme second param&egrave;tre.</entry>
        </row>
        <row>
         <entry>pdf_set_text_matrix()</entry>
         <entry>D&eacute;sormais inutile</entry>
        </row>
        <row>
         <entry>pdf_set_char_spacing()</entry>
         <entry><function>pdf_set_value</function> avec
         <literal>"charspacing"</literal> comme second param&egrave;tre.</entry>
        </row>
        <row>
         <entry>pdf_set_word_spacing()</entry>
         <entry><function>pdf_set_value</function> avec
         <literal>"wordspacing"</literal> comme second param&egrave;tre.</entry>
        </row>
        <row>
         <entry>pdf_set_transition()</entry>
         <entry><function>pdf_set_parameter</function> avec
         <literal>"transition"</literal> comme second param&egrave;tre.</entry>
        </row>
        <row>
         <entry>pdf_open()</entry>
         <entry><function>pdf_new</function> suivi d'un appel &agrave;
         <function>pdf_open_file</function></entry>
        </row>
        <row>
         <entry>pdf_set_font()</entry>
         <entry><function>pdf_findfont</function> suivi d'un appel &agrave;
	     <function>pdf_setfont</function></entry>
        </row>
        <row>
         <entry>pdf_set_duration()</entry>
         <entry><function>pdf_set_value</function> avec
         <literal>"duration"</literal> comme second param&egrave;tre.</entry>
        </row>
        <row>
         <entry>pdf_open_gif()</entry>
         <entry><function>pdf_open_image_file</function> avec
         <literal>"gif"</literal> comme second param&egrave;tre.</entry>
        </row>
        <row>
         <entry>pdf_open_jpeg()</entry>
         <entry><function>pdf_open_image_file</function> avec
         <literal>"jpeg"</literal> comme second param&egrave;tre.</entry>
        </row>
        <row>
         <entry>pdf_open_tiff()</entry>
         <entry><function>pdf_open_image_file</function> avec
         <literal>"tiff"</literal> comme second param&egrave;tre.</entry>
        </row>
        <row>
         <entry>pdf_open_png()</entry>
         <entry><function>pdf_open_image_file</function> avec
         <literal>"png"</literal> comme second param&egrave;tre.</entry>
        </row>
        <row>
         <entry>pdf_get_imagewidth()</entry>
         <entry><function>pdf_get_value</function> avec
         <literal>"imagewidth"</literal> comme second param&egrave;tre et
         l'image comme troisi&egrave;me.</entry>
        </row>
        <row>
         <entry>pdf_get_imageheight()</entry>
         <entry><function>pdf_get_value</function> avec
         <literal>"imageheight"</literal> comme second param&egrave;tre et
         l'image comme troisi&egrave;me.</entry>
        </row>
       </tbody>
      </tgroup>
     </table>
    </para>
   </section>
   <section id="pdf.install.pdflib">
    <title>Conseils pour installer PDFLib 3.x</title>
    <simpara>
     Depuis la version 3.0 de PDFLib vous pouvez configurer cette librairie
     avec l'option <literal>--enable-shared-pdflib</literal>.
    </simpara>
   </section>
   <section id="pdf.oldlibs.versions">
    <title>Choix de la version de PDFlib</title>
    <simpara>
     Avec toutes les versions de PHP 4, ult&eacute;rieure au 9 mars 2000,
     vous devez utiliser PDFlib 3.0 ou plus r&eacute;cent.
    </simpara>
    <simpara>
     PHP 3, d'un autre cot&eacute;, ne doit pas &ecirc;tre utilis&eacute;
     avec une version plus r&eacute;cente que la 2.01. Depuis la
     version 1.61 du source <filename>php3/functions/pdf.c</filename>
     (php 3.19), il est possible d'utiliser la version PDFlib 3.0 ou
     plus r&eacute;cent.
    </simpara>
   </section>
   <section id="pdf.oldlibs.hints">
    <title>Installation des anciennes versions de PDFLib</title>
    <simpara>
     Si vous utilisez PDFLib 2.01 v&eacute;rifiez comment votre librairie a
     &eacute;t&eacute; install&eacute;e. Il doit y avoir un fichier (ou
     un lien) vers <filename>libpdf.so</filename>. La version 2.01 ne fait
     que cr&eacute;er une librairie avec le nom <filename>libpdf2.01.so</filename>
     qui ne peut &ecirc;tre trouv&eacute; lors de la compilation du
     programme de configuration. Vous devez cr&eacute;er vous m&ecirc;me ce lien
     symbolique de <filename>libpdf.so</filename> vers <filename>libpdf2.01.so</filename>.
    </simpara>
    <simpara>
     La version 2.20 de PDFLib a introduit de nombreuses modifications dans ses
     API, ainsi que le support des polices chinoises et japonaises. Cela
     impliquent malheureusement des modifications dans le module PDF de
     PHP 4 (mais pas de PHP 3). Si vous utilisez PDFLib 2.20,
     g&eacute;rer correctement votre m&eacute;moire. Jusqu'&agrave; la version 3.0, PDFLib
     peut se r&eacute;v&eacute;ler tr&egrave;s instable. Le param&egrave;tre d'encodage
     <function>pdf_set_font</function> est devenu une cha&icirc;ne. Cela
     signifique notamment qu'il faut remplacer 4 par 'winansi'.
    </simpara>
    <simpara>
     Si vous utilisez PDFLib 2.30, pdf_set_text_matrix()
     a disparu. Elle n'est plus support&eacute;. En g&eacute;n&eacute;ral,
     il est recommand&eacute; de consulter les notes de version de la PDFLib
     pour lister toutes les modifications.
    </simpara>
    <simpara>
     A partir du 9 mars 2000, PHP 4 ne supporte plus que la
     version 3.0 et plus r&eacute;cente de PDFLib. PHP 3, par contre, ne doit pas
     &ecirc;tre utilis&eacute; avec des versions plus r&eacute;centes que la 2.01.
    </simpara>
   </section>
   <section id="pdf.examples">
    <title>Exemples</title>
    <simpara>
     La plus part des fonctions sont simples d'emploi. Le plus difficile
     est probablement de cr&eacute;er un fichier PDF simple. L'exemple suivant
     devrait vous mettre sur les rails.
     Il cr&eacute;e un fichier <filename>test.pdf</filename> d'une page.
     La page contient du texte "Times Roman outlined", de taille de 30pt.
     Le texte est aussi soulign&eacute;.
    </simpara>
    <para>
     <example>
      <title>Cr&eacute;ation d'un document PDF avec PDFLib</title>
      <programlisting role="php">
&lt;?php
$pdf = pdf_new();
pdf_open_file($pdf, "test.pdf");
pdf_set_info($pdf, "Author", "Uwe Steinmann");
pdf_set_info($pdf, "Title", "Test for PHP wrapper of PDFLib 2.0");
pdf_set_info($pdf, "Creator", "See Author");
pdf_set_info($pdf, "Subject", "Testing");
pdf_begin_page($pdf, 595, 842);
pdf_add_outline($pdf, "Page 1");
pdf_set_font($pdf, "Times-Roman", 30, "host");
pdf_set_value($pdf, "textrendering", 1);
pdf_show_xy($pdf, "Times Roman outlined", 50, 750);
pdf_moveto($pdf, 50, 740);
pdf_lineto($pdf, 330, 740);
pdf_stroke($pdf);
pdf_end_page($pdf);
pdf_close($pdf);
pdf_delete($pdf);
echo "&lt;A HREF=getpdf.php>finished&lt;/A>";
?&gt;
      </programlisting>
      <simpara>
       Ce script <filename>getpdf.php</filename> retourne simplement le document PDF.
      </simpara>
      <informalexample>
       <programlisting role="php">
&lt;?php
$fp = fopen("test.pdf", "r");
header("Content-type: application/pdf");
fpassthru($fp);
fclose($fp);
?&gt;
       </programlisting>
      </informalexample>
     </example>
    </para>
    <para>
     La distribution PDFLib contient un exemple plus complexe,
     qui cr&eacute;e des pages plus &eacute;labor&eacute;es,
     avec une horloge. Cet exemple a &eacute;t&eacute; converti en
     script PHP (vous retrouverez cet exemple dans le module
     <link linkend="ref.cpdf">clibpdf</link>). Il utilise les
     possibilit&eacute;s de cr&eacute;ation de fichier en m&eacute;moire, sans fichier
     temporaire.
    </para>
    <para>
     <example>
      <title>Exemple pdfclock issue de la distribution PDFLib</title>
      <programlisting role="php">
&lt;?php
$radius = 200;
$margin = 20;
$pagecount = 10;
$pdf = pdf_new();
if (!pdf_open_file($pdf, "")) {
    print error;
    exit;
};
pdf_set_parameter($pdf, "warning", "true");
pdf_set_info($pdf, "Creator", "pdf_clock.php");
pdf_set_info($pdf, "Author", "Uwe Steinmann");
pdf_set_info($pdf, "Title", "Analog Clock");
while($pagecount-- > 0) {
    pdf_begin_page($pdf, 2 * ($radius + $margin), 2 * ($radius + $margin));
    pdf_set_parameter($pdf, "transition", "wipe");
    pdf_set_value($pdf, "duration", 0.5);
    pdf_translate($pdf, $radius + $margin, $radius + $margin);
    pdf_save($pdf);
    pdf_setrgbcolor($pdf, 0.0, 0.0, 1.0);
    /* indicateurs de minutes */
    pdf_setlinewidth($pdf, 2.0);
    for ($alpha = 0; $alpha &lt; 360; $alpha += 6) {
        pdf_rotate($pdf, 6.0);
        pdf_moveto($pdf, $radius, 0.0);
        pdf_lineto($pdf, $radius-$margin/3, 0.0);
        pdf_stroke($pdf);
    }
    pdf_restore($pdf);
    pdf_save($pdf);
    /* indicateurs de 5 minutes */
    pdf_setlinewidth($pdf, 3.0);
    for ($alpha = 0; $alpha &lt; 360; $alpha += 30) {
        pdf_rotate($pdf, 30.0);
        pdf_moveto($pdf, $radius, 0.0);
        pdf_lineto($pdf, $radius-$margin, 0.0);
        pdf_stroke($pdf);
    }
    $ltime = getdate();
    /* aiguille des heures */
    pdf_save($pdf);
    pdf_rotate($pdf,-(($ltime['minutes']/60.0)+$ltime['hours']-3.0)*30.0);
    pdf_moveto($pdf, -$radius/10, -$radius/20);
    pdf_lineto($pdf, $radius/2, 0.0);
    pdf_lineto($pdf, -$radius/10, $radius/20);
    pdf_closepath($pdf);
    pdf_fill($pdf);
    pdf_restore($pdf);
    /* aiguille des minutes */
    pdf_save($pdf);
    pdf_rotate($pdf,-(($ltime['seconds']/60.0)+$ltime['minutes']-15.0)*6.0);
    pdf_moveto($pdf, -$radius/10, -$radius/20);
    pdf_lineto($pdf, $radius * 0.8, 0.0);
    pdf_lineto($pdf, -$radius/10, $radius/20);
    pdf_closepath($pdf);
    pdf_fill($pdf);
    pdf_restore($pdf);
    /* aiguille des secondes */
    pdf_setrgbcolor($pdf, 1.0, 0.0, 0.0);
    pdf_setlinewidth($pdf, 2);
    pdf_save($pdf);
    pdf_rotate($pdf, -(($ltime['seconds'] - 15.0) * 6.0));
    pdf_moveto($pdf, -$radius/5, 0.0);
    pdf_lineto($pdf, $radius, 0.0);
    pdf_stroke($pdf);
    pdf_restore($pdf);
    /* petit cercle au centre */
    pdf_circle($pdf, 0, 0, $radius/30);
    pdf_fill($pdf);
    pdf_restore($pdf);
    pdf_end_page($pdf);
    # pour voir une diff&eacute;rence
    sleep(1);
}
pdf_close($pdf);
$buf = pdf_get_buffer($pdf);
$len = strlen($buf);
header("Content-type: application/pdf");
header("Content-Length: $len");
header("Content-Disposition: inline; filename=foo.pdf");
print $buf;
pdf_delete($pdf);
?&gt;
      </programlisting>
     </example>
    </para>
   </section>
  </partintro>

&reference.pdf.functions;

</reference>
<!-- Keep this comment at the end of the file
Local variables:
mode: sgml
sgml-omittag:t
sgml-shorttag:t
sgml-minimize-attributes:nil
sgml-always-quote-attributes:t
sgml-indent-step:1
sgml-indent-data:t
indent-tabs-mode:nil
sgml-parent-document:nil
sgml-default-dtd-file:"../../../manual.ced"
sgml-exposed-tags:nil
sgml-local-catalogs:nil
sgml-local-ecat-files:nil
End:
-->

