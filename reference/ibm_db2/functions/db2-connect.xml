<?xml version="1.0" encoding="iso-8859-1"?>
<!-- $Revision: 1.11 $ -->
<!-- EN-Revision: 1.12 Maintainer: yannick Status: ready -->
<!-- Reviewed: no -->

<refentry xml:id="function.db2-connect" xmlns="http://docbook.org/ns/docbook">
 <refnamediv>
  <refname>db2_connect</refname>
  <refpurpose>
   Retourne une connexion à une base de données
  </refpurpose>
 </refnamediv>
 <refsect1 role="description">
  &reftitle.description;
  <methodsynopsis>
   <type>resource</type><methodname>db2_connect</methodname>
   <methodparam><type>string</type><parameter>database</parameter></methodparam>
   <methodparam><type>string</type><parameter>username</parameter></methodparam>
   <methodparam><type>string</type><parameter>password</parameter></methodparam>
   <methodparam choice="opt"><type>array</type><parameter>options</parameter></methodparam>
  </methodsynopsis>

  <para>
   Crée une nouvelle connexion à une base de données IBM DB2 Universal
   Database, IBM Cloudscape ou Apache Derby.
  </para>

 </refsect1>
 <refsect1 role="parameters">
  &reftitle.parameters;
  <para>
   <variablelist>
    <varlistentry>
     <term><parameter>database</parameter></term>
     <listitem>
      <para>
       Pour une connexion cataloguée de la base de données, <parameter>database</parameter>
       représente l'alias de la base de données dans le catalogue client DB2
      </para>
      <para>
       Pour une connexion non cataloguée de la base de données, <parameter>database</parameter>
       représente une chaîne complète de connexion qui est dans le format
       suivant :
       <literallayout>DATABASE=<parameter>database</parameter>;HOSTNAME=<parameter>hostname</parameter>;PORT=<parameter>port</parameter>;PROTOCOL=TCPIP;UID=<parameter>username</parameter>;PWD=<parameter>password</parameter>;</literallayout>
       où les paramètres représentent les valeurs suivantes :
       <variablelist>
        <varlistentry>
         <term><parameter>database</parameter></term>
         <listitem>
          <para>
           Le nom de la base de données.
          </para>
         </listitem>
        </varlistentry>
        <varlistentry>
         <term><parameter>hostname</parameter></term>
         <listitem>
          <para>
           L'adresse Internet ou IP du serveur de base de données.
          </para>
         </listitem>
        </varlistentry>
        <varlistentry>
         <term><parameter>port</parameter></term>
         <listitem>
          <para>
           Le port TCP/IP sur lequel la base de données écoute les
           connexions.
          </para>
         </listitem>
        </varlistentry>
        <varlistentry>
         <term><parameter>username</parameter></term>
         <listitem>
          <para>
           Le nom d'utilisateur avec lequel vous vous connectez à la base de
           données.
          </para>
         </listitem>
        </varlistentry>
        <varlistentry>
         <term><parameter>password</parameter></term>
         <listitem>
          <para>
           Le mot de passe avec lequel vous vous connectez à la base de
           données.
          </para>
         </listitem>
        </varlistentry>
       </variablelist>
      </para>
     </listitem>
    </varlistentry>
    <varlistentry>
     <term><parameter>username</parameter></term>
     <listitem>
      <para>
       Le nom d'utilisateur avec lequel vous vous connectez à la base de
       données.
      </para>
      <para>
       Pour les connexions non cataloguées, vous devez passer une valeur
       &null; ou une chaîne vide.
      </para>
     </listitem>
    </varlistentry>
    <varlistentry>
     <term><parameter>password</parameter></term>
     <listitem>
      <para>
       Le mot de passe avec lequel vous vous connectez à la base de
       données.
      </para>
      <para>
       Pour les connexions non cataloguées, vous devez passer une valeur
       &null; ou une chaîne vide.
      </para>
     </listitem>
    </varlistentry>
    <varlistentry>
     <term><parameter>options</parameter></term>
     <listitem>
      <para>
       Un tableau associatif des options de connexion qui affecteront le
       comportement de la connexion, où les valeurs des clés incluent :
       <variablelist>
        <varlistentry>
         <term><parameter>autocommit</parameter></term>
         <listitem>
          <para>
           La valeur <literal>DB2_AUTOCOMMIT_ON</literal> active l'autocommit
           sur cette connexion.
          </para>
          <para>
           La valeur <literal>DB2_AUTOCOMMIT_OFF</literal> désactive le
           autocommit pour cette connexion.
          </para>
         </listitem>
        </varlistentry>
        <varlistentry>
         <term><parameter>DB2_ATTR_CASE</parameter></term>
         <listitem>
          <para>
           Passer la valeur <literal>DB2_CASE_NATURAL</literal> spécifie que les
           noms de colonnes seront retournés dans leurs casses naturelles.
          </para>
          <para>
           Passer la valeur <literal>DB2_CASE_LOWER</literal> spécifie que les
           noms de colonnes seront retournés en minuscule.
          </para>
          <para>
           Passer la valeur <literal>DB2_CASE_UPPER</literal> spécifie que les
           noms de colonnes seront retournés en majuscule.
          </para>
         </listitem>
        </varlistentry>
        <varlistentry>
         <term><parameter>CURSOR</parameter></term>
         <listitem>
          <para>
           Passer la valeur <literal>DB2_FORWARD_ONLY</literal> spécifie un curseur
           uniquement suivant pour une ressource de requête. C'est le type de curseur
           par défaut et est supporté sur tous les serveurs de base de données.
          </para>
          <para>
           Passer la valeur <literal>DB2_SCROLLABLE</literal> spécifie un
           curseur scrollable pour une ressource de requête. Ce mode permet
           un accès aléatoire aux lignes dans un jeu de résultats, mais actuellement,
           n'est supporté que par la base de données IBM DB2 Universal.
          </para>
         </listitem>
        </varlistentry>
       </variablelist>
      </para>
      <para>
       Les nouvelles options suivantes i5/OS sont disponibles depuis la
       version 1.5.1 de ibm_db2.
       Note : les anciennes versions de ibm_db2 ne supportent pas ces
       nouvelles options.
       <variablelist>
        <varlistentry>
         <term><parameter>i5_lib</parameter></term>
         <listitem>
          <para>
           Un caractère qui indique la bibliothèque par défaut qui sera
           utilisée pour résoudre les références aux fichiers non qualifiées.
           Ceci n'est pas valide si la connexion utilise un mode de système de
           nom.
          </para>
         </listitem>
        </varlistentry>
        <varlistentry>
         <term><parameter>i5_naming</parameter></term>
         <listitem>
          <para>
           La valeur <literal>DB2_I5_NAMING_ON</literal> active DB2 UDB Cli
           iSeries mode système de nom. Les fichiers sont qualifiés en
           utilisant le délimiteur slash (/). Les fichiers non qualifiés sont
           résolus en utilisant la liste de bibliothèque pour le travail.
          </para>
          <para>
           La valeur <literal>DB2_I5_NAMING_OFF</literal> désactive DB2 UDB
           CLI mode de nom par défaut, qui est l'écriture SQL. Les fichiers
           sont qualifiés en utilisant le délimiteur point (.). Les fichiers
           non qualifiés sont résolus en utilisant soit la bibliothèque par
           défaut ou l'ID de l'usager courant.
          </para>
         </listitem>
        </varlistentry>
        <varlistentry>
         <term><parameter>i5_commit</parameter></term>
         <listitem>
          <para>
           L'attribut <parameter>i5_commit</parameter> devrait être fixé avant
           l'appel à <function>db2_connect</function>. Si la valeur est
           changée après que la connexion ait été établie et que la connexion
           est à une source de données distance, le changement ne prendra
           effet qu'au prochain appel de <function>db2_connect</function>.
          </para>
          <para>
           Note : la configuration &php.ini; <parameter>ibm_db2.i5_allow_commit</parameter>==0 
           ou <literal>DB2_I5_TXN_NO_COMMIT</literal> est par défaut, mais
           peut être dérivée avec l'option <parameter>i5_commit</parameter>.
          </para>
          <para>
           <literal>DB2_I5_TXN_NO_COMMIT</literal> - Contrôle d'envoi n'est pas utilisé.
          </para>
          <para>
           <literal>DB2_I5_TXN_READ_UNCOMMITTED</literal> - Lecture ancienne,
           lecture non répétitive et fictive est possible.
          </para>
          <para>
           <literal>DB2_I5_TXN_READ_COMMITTED</literal> - Lecture ancienne non
           possible.
           Lecture répétitive et fictive est possible.
          </para>
          <para>
           <literal>DB2_I5_TXN_REPEATABLE_READ</literal> - Lecture ancienne et
           non répétitive n'est pas possible. Lecture fictive est possible.
          </para>
          <para>
           <literal>DB2_I5_TXN_SERIALIZABLE</literal> - Les transactions sont
           sérialisables. Lecture ancienne, non répétitive et fictive n'est
           pas possible.
          </para>
         </listitem>
        </varlistentry>
        <varlistentry>
         <term><parameter>i5_query_optimize</parameter></term>
         <listitem>
          <para>
            <literal>DB2_FIRST_IO</literal> Toutes les requêtes sont
            optimisées avec le but de retourner la première page aussi vite
            que possible. Ce but fonctionne bien lorsque l'affichage est
            contrôlé par un utilisateur qui peut annuler une requête après
            avoir vu la première page des données. Les requêtes sont codées
            avec une clause OPTIMIZE nnn ROWS afin de réussir le but spécifié
            par la clause.
          </para>
          <para>
           <literal>DB2_ALL_IO</literal> Toutes les requêtes sont optimisées
           avec le but de retourner l'entière requête dans le plus petit
           intervalle de temps. Ceci est une bonne option lorsque l'affichage
           d'une requête est en train d'être écrit vers un fichier ou un
           rapport ou encore lorsque l'interface met en queue les données. Les
           requêtes sont codées avec une clause OPTIMIZE FOR nnn ROWS afin de
           réussir le but spécifié par la clause. Ceci est l'opération par
           défaut.
          </para>
         </listitem>
        </varlistentry>
        <varlistentry>
         <term><parameter>i5_dbcs_alloc</parameter></term>
         <listitem>
          <para>
           La valeur <literal>DB2_I5_DBCS_ALLOC_ON</literal> active le canevas
           d'allocation DB2 6X pour l'accroissement des tailles des colonnes.
          </para>
          <para>
           La valeur <literal>DB2_I5_DBCS_ALLOC_OFF</literal> désactive le
           canevas d'allocation DB2 6X pour l'accroissement des tailles des
           colonnes.
          </para>
          <para>
           Note : la configuration &php.ini;
           <parameter>ibm_db2.i5_dbcs_alloc</parameter>==0 ou
           <literal>DB2_I5_DBCS_ALLOC_OFF</literal> est par défaut mais peut
           être dérivée avec l'option <parameter>i5_dbcs_alloc</parameter>.
          </para>
         </listitem>
        </varlistentry>
        <varlistentry>
         <term><parameter>i5_date_fmt</parameter></term>
         <listitem>
          <para>
           <literal>SQL_FMT_ISO</literal> - Le format de date de l'organisation internationale de
           normalisation (ISO) yyyy-mm-dd est utilisé. Ceci est la valeur par
           défaut.
          </para>
          <para>
           <literal>DB2_I5_FMT_USA</literal> - Le format de date des
           États-Unis mm/dd/yyyy est utilisé.
          </para>
          <para>
           <literal>DB2_I5_FMT_EUR</literal> - Le format de date Européen
           dd.mm.yyyy est utilisé.
          </para>
          <para>
           <literal>DB2_I5_FMT_JIS</literal> - Le format de date de
           l'industrie japonaise des standards yyyy-mm-dd est utilisé.
          </para>
          <para>
           <literal>DB2_I5_FMT_MDY</literal> - Le format de date mm/dd/yyyy
           est utilisé.
          </para>
          <para>
           <literal>DB2_I5_FMT_DMY</literal> - Le format de date dd/mm/yyyy
           est utilisé.
          </para>
          <para>
           <literal>DB2_I5_FMT_YMD</literal> - Le format de date yy/mm/dd est
           utilisé.
          </para>
          <para>
           <literal>DB2_I5_FMT_JUL</literal> - Le format de date Julien yy/ddd
           est utilisé.
          </para>
          <para>
           <literal>DB2_I5_FMT_JOB</literal> - Le valeur par défaut est
           utilisée.
          </para>
         </listitem>
        </varlistentry>
        <varlistentry>
         <term><parameter>i5_date_sep</parameter></term>
         <listitem>
          <para>
           <literal>DB2_I5_SEP_SLASH</literal> - Un slash ( / ) est utilisé
           en tant que séparateur de date.
           Ceci est la valeur par défaut.
          </para>
          <para>
           <literal>DB2_I5_SEP_DASH</literal> - Un tiret ( - ) est utilisé en
           tant que séparateur de date.
          </para>
          <para>
           <literal>DB2_I5_SEP_PERIOD</literal> - Un point ( . ) est utilisé
           en tant que séparateur de date.
          </para>
          <para>
           <literal>DB2_I5_SEP_COMMA</literal> - Une virgule ( , ) est
           utilisée en tant que séparateur de date.
          </para>
          <para>
           <literal>DB2_I5_SEP_BLANK</literal> - Un espace blanc est utilisé
           en tant que séparateur de date.
          </para>
          <para>
           <literal>DB2_I5_SEP_JOB</literal> - La valeur par défaut est
           utilisée.
          </para>
         </listitem>
        </varlistentry>
        <varlistentry>
         <term><parameter>i5_time_fmt</parameter></term>
         <listitem>
          <para>
           <literal>DB2_I5_FMT_ISO</literal> - Le format de l'heure de
           l'organisation internationale de normalisation hh.mm.ss est
           utilisé. Ceci est la valeur par défaut.
          </para>
          <para>
           <literal>DB2_I5_FMT_USA</literal> - Le format de l'heure des
           États-Unis hh:mmxx est utilisé, où xx est AM ou PM.
          </para>
          <para>
           <literal>DB2_I5_FMT_EUR</literal> - Le format de l'heure Européen
           hh.mm.ss est utilisé.
          </para>
          <para>
           <literal>DB2_I5_FMT_JIS</literal> - Le format de l'heure de
           l'industrie japonaise des standards hh:mm:ss est utilisé.
          </para>
          <para>
           <literal>DB2_I5_FMT_HMS</literal> - Le format hh:mm:ss est utilisé.
          </para>
         </listitem>
        </varlistentry>
        <varlistentry>
         <term><parameter>i5_time_sep</parameter></term>
         <listitem>
          <para>
           <literal>DB2_I5_SEP_COLON</literal> - Un deux-points ( : ) est
           utilisé en tant que séparateur de temps. Ceci est la valeur par
           défaut.
          </para>
          <para>
           <literal>DB2_I5_SEP_PERIOD</literal> - Un point ( . ) est utilisé
           en tant que séparateur de temps.
          </para>
          <para>
           <literal>DB2_I5_SEP_COMMA</literal> - Une virgule ( , ) est
           utilisée en tant que séparateur de temps.
          </para>
          <para>
           <literal>DB2_I5_SEP_BLANK</literal> - Un espace blanc est utilisé
           en tant que séparateur de temps.
          </para>
          <para>
           <literal>DB2_I5_SEP_JOB</literal> - La valeur par défaut est
           utilisée.
          </para>
         </listitem>
        </varlistentry>
        <varlistentry>
         <term><parameter>i5_decimal_sep</parameter></term>
         <listitem>
          <para>
           <literal>DB2_I5_SEP_PERIOD</literal> - Un point ( . ) est utilisé
           en tant que séparateur de décimale. Ceci est la valeur par défaut.
          </para>
          <para>
           <literal>DB2_I5_SEP_COMMA</literal> - Une virgule ( , ) est
           utilisée en tant que séparateur de décimale.
          </para>
          <para>
           <literal>DB2_I5_SEP_JOB</literal> - La valeur par défaut est
           utilisée.
          </para>
         </listitem>
        </varlistentry>
       </variablelist>
      </para>
     </listitem>
    </varlistentry>
   </variablelist>
  </para>
 </refsect1>
 <refsect1 role="returnvalues">
  &reftitle.returnvalues;
  <para>
   Retourne la ressource de connexion si la tentative de connexion réussie. Si
   la tentative de connexion échoue, <function>db2_connect</function> retourne
   &false;.
  </para>
 </refsect1>

 <refsect1 role="examples">
  &reftitle.examples;
  <para>
   <example>
    <title>Création d'une connexion cataloguée</title>
    <para>
     Les connexions cataloguées nécessitent que vous ayez préalablement
     catalogué la base de données spécifiée à l'aide du processeur de ligne de
     commandes DB2 ("Command Line Processor" : CLP) ou avec l'assistant de
     configuration de DB2.
    </para>
    <programlisting role="php">
<![CDATA[
<?php
$database = 'EXEMPLE';
$user = 'db2inst1';
$password = 'ibmdb2';

$conn = db2_connect($database, $user, $password);

if ($conn) {
    echo "Connexion réussie.";
    db2_close($conn);
}
else {
    echo "Connexion échouée.";
}
?>
]]>
    </programlisting>
    &example.outputs;
    <screen>
<![CDATA[
Connexion réussie.
]]>
    </screen>
   </example>
   <example>
    <title>Création d'une connexion non cataloguée</title>
    <para>
     Une connexion non cataloguées vous permet de vous connecter dynamiquement
     à une base de données.
    </para>
    <programlisting role="php">
<![CDATA[
<?php
$database = 'EXEMPLE';
$user = 'db2inst1';
$password = 'ibmdb2';
$hostname = 'localhost';
$port = 50000;

$conn_string = "DRIVER={IBM DB2 ODBC DRIVER};DATABASE=$database;" .
  "HOSTNAME=$hostname;PORT=$port;PROTOCOL=TCPIP;UID=$user;PWD=$password;";
$conn = db2_connect($conn_string, '', '');

if ($conn) {
    echo "Connexion réussie.";
    db2_close($conn);
}
else {
    echo "Connexion échouée.";
}
?>
]]>
    </programlisting>
    &example.outputs;
    <screen>
<![CDATA[
Connexion réussie.
]]>
    </screen>
   </example>
   <example>
    <title>Création d'une connexion avec autocommit désactivé par défaut</title>
    <para>
     Le fait de passer un tableau d'option à <function>db2_connect</function>
     vous permet de modifier le comportement par défaut de la connexion.
    </para>
    <programlisting role="php">
<![CDATA[
<?php
$database = 'EXEMPLE';
$user = 'db2inst1';
$password = 'ibmdb2';
$options = array('autocommit' => DB2_AUTOCOMMIT_OFF);

$conn = db2_connect($database, $user, $password, $options);

if ($conn) {
    echo "Connexion réussie.\n";
    if (db2_autocommit($conn)) {
         echo "Autocommit est activé.\n";
    }
    else {
         echo "Autocommit est désactivé.\n";
    }
    db2_close($conn);
}
else {
    echo "Connexion échouée.";
}
?>
]]>
    </programlisting>
    &example.outputs;
    <screen>
<![CDATA[
Connexion réussie.
Autocommit est désactivé.
]]>
    </screen>
   </example>

   <example>
    <title>Meilleure performance i5/OS</title>
    <para>
     Pour réussir à utiliser les meilleures performance de votre i5/OS ibm_db2
     1.5.1, l'application &php; utilise l'hôte par défaut, le userid et le mot
     de passer pour votre <function>db2_connect</function>.
    </para>
    <programlisting role="php">
<![CDATA[
<?php
  $library = "ADC";
  $i5 = db2_connect("", "", "", array("i5_lib"=>"qsys2"));
  $result = db2_exec($i5, 
       "select * from systables where table_schema = '$library'");
  while ($row = db2_fetch_both($result)) {               
     echo $row['TABLE_NAME']."</br>";                     
  }                                                      
  db2_close($i5);
?>
]]>
    </programlisting>
    &example.outputs;
    <screen>
<![CDATA[
ANIMALS
NAMES
PICTURES
]]>
    </screen>
   </example>
  </para>
 </refsect1>

 <refsect1 role="seealso">
  &reftitle.seealso;
  <para>
   <simplelist>
    <member><function>db2_close</function></member>
    <member><function>db2_pconnect</function></member>
   </simplelist>
  </para>
 </refsect1>


</refentry>

<!-- Keep this comment at the end of the file
Local variables:
mode: sgml
sgml-omittag:t
sgml-shorttag:t
sgml-minimize-attributes:nil
sgml-always-quote-attributes:t
sgml-indent-step:1
sgml-indent-data:t
indent-tabs-mode:nil
sgml-parent-document:nil
sgml-default-dtd-file:"../../../../manual.ced"
sgml-exposed-tags:nil
sgml-local-catalogs:nil
sgml-local-ecat-files:nil
End:
vim600: syn=xml fen fdm=syntax fdl=2 si
vim: et tw=78 syn=sgml
vi: ts=1 sw=1
-->
