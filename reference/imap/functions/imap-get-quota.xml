<?xml version="1.0" encoding="iso-8859-1"?>
<!-- $Revision: 1.13 $ -->
<!-- EN-Revision: 1.13 Maintainer: didou Status: ready -->
<!-- Reviewed: yes -->
 <refentry id="function.imap-get-quota">
  <refnamediv>
   <refname>imap_get_quota</refname>
   <refpurpose>
    Lit les quotas des boîtes aux lettres
   </refpurpose>
  </refnamediv>
  <refsect1>
   <title>Description</title>
    <methodsynopsis>
     <type>array</type><methodname>imap_get_quota</methodname>
     <methodparam><type>resource</type><parameter>imap_stream</parameter></methodparam>
     <methodparam><type>string</type><parameter>quota_root</parameter></methodparam>
    </methodsynopsis>
   <para>
    <function>imap_get_quota</function> retourne un tableau contenant
    les valeurs de quota et courante de la boîte aux lettres
    <parameter>quota_root</parameter>. Le quota représente la
    taille maximale de votre boîte aux lettres. La valeur courante
    est l'espace actuellement utilisé par votre boîte aux lettres.
    <function>imap_get_quota</function> retournera &false;
    en cas d'échec.
   </para>
   <para>
    <function>imap_get_quota</function> ne fonctionne actuellement qu'avec
    les bibliothèques c-client2000.
   </para>
   <para>
     NOTE : Pour que cette fonction fonctionne, la ressource de mail doit avoir été
     ouverte par un utilisateur administrateur du système de mail. Pour un utilisateur 
     non administrateur du système de mail, référez-vous à la fonction &php;
     <function>imap_get_quotaroot</function>.
    </para>
   <para>
    <parameter>imap_stream</parameter> doit avoir été créé
    avec la fonction <function>imap_open</function>. Ce flux est
    nécessairement ouvert en tant qu'administrateur du serveur, pour que
    les droits nécessaires lui soient alloués.
    <parameter>quota_root</parameter> doit être de la forme :
    "<literal>user.nom</literal>", où "nom" est le nom de la
    boîte aux lettres que vous souhaitez analyser.
   </para>
   <para>
    <example>
     <title>Exemple avec <function>imap_get_quota</function></title>
     <programlisting role="php">
<![CDATA[
<?php
$mbox = imap_open("{votre.hote.imap}","mailadmin","mot de passe",OP_HALFOPEN)
     or die("Connexion impossible : ".imap_last_error());
$quota_value = imap_get_quota($mbox, "user.toto");
if(is_array($quota_value)) {
   echo "Utilisation actuelle : " . $quota_value['usage'];
   echo "Quota : " . $quota_value['limit'];
}
imap_close($mbox);
?>
]]>
     </programlisting>
    </example>
   </para>
    <para>
     Depuis &php; 4.3, la fonction reflète plus fidèlement les fonctionnalités
     édictée par la RFC 2087. Le tableau retourné a changé pour supporter
     un nombre illimité de ressources retournées (i.e.
     messages ou sous-dossiers) avec chaque ressource nommée qui est identifiée
     par une clé. Chaque clé contient alors un autre tableau avec l'utilisation
     et le quota. L'exemple ci-dessous montre comment l'utiliser.
    </para>
    <para>
     Pour des raisons de compatibilité, la méthode d'accès originale est
     toujours disponible, mais il est recommandé de l'abandonner.
    </para>
    <para>
     <example>
      <title>Exemple avec <function>imap_get_quota</function> pour &php; 4.3</title>
      <programlisting role="php"> 
<![CDATA[
<?php
$mbox = imap_open("{your.imap.host}","mailadmin","password",OP_HALFOPEN)
      or die("Impossible de se connecter : ".imap_last_error());
       
$quota_values = imap_get_quota($mbox, "user.kalowsky");
if(is_array($quota_values)) {
   $storage = $quota_values['STORAGE'];
   echo "Utilisation actuelle de la capacité de stockage : " .  $storage['usage'];
   echo "Quota actuel de stockage : " .  $storage['limit'];

   $message = $quota_values['MESSAGE']; 
   echo "Niveau d'utilisation de MESSAGE : " .  $message['usage'];
   echo "Quota de MESSAGE : " .  $message['limit'];

   /* ...  */ 
} 

imap_close($mbox); 
?>
]]>
      </programlisting>
     </example>
    </para>
    <para>
     Voir aussi
     <function>imap_open</function>, 
     <function>imap_set_quota</function> et
     <function>imap_get_quotaroot</function>.
    </para>
  </refsect1>
 </refentry>

<!-- Keep this comment at the end of the file
Local variables:
mode: sgml
sgml-omittag:t
sgml-shorttag:t
sgml-minimize-attributes:nil
sgml-always-quote-attributes:t
sgml-indent-step:1
sgml-indent-data:t
indent-tabs-mode:nil
sgml-parent-document:nil
sgml-default-dtd-file:"../../../../manual.ced"
sgml-exposed-tags:nil
sgml-local-catalogs:nil
sgml-local-ecat-files:nil
End:
vim600: syn=xml fen fdm=syntax fdl=2 si
vim: et tw=78 syn=sgml
vi: ts=1 sw=1
-->
