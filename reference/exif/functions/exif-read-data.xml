<?xml version="1.0" encoding="iso-8859-1"?>
<!-- $Revision: 1.1 $ -->
<!-- EN-Revision: 1.1 Maintainer: dams Status: ready -->
  <refentry id="function.exif-read-data">
   <refnamediv>
    <refname>exif_read_data</refname>
    <refpurpose>Lit les en-têtes EXIF des images JPEG et TIFF</refpurpose>
   </refnamediv>
   <refsect1>
    &reftitle.description;
    <methodsynopsis>
     <type>array</type><methodname>exif_read_data</methodname>
     <methodparam><type>string</type><parameter>filename</parameter></methodparam>
     <methodparam choice="opt"><type>string</type><parameter>sections</parameter></methodparam>
     <methodparam choice="opt"><type>bool</type><parameter>arrays</parameter></methodparam>
     <methodparam choice="opt"><type>bool</type><parameter>thumbnail</parameter></methodparam>
    </methodsynopsis>
    <para>
     <function>exif_read_data</function> lit les en-têtes EXIF des images JPEG et TIFF.
     Elle retourne un tableau associatif avec comme index les noms des
     en-têtes, et en valeur, les valeurs des en-têtes. Si aucune donnée n'a pu
     être lue, elle retourne &false;.
    </para>
    <para>
     <parameter>filename</parameter> est le nom du fichier à lire. Il ne peut pas
     être une URL.
    </para>
    <para>
     <parameter>sections</parameter> est une liste de valeur séparées par des virgules
     des sections qui devront être présentées dans le tableau de résultat.
     <informaltable>
     <tgroup cols="2">
      <tbody>
       <row>
        <entry><literal>FILE</literal></entry>
        <entry>
         <literal>FileName</literal> (nom du ficher), 
         <literal>FileSize</literal> (taille du fichier), 
         <literal>FileDateTime</literal> (date de modification du fichier), 
         <literal>SectionsFound</literal> (sections trouvées)</entry>
       </row>
       <row>
        <entry><literal>COMPUTED</literal></entry>
        <entry>
         <literal>html</literal> (attributs HTML), 
         <literal>Width</literal> (largeur), 
         <literal>Height</literal> (Hauteur), 
         <literal>IsColor</literal> (couleur ou noir et blanc)
         et quelques autres s'ils sont disponibles.
        </entry>
       </row>
       <row>
        <entry><literal>ANY_TAG</literal></entry>
        <entry>Toutes les informations concernant cette balise, comme
        <literal>IFD0</literal>, EXIF, ...</entry>
       </row>
       <row>
        <entry><literal>IFD0</literal></entry>
        <entry>Toutes les balises <literal>IFD0</literal>. Dans les images normales, ils contiennent les
        dimensions de l'image, etc.</entry>
       </row>
       <row>
        <entry><literal>THUMBNAIL</literal></entry>
        <entry>Un fichier qui contient une miniature, s'il y a un second <literal>IFD</literal>.
        Toutes les informations mises en balises à propos de cette miniature
        seront stockées dans cette section.</entry>
       </row>
       <row>
        <entry><literal>COMMENT</literal></entry>
        <entry>En-tête de commentaire des images JPEG.</entry>
       </row>
       <row>
        <entry><literal>EXIF</literal></entry>
        <entry>La section EXIF est une sous section de la section <literal>IFD0</literal>. Elle
        contient des informations plus détaillées sur les images. La plupart
        de ces index sont reliés aux appareils numériques.</entry>
       </row>
      </tbody>
     </tgroup>
     </informaltable>
    </para>
    <para>
     <parameter>arrays</parameter> spécifie si chaque section doit être
     un tableau ou non. Les sections <literal>FILE</literal>,
     <literal>COMPUTED</literal> et <literal>THUMBNAIL</literal> seront
     toujours transformées en tableau, car elle contiennent des noms qui
     risquent d'être en conflit.
    </para>
    <para>
     <parameter>thumbnail</parameter> indique s'il faut lire la miniature
     elle-même, et pas seulement les données en balises.
    </para>
    <note>
     <para>
      Les en-têtes EXIF sont souvent présents dans les en-têtes d'images JPEG/TIFF,
      générés par les appareils numériques, mais, malheureusement, chaque
      fabriquant d'appareils a une idée différente pour
      étiqueter leurs images, et vous ne pourrez pas compter sur des
      en-têtes communs.
     </para>
     <para>
      Windows ME/XP peuvent endommager les en-têtes EXIF lors de la connexion à la
      caméra. Plus d'informations disponibles sur <ulink
      url="&url.winexif;">&url.winexif;</ulink>.
     </para>
    </note>
    <note>
     <para>
      Si l'image contient des données <literal>IFD0</literal>, alors la section <literal>COMPUTED</literal> contient
      l'entrée <literal>ByteOrderMotorola</literal> qui vaut 0 pour 
      <literal>little-endian</literal> (Intel) et 1 pour
      <literal>big-endian</literal> (Motorola). Ceci a été ajouté en &php; 4.3.
     </para>
     <para>
      Lorsqu'un en-tête EXIF contient une note de Copyright, cet en-tête 
      peut alors contenir lui même deux valeurs. Comme cette solution est
      incohérente avec les standards EXIF 2.10, la section <literal>COMPUTED</literal> retournera
      les deux en-têtes, <literal>Copyright.Photographer</literal>
      et <literal>Copyright.Editor</literal>, tandis que les sections <literal>IFD0</literal> contiennent
      le tableau d'octets avec des caractères NULL pour séparer les deux entrées ;
      ou bien, juste la première entrée si le type de données était erroné
      (comportement par défaut de EXIF). La section <literal>COMPUTED</literal> va aussi contenir une
      entrée <literal>Copyright</literal>, qui sera soit la chaîne originale
      de copyright, soit une liste de valeurs séparées par des virgules de
      photos et de copyright de l'auteur.
     </para>
    </note>
    <note>
     <para>
      La balise <literal>UserComment</literal> présente le même problème que la balise Copyright. Elle
      peut stocker deux valeurs : en premier, le jeu de caractères utilisé, puis
      la valeur elle-même. Si c'est le cas, la section <literal>IFD</literal> contiendra uniquement
      le jeu de caractères, ou bien un tableau d'octets. La section <literal>COMPUTED</literal> 
      va stocker les deux entrées <literal>UserCommentEncoding</literal> et 
      <literal>UserComment</literal>. L'index <literal>UserComment</literal> 
      est disponible dans les deux cas, et il est préférable de l'utiliser, plutôt 
      que la valeur de la section <literal>IFD0</literal>.
     </para>
     <para>
      Si les commentaires utilisent l'Unicode ou bien le JIS et que le module
      mbstring est accessible, ces jeux de caractères seront automatiquement changés
      en fonction de la configuration de EXIF dans le fichier &php.ini;. Cette
      possibilité a été ajoutée en &php; 4.3.0.
     </para>
    </note>
    <note>
     <para>
       La hauteur (<literal>Height</literal>) et la largeur (<literal>Width</literal>) sont calculées de la même façon que
       la fonction <function>getimagesize</function> le fait, et leurs valeurs ne
       devraient jamais différer. De même, l'index html est la représentation textuelle
       utilisée dans une balise image HTML classique.
     </para>
    </note>
    <note>
     <para>
       Depuis &php; 4.3, cette fonction peut aussi lire les sections <acronym>IFD</acronym>
       inclues dans les tableaux, et retournées sous cette forme. De plus, la taille
       d'une miniature intégrée est retournée dans le sous tableau 
       <literal>THUMBNAIL</literal> et la fonction <function>exif_read_data</function> 
       peut retourner les miniatures au format <acronym>TIFF</acronym>. Enfin, il n'y a
       plus de longueur maximale pour les valeurs renvoyées (hormis la place en mémoire).
     </para>
    </note>
    <simpara>
     Depuis &php; 4.3.0, les commentaires utilisateurs peuvent être automatiquement
     changés de jeu de caractères si &php; a été compilé avec 
     <option role="configure">--enable-mbstring</option>.
    </simpara>
   </refsect1>
   <refsect1>
    &reftitle.returnvalues;
    <para>
     Cette fonction retourne un tableau associatif <type>array</type> dont
     les index sont les noms des entêtes, et leur valeur est la valeur associée
     dans l'image. Si aucune données ne peut être retournée, 
     <function>exif_read_data</function> retournera &false;.
    </para>
   </refsect1>
   <refsect1>
    &reftitle.examples;
    <para>
     <example>
      <title>Exemple avec <function>exif_read_data</function></title>
      <programlisting role="php">
<![CDATA[
<?php
echo "test1.jpg:<br />\n";
$exif = exif_read_data('tests/test1.jpg', 'IFD0');
echo $exif===false ? "No header data found.<br />\n" : "Image contains headers<br />";

$exif = exif_read_data('tests/test2.jpg', 0, true);
echo "test2.jpg:<br />\n";
foreach ($exif as $key => $section) {
    foreach ($section as $name => $val) {
        echo "$key.$name: $val<br />\n";
    }
}
?>
]]>
      </programlisting>
      <para>
      Le premier appel échoue car l'image ne contient pas d'informations.
       <screen role="php">
<![CDATA[
test1.jpg:
No header data found.
test2.jpg:
FILE.FileName: test2.jpg
FILE.FileDateTime: 1017666176
FILE.FileSize: 1240
FILE.FileType: 2
FILE.SectionsFound: ANY_TAG, IFD0, THUMBNAIL, COMMENT
COMPUTED.html: width="1" height="1"
COMPUTED.Height: 1
COMPUTED.Width: 1
COMPUTED.IsColor: 1
COMPUTED.ByteOrderMotorola: 1
COMPUTED.UserComment: Exif test image.
COMPUTED.UserCommentEncoding: ASCII
COMPUTED.Copyright: Photo (c) M.Boerger, Edited by M.Boerger.
COMPUTED.Copyright.Photographer: Photo (c) M.Boerger
COMPUTED.Copyright.Editor: Edited by M.Boerger.
IFD0.Copyright: Photo (c) M.Boerger
IFD0.UserComment: ASCII
THUMBNAIL.JPEGInterchangeFormat: 134
THUMBNAIL.JPEGInterchangeFormatLength: 523
COMMENT.0: Comment #1.
COMMENT.1: Comment #2.
COMMENT.2: Comment #3end
THUMBNAIL.JPEGInterchangeFormat: 134
THUMBNAIL.Thumbnail.Height: 1
THUMBNAIL.Thumbnail.Height: 1
]]>
       </screen>
      </para>
     </example>
    </para>
   </refsect1>
   <refsect1>
    &reftitle.seealso;
    <para>
     <function>exif_thumbnail</function>&listendand;
     <function>getimagesize</function>.
    </para>
   </refsect1>
  </refentry>

<!-- Keep this comment at the end of the file
Local variables:
mode: sgml
sgml-omittag:t
sgml-shorttag:t
sgml-minimize-attributes:nil
sgml-always-quote-attributes:t
sgml-indent-step:1
sgml-indent-data:t
indent-tabs-mode:nil
sgml-parent-document:nil
sgml-default-dtd-file:"../../../../manual.ced"
sgml-exposed-tags:nil
sgml-local-catalogs:nil
sgml-local-ecat-files:nil
End:
vim600: syn=xml fen fdm=syntax fdl=2 si
vim: et tw=78 syn=sgml
vi: ts=1 sw=1
-->
