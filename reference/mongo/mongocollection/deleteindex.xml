<?xml version="1.0" encoding="utf-8"?>
<!-- $Revision$ -->
<!-- EN-Revision: 331062 Maintainer: yannick Status: ready -->
<!-- Reviewed: no -->

<refentry xml:id="mongocollection.deleteindex" xmlns="http://docbook.org/ns/docbook" xmlns:xlink="http://www.w3.org/1999/xlink">
 <refnamediv>
  <refname>MongoCollection::deleteIndex</refname>
  <refpurpose>Supprime un index de la collection</refpurpose>
 </refnamediv>

 <refsect1 role="description">
  &reftitle.description;
  <methodsynopsis>
   <modifier>public</modifier> <type>array</type><methodname>MongoCollection::deleteIndex</methodname>
   <methodparam><type>string|array</type><parameter>keys</parameter></methodparam>
  </methodsynopsis>
  <para>
   Cette méthode est identique à:
  </para>
  <programlisting role="php">
<![CDATA[
<?php

public function deleteIndexes($keys) {
  // toIndexString est une méthode protégée qui transforme les chaines, tableaux
  // et objets en noms d'index
  $index = $this->toIndexString($keys);

  return $this->db->command(array("deleteIndexes" => $this->getName(), 
    "index" => $index));
}

?>
]]>
  </programlisting>
  <para>
   Chaque index possède un nom unique à sa création. C'est l'utilisateur qui le précise en
   général (avec l'option "name" de <function>MongoCollection::ensureIndex</function>) ou
   alors il est généré par le pilote depuis une combinaisons de clés. Ce nom est alors utilisé
   par <function>MongoCollection::deleteIndex</function>.
  </para>
  <para>
   Malheureusement, la méthode <function>MongoCollection::ensureIndex</function> 
   génère des noms très différents de la commande shell à cause de problèmes de compatibilité
   ascendante, et <function>MongoCollection::deleteIndex</function> ne peut supprimer les index
   dont les noms sont personnalisés. De ce fait, la meilleure manière de supprimer des index
   créés via le shell ou avec des noms personnalisés est d'appeler directement la commande
   <literal>deleteIndexes</literal> de la base de données.
  </para>
  <para>
   Ainsi, si vous avez appelé un index "superfast query", vous ne pouvez le supprimer qu'avec
   le driver PHP en exécutant :
  </para>
  <programlisting role="php">
<![CDATA[
<?php

$db->command(array("deleteIndexes" => $collection->getName(), "index" => "superfast query"));

?>
]]>
  </programlisting>
  <para>
   Pour trouver le nom d'un index, vous pouvez requêter la collection
   <literal>system.indexes</literal> d'une base de données et chercher le champ
   <literal>name</literal>.
  </para>
 </refsect1>

 <refsect1 role="parameters">
  &reftitle.parameters;
  <para>
   <variablelist>
    <varlistentry>
     <term>
      <parameter>keys</parameter>
     </term>
     <listitem>
      <para>
       Le ou les champs dont il faut supprimer l'index.
      </para>
     </listitem>
    </varlistentry>   
   </variablelist>
  </para>
 </refsect1>

 <refsect1 role="returnvalues">
  &reftitle.returnvalues;
  <para>
   Retourne la réponse de la base de données.
  </para>
 </refsect1>

 <refsect1 role="examples">
  &reftitle.examples;
  <example>
   <title>Exemple avec <function>MongoCollection::deleteIndex</function></title>
   <para>
    This example passes the function string and array parameters.
   </para>
   <programlisting role="php">
<![CDATA[
<?php
$m = new MongoClient();
$c = $m->example->indices;

// crée un index
$c->ensureIndex(array("i"=>1));

// supprime l'index
$c->deleteIndex("i");


// créé un index à colonnes multiples
$c->ensureIndex(array("j" => 1, "k" => 1));

// supprime cet index
$c->deleteIndex(array("j" => 1, "k" => 1));
?>
]]>
   </programlisting>
  </example>
 </refsect1>
</refentry>
<!-- Keep this comment at the end of the file
Local variables:
mode: sgml
sgml-omittag:t
sgml-shorttag:t
sgml-minimize-attributes:nil
sgml-always-quote-attributes:t
sgml-indent-step:1
sgml-indent-data:t
sgml-parent-document:nil
sgml-default-dtd-file:"~/.phpdoc/manual.ced"
sgml-exposed-tags:nil
sgml-local-catalogs:nil
sgml-local-ecat-files:nil
End:
vim600: syn=xml fen fdm=syntax fdl=2 si
vim: et tw=78 syn=sgml
vi: ts=1 sw=1
--> 
