<?xml version="1.0" encoding="utf-8"?>
<!-- $Revision$ -->
<!-- EN-Revision: 304187 Maintainer: gui Status: ready -->
<!-- Reviewed: no -->
<chapter xml:id="mysqlnd.config" xmlns="http://docbook.org/ns/docbook" xmlns:xlink="http://www.w3.org/1999/xlink">

  &reftitle.runtime;
  &extension.runtime;

  <para>
   <table>
   <title>Options de configuration de MySQL Native Driver</title>
   <tgroup cols="4">
    <thead>
     <row>
      <entry>Nom</entry>
      <entry>Défaut</entry>
      <entry>Changeable</entry>
      <entry>Changelog</entry>
     </row>
    </thead>
    <tbody>
     <row>
      <entry><link linkend="mysqlnd.collect_statistics">mysqlnd.collect_statistics</link></entry>
      <entry>"1"</entry>
      <entry>PHP_INI_SYSTEM</entry>
      <entry>Disponible depuis PHP 5.3.0.</entry>
     </row>
     <row>
      <entry><link linkend="mysqlnd.collect_memory_statistics">mysqlnd.collect_memory_statistics</link></entry>
      <entry>"0"</entry>
      <entry>PHP_INI_SYSTEM</entry>
      <entry>Disponible depuis PHP 5.3.0.</entry>
     </row>
     <row>
      <entry><link linkend="mysqlnd.debug">mysqlnd.debug</link></entry>
      <entry>"0"</entry>
      <entry>PHP_INI_SYSTEM</entry>
      <entry>Disponible depuis PHP 5.3.0.</entry>
     </row>
     <row>
      <entry><link linkend="mysqlnd.net_read_timeout">mysqlnd.net_read_timeout</link></entry>
      <entry>"31536000"</entry>
      <entry>PHP_INI_SYSTEM</entry>
      <entry>Disponible depuis PHP 5.3.0.</entry>
     </row>
     <row>
      <entry><link linkend="mysqlnd.net_cmd_buffer_size">mysqlnd.net_cmd_buffer_size</link></entry>
      <entry>5.3.0 - "2048", 5.3.1 - "4096"</entry>
      <entry>PHP_INI_SYSTEM</entry>
      <entry>Disponible depuis PHP 5.3.0.</entry>
     </row>
     <row>
      <entry><link linkend="mysqlnd.net_read_buffer_size">mysqlnd.net_read_buffer_size</link></entry>
      <entry>"32768"</entry>
      <entry>PHP_INI_SYSTEM</entry>
      <entry>Disponible depuis PHP 5.3.0.</entry>
     </row>
    </tbody>
   </tgroup>
  </table>
   &ini.php.constants;
  </para>

  &ini.descriptions.title;

  <para>
   <variablelist>
   <varlistentry xml:id="mysqlnd.collect_statistics">
    <term>
     <parameter>mysqlnd.collect_statistics</parameter>
     <type>boolean</type>
    </term>
    <listitem>
     <para>
      Active la collecte de différentes statistiques du client auxquelles vous
      pouvez accéder via <function>mysqli_get_client_stats</function>,
      <function>mysqli_get_connection_stats</function>,
      <function>mysqli_get_cache_stats</function> et qui sont aussi décrites
      dans la section <literal>mysqlnd</literal> de la sortie de la fonction
      <function>phpinfo</function>.
     </para>
     <para>
      Ce paramètre active toutes
      <link linkend="mysqlnd.stats"> les statistiques de MySQL Native Driver
      </link> sauf celles relatives à la gestion de la mémoire.
     </para>
    </listitem>
   </varlistentry>
   <varlistentry xml:id="mysqlnd.collect_memory_statistics">
    <term>
     <parameter>mysqlnd.collect_memory_statistics</parameter>
     <type>boolean</type>
    </term>
    <listitem>
     <para>
      Active la collecte de différentes statistiques concernant la mémoire
      qui peuvent être consultées via
      <function>mysqli_get_client_stats</function>,
      <function>mysqli_get_connection_stats</function>,
      <function>mysqli_get_cache_stats</function> et qui sont aussi montrées dans
      la section <literal>mysqlnd</literal> de la sortie de la fonction
      <function>phpinfo</function>.
     </para>
     <para>
      Ce paramètre active les statistiques de gestion de la mémoire parmis
      <link linkend="mysqlnd.stats">les statistiques fournies par MySQL
       Native Driver</link>.
     </para>
    </listitem>
   </varlistentry>
   <varlistentry xml:id="mysqlnd.debug">
    <term>
     <parameter>mysqlnd.debug</parameter> <type>boolean</type>
    </term>
    <listitem>
     <para>
      Journalise tout en provenance de toute extension utilisant
      <literal>mysqlnd</literal>. Seulement disponible avec une version
      debug de PHP.
     </para>
     </listitem>
   </varlistentry>
   <varlistentry xml:id="mysqlnd.net_read_timeout">
    <term>
     <parameter>mysqlnd.net_read_timeout</parameter>
     <type>integer</type>
    </term>
    <listitem>
     <para>
      <literal>mysqlnd</literal> et la MySQL Client Library,
      <literal>libmysql</literal> utilise des API réseau différentes.
      <literal>mysqlnd</literal> utilise les flux PHP, alors que
      <literal>libmysql</literal> utilise sa propre implémentation basée sur
      le système. PHP, par défaut, utilise un timeout en lecture de 60s. Ceci
      en utilisant le paramètre de <filename>php.ini</filename>,
      <literal>default_socket_timeout</literal>. Ceci s'applique à tous les flux
      qui ne précisent pas de timeout par défaut.
      <literal>mysqlnd</literal> n'affecte aucune autre valeur et donc des requêtes
      longues peuvent se voir déconnectées après
      <literal>default_socket_timeout</literal> secondes avec comme résultat
      un message d'erreur <quote>2006 - MySQL Server has gone
      away</quote>. La MySQL Client Library affecte un timeout par défaut de
      365 * 24 * 3600 secondes (1 an) et attend les autres timeout, comme ceux de
      TCP/IP. <literal>mysqlnd</literal> utilise maintenant le même timeout très long.
      La valeur est configurable via le paramètre <filename>php.ini</filename>
      <literal>mysqlnd.net_read_timeout</literal>.
      <literal>mysqlnd.net_read_timeout</literal> est donc utilisé par toute extension
      (<literal>ext/mysql</literal>, <literal>ext/mysqli</literal>,
      <literal>PDO_MySQL</literal>) qui se repose sur
      <literal>mysqlnd</literal>. <literal>mysqlnd</literal> indique aux flux PHP d'utiliser
      <literal>mysqlnd.net_read_timeout</literal>. Notez qu'il peut y avoir des différences
      subtiles entre
      <literal>MYSQL_OPT_READ_TIMEOUT</literal> de la MySQL Client Library et les flux
      PHP, par exemple <literal>MYSQL_OPT_READ_TIMEOUT</literal> est dite fonctionnelle
      uniquement avec des connexions TCP/IP et, avant MySQL 5.1.2, seulement sous Windows.
      Les flux PHP, eux, n'ont pas cette limite. Voyez la documentation des flux en cas
      de doute.
     </para>
     </listitem>
   </varlistentry>
   <varlistentry xml:id="mysqlnd.net_cmd_buffer_size">
    <term>
     <parameter>mysqlnd.net_cmd_buffer_size</parameter>
     <type>long</type>
    </term>
    <listitem>
     <para>
      <literal>mysqlnd</literal> alloue un buffer interne pour le réseau d'une taille
      de <literal>mysqlnd.net_cmd_buffer_size</literal> (dans
      <filename>php.ini</filename>) octets pour chaque connexion. Si une commande du
      protocole MySQL Client Server, par exemple,
      <literal>COM_QUERY</literal> (requête  <quote>normale</quote>), ne rentre pas dans
      le buffer, <literal>mysqlnd</literal> va agrandir celui-ci à la taille requise.
      A chaque fois que le buffer est agrandi pour une connexion,
      <literal>command_buffer_too_small</literal> va être incrémenté de un.
     </para>
     <para>
      Si<literal>mysqlnd</literal> doit agrandir le buffer au-delà de sa taille initiale de
      <literal>mysqlnd.net_cmd_buffer_size</literal> octets pour presque toutes les connexions,
      vous devriez alors augmenter cette taille par défaut afin d'éviter les ré-allocations.
     </para>
     <para>
      La taille par défaut du buffer est de 2048 octets dans PHP 5.3.0. Dans les versions
      suivantes, 4096 octets. Cette valeur par défaut peut être modifiée soit par
      le paramètre de <filename>php.ini</filename>
      <literal>mysqlnd.net_cmd_buffer_size</literal> ou en utilisant
      <literal>mysqli_options(MYSQLI_OPT_NET_CMD_BUFFER_SIZE, int
      size)</literal>.
     </para>
     <para>
      Il est recommandé d'avoir une taille de buffer au moins égale à 4096
      octets car <literal>mysqlnd</literal> l'utilise aussi lors de la lecture
      de certains paquets de communication avec MySQL. Dans PHP 5.3.0,
      <literal>mysqlnd</literal> n'augmentera pas le buffer si MySQL envoie
      un paquet plus grand que la taille du buffer. Ainsi,
      <literal>mysqlnd</literal> ne peut pas décoder le paquet et l'application
      cliente recevra une erreur. Il n'y a que deux situations dans lesquelles le
      paquet peut être plus grand que les 2048 octets par défaut de
      <literal>mysqlnd.net_cmd_buffer_size</literal> sous PHP 5.3.0: le paquet
      véhicule un message d'erreur très long, ou le paquet contient des méta
      données de colonnes provenant de <literal>COM_LIST_FIELD</literal>
      (<literal>mysql_list_fields()</literal>, méta données d'une colonne de type
      string avec une valeur par défaut très grande (>1900 octets).
     </para>
     <para>
      Depuis PHP 5.3.2, mysqlnd n'autorise plus l'affectation de buffers inférieurs
      à 4096 octets.
     </para>
     <para>
      La valeur peut aussi être changée au moyen de <literal>mysqli_option(link,
      MYSQLI_OPT_NET_CMD_BUFFER_SIZE, size)</literal>.
     </para>
    </listitem>
   </varlistentry>
    <varlistentry xml:id="mysqlnd.net_read_buffer_size">
    <term>
     <parameter>mysqlnd.net_read_buffer_size</parameter>
     <type>long</type>
    </term>
    <listitem>
     <para>
      Taille maximale du segment en lecture lors de la lecture du corps d'un
      paquet de commande MySQL. Le protocole serveur de MySQL encapsule toutes
      ses commandes dans des paquets. Les paquets consistent en un en-tête court
      suivi d'un corps contenant les infos. La taille du corps est encodée dans
      l'en-tête. <literal>mysqlnd</literal> lit le corps sous forme de segments
      de <literal>MIN(header.size, mysqlnd.net_read_buffer_size)</literal>
      octets. Si le corps d'un paquet est plus grand que
      <literal>mysqlnd.net_read_buffer_size</literal> octets,
      <literal>mysqlnd</literal> doit alors appeler <literal>read()</literal>
      plusieurs fois.
     </para>
     <para>
      La valeur peut aussi être changée au moyen de <literal>mysqli_optionS(link,
      MYSQLI_OPT_NET_READ_BUFFER_SIZE, size)</literal>.
     </para>
    </listitem>
   </varlistentry>
  </variablelist>
  </para>

</chapter>
<!-- Keep this comment at the end of the file
Local variables:
mode: sgml
sgml-omittag:t
sgml-shorttag:t
sgml-minimize-attributes:nil
sgml-always-quote-attributes:t
sgml-indent-step:1
sgml-indent-data:t
indent-tabs-mode:nil
sgml-parent-document:nil
sgml-default-dtd-file:"~/.phpdoc/manual.ced"
sgml-exposed-tags:nil
sgml-local-catalogs:nil
sgml-local-ecat-files:nil
End:
vim600: syn=xml fen fdm=syntax fdl=2 si
vim: et tw=78 syn=sgml
vi: ts=1 sw=1
-->
