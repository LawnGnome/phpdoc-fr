<?xml version="1.0" encoding="iso-8859-1"?>
<!-- $Revision: 1.4 $ -->
<!-- EN-Revision: 1.6 Maintainer: yannick Status: ready -->
  <sect1 id="install.windows.iis">
   <title>Installation avec les serveurs IIS/PWS</title>
   <para>
    Cette section contient des notes sur l'installation de &php; avec IIS (
    Microsoft Internet Information Server) :
    <link linkend="install.windows.iis.iis3">PWS/IIS 3</link>,
    <link linkend="install.windows.iis.pws4">PWS 4 ou plus récent</link> et
    <link linkend="install.windows.iis.iis4">IIS 4 ou plus récent</link>.
   </para>

   <note>
    <title>Important pour les utilisateurs de CGI</title>
    <para>
     Lisez la <link linkend="faq.installation.forceredirect">FAQ sur cgi.force_redirect</link>
     pour d'importants conseils. Cette directive doit prendre la valeur
     de &zero;.
    </para>
   </note>
   &warn.install.cgi;

   <sect2 id="install.windows.iis.iis3">
    <title>Windows et PWS/IIS 3</title>
    
    <simpara>
     La méthode recommandée pour configurer ces serveurs
     est d'utiliser le fichier INF inclus dans la distribution
     (<filename>pws-php4cgi.reg</filename> dans le dossier SAPI pour &php; 4 ou
     <filename>pws-php5cgi.reg</filename> dans le dossier principal pour &php; 5).
     Vous pouvez éditer ce fichier, pour vous assurer que les
     extensions et les dossiers d'installation de &php; sont bien
     ceux de votre configuration. Ou alors, vous pouvez suivre les
     instructions suivantes pour le faire manuellement.
    </simpara>
    <warning>
     <para>
      Ces instructions requièrent la manipulation du fichier de
      registre de Windows. Une erreur peut laisser votre système dans un
      état instable. Nous vous recommandons vivement de sauvegarder ce
      fichier en lieu sûr. L'équipe de développement et les
      traducteurs de cette documentation ne pourront pas être tenus responsable
      d'un quelconque dommage qui pourrait survenir dans votre registre.
     </para>
    </warning>

    <para>
     <itemizedlist>
      <listitem>
       <simpara>
        Lancez Regedit.
       </simpara>
      </listitem>
      <listitem>
       <simpara>
        Naviguez jusqu'à : <literal>HKEY_LOCAL_MACHINE /System
        /CurrentControlSet /Services /W3Svc /Parameters
        /ScriptMap</literal>.
       </simpara>
      </listitem>
      <listitem>
       <simpara>
        Dans le menu "edit", sélectionnez : <literal>New->String Value</literal>.
       </simpara>
      </listitem>
      <listitem>
       <simpara>
        Entrez l'extension que vous voulez utiliser pour les scripts &php;.
        Par exemple : <literal>.php</literal>
       </simpara>
      </listitem>
      <listitem>
       <simpara>
        Double-cliquez sur la chaîne, et entrez le chemin jusqu'à
        <literal>php.exe</literal> dans le champ "value data". Exemple :
        <literal>C:\php\php.exe</literal> pour &php; 4 ou
        <literal>C:\php\php-cgi.exe</literal> pour &php; 5.
       </simpara>
      </listitem>
      <listitem>
       <simpara>
        Répétez ces étapes pour chaque extension que vous désirez associer à vos scripts
        &php;.
       </simpara>
      </listitem>
     </itemizedlist>
    </para>
    <para>
     Les étapes suivantes n'affectent pas la configuration du serveur
     web, et ne s'appliquent que si vous voulez que vos scripts &php;
     soient exécutés lorsqu'il sont exécutés en ligne de commande
     (par exemple, run <filename>C:\messcripts\test.php</filename>)
     ou en double-cliquant sur l'icone. Vous pouvez ignorer
     ces étapes si vous préférez que vos scripts &php; s'ouvrent dans un
     éditeur de texte, plutôt que de les voir s'exécuter lorsque vous
     double-cliquez dessus.
    </para>
    <para>
     <itemizedlist>
      <listitem>
       <simpara>
        Naviguez jusqu'à : <literal>HKEY_CLASSES_ROOT</literal>
       </simpara>
      </listitem>
      <listitem>
       <simpara>
        Dans le menu edit, sélectionnez : <literal>New->Key</literal>.
       </simpara>
      </listitem>
      <listitem>
       <simpara>
        Donnez le nom de votre extension à la clé.
        Par exemple : <literal>.php</literal>
       </simpara>
      </listitem>
      <listitem>
       <simpara>
        Sélectionnez le nom de la nouvelle clé dans le panneau de
        droite, et double-cliquez dans "default value", puis entrez
        <literal>phpfile</literal>.
       </simpara>
      </listitem>
      <listitem>
       <simpara>
        Répétez ces instructions pour toutes les extensions que vous avez
        associé aux scripts &php;.
       </simpara>
      </listitem>
      <listitem>
       <simpara>
        Créez une autre <literal>New->Key</literal> sous
        <literal>HKEY_CLASSES_ROOT</literal> et nommez-la
        <literal>phpfile</literal>.
       </simpara>
      </listitem>
      <listitem>
       <simpara>
        Sélectionnez la nouvelle clé <literal>phpfile</literal>  et dans
        le panneau de droite, double-cliquez dans "default value" et
        entrez <literal>PHP Script</literal>.
       </simpara>
      </listitem>
      <listitem>
       <simpara>
        Faites un clic droit dans <literal>phpfile</literal> et sélectionnez
        <literal>New->Key</literal>, appelez-le <literal>Shell</literal>.
       </simpara>
      </listitem>
      <listitem>
       <simpara>
        Faites un clic droit dans <literal>Shell</literal> et sélectionnez
        <literal>New->Key</literal>, appelez-le <literal>open</literal>.
       </simpara>
      </listitem>
      <listitem>
       <simpara>
        Faites un clic droit dans <literal>open</literal> et sélectionnez
        <literal>New->Key</literal>, appelez-le
        <literal>command</literal>.
       </simpara>
      </listitem>
      <listitem>
       <simpara>
        Sélectionnez la nouvelle clé <literal>command</literal> et dans le
        panneau de droite, faites un double-clic dans "default value", puis entrez
        le chemin jusqu'à <literal>php.exe</literal>. Par exemple : 
        <literal>c:\php\php.exe -q %1</literal> (n'oubliez pas le
        <literal>%1</literal>).
       </simpara>
      </listitem>
      <listitem>
       <simpara>
        Quittez Regedit.
       </simpara>
      </listitem>
      <listitem>
       <simpara>
        Si vous utilisez PWS sous Windows, redémarrez pour prendre en
        compte le nouveau registre.
       </simpara>
      </listitem>
     </itemizedlist>
    </para>
    <simpara>
     Les utilisateurs de PWS et IIS 3 sont prêts à utiliser
     leur serveur. Avec IIS 3, vous pouvez utiliser un <ulink
     url="&url.iiscfg;">outil</ulink> bien pratique de
     Steven Genusa pour configurer votre carte des scripts.
    </simpara>
    
   </sect2>

   <sect2 id="install.windows.iis.pws4">
    <title>Windows et PWS 4 ou plus récent</title>

    <simpara>
     Pour installer &php; sous Windows avec PWS 4 ou plus récent,
     vous avez deux options : l'une est d'avoir &php; sous
     forme de CGI, l'autre est d'utiliser les modules
     ISAPI, sous forme de DLL.
    </simpara>
     
    <para>
     Si vous optez pour le CGI, faites ceci :
     <itemizedlist>
      <listitem>
       <simpara>
        Editez le fichier <filename>pws-php4cgi.reg</filename> /
        <filename>pws-php5cgi.reg</filename> (regardez dans le dossier SAPI pour &php;4 
        ou dans le dossier principal pour &php; 5) pour indiquer la localisation de votre
        fichier <filename>php.exe</filename> / <filename>php-cgi.exe</filename>.
        Les slash doivent être échappés. Par exemple :
        <literal>[HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Services\w3svc\parameters\Script
         Map] ".php"="C:\\php\\php.exe"</literal> (modifiez en
        <literal>C:\\php\\php-cgi.exe</literal> si vous utilisez &php; 5).
        Maintenant, intégrez ce fichier de registre dans votre système ; vous devriez 
        juste avoir à double cliquer dessus.
       </simpara>
      </listitem>
      <listitem>
       <simpara>
        Dans le gestionnaire PWS Manager, faites un clic droit sur les
        dossiers qui supporteront &php;, et sélectionnez "Properties".
        Cochez l'option "Execute" et confirmez.
       </simpara>
      </listitem>
     </itemizedlist>
    </para>

    <para>
     Si vous optez pour les modules ISAPI, faites ceci :
     <itemizedlist>
      <listitem>
       <simpara>
        Editez le fichier <filename>pws-php4isapi.reg</filename> /
        <filename>pws-php5cgi.reg</filename> (regardez dans le dossier SAPI pour &php;4 
        ou dans le dossier principal pour &php; 5) pour indiquer la localisation de votre
        fichier <filename>php4isapi.exe</filename> / 
        <filename>php5isapi-cgi.exe</filename>.
        Les slash doivent être échappés. Par exemple :
        <literal>[HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Services\w3svc\parameters\Script
         Map] ".php"="C:\\php\\sapi\\php4isapi.dll"</literal> (modifiez en
        <literal>C:\\php\\php5isapi.dll</literal> si vous utilisez &php; 5).
        Maintenant, intégrez ce fichier de registre dans votre système ; vous devriez 
        juste avoir à double cliquer dessus.
       
        Editez le fichier <filename>pws-php4isapi.reg</filename>
        (dans le dossier SAPI) pour indiquer la
        localisation de votre fichier <filename>php4isapi.dll</filename>.
        Les slash doivent être échappés. Par exemple :
        <literal>[HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Services\w3svc\parameters\Script Map] ".php"="c:\\php\\sapi\\php4isapi.dll"</literal>.
        Maintenant, intégrez ce fichier de registre dans votre système ; vous devriez 
        juste avoir à double cliquer dessus.
       </simpara>
      </listitem>
      <listitem>
       <simpara>
        Dans le gestionnaire PWS Manager, faites un clic droit sur les
        dossiers qui supporteront &php;, et sélectionnez "Properties".
        Cochez l'option "Execute" et confirmez.
       </simpara>
      </listitem>
     </itemizedlist>
    </para>

   </sect2>

   <sect2 id="install.windows.iis.iis4">
    <title>Windows NT/2000/XP et IIS 4 ou plus récent</title>

    <simpara>
     Pour installer &php; sous Windows  NT/2000/XP server avec IIS 4
     ou plus récent, vous avez deux options : l'une est d'avoir &php; sous
     forme de CGI (<filename>php.exe</filename> en &php; 4 ou
     <filename>php-cgi.exe</filename> en &php; 5), l'autre est d'utiliser les modules
     SAPI, sous forme de DLL.
    </simpara>
    
    <simpara>
     Dans les deux cas, vous devez lancer la console "Microsoft Management"
     (elle peut aussi s'appeler "Internet Services Manager". Elle est située
     soit dans "Windows NT 4.0 Option Pack" ou dans "Control
     Panel=&gt;Administrative Tools" sous Windows 2000). Puis, faites un
     clic droit sur votre dossier web (qui apparaitra probablement
     comme 'Default Web Server'), et sélectionnez "Properties".
    </simpara>

    <para>
     Si vous optez pour le CGI, faites ceci :
     <itemizedlist>
      <listitem>
       <simpara>
        Sous "Home Directory", "Virtual Directory", ou
        "Directory", cliquez sur le bouton "Configuration",
        et sélectionnez l'onglet "App Mappings".
       </simpara>
      </listitem>
      <listitem>
       <simpara>
        Cliquez sur "Add", puis dans la boîte "Executable", tapez :
        <literal>C:\php\php.exe</literal> pour &php; 4 ou
        <literal>C:\php\php-cgi.exe</literal> pour &php; 5 (si vous avez installé &php;
        dans le dossier <filename>c:\php\</filename>).
        </simpara>
      </listitem>
      <listitem>
       <simpara>
        Dans la boîte "Extension", tapez le nom de l'extension que vous voulez
        associer aux scripts &php;. Laissez "Method exclusions"
        vide, et cochez "Script engine". Vous pouvez aussi préférer cocher
        la boîte 'check that file exists' - pour un coût faible,
        IIS (ou PWS) s'assurera que le script existe, et résoudra
        les problèmes d'autentification avant de démarrer &php;.
        Cela signifie que vous obtiendrez des messages d'erreur 404 intelligents,
        plutôt que d'avoir simplement une plainte du serveur comme quoi les
        CGI n'ont rien retourné.
       </simpara>
       <simpara>
        Répétez les étapes 3 et 4 pour chaque extension que vous
        souhaitez associer aux scripts &php;.
        <literal>.php</literal> et <literal>.phtml</literal>
        sont les plus répandues mais aussi <literal>.php3</literal>
        peut être requis pour des applications.
       </simpara>
      </listitem>
      <listitem>
       <simpara>
        Configurer la sécurité nécessaire (dans "Internet
        Service Manager"), et si votre serveur NT utilise NTFS,
        ajoutez les droits adéquats pour I_USR_, au dossier qui
        contient <filename>php.exe</filename> / <filename>php-cgi.exe</filename>.
       </simpara>
      </listitem>
     </itemizedlist>
    </para>
    
    <para>
     Si vous optez pour les modules ISAPI, faites ceci :
     <itemizedlist>
      <listitem>
       <simpara>
        Si vous ne voulez pas effectuer des authentifications HTTP avec
        &php;, vous pouvez (et devez) sauter cette étape. Avec
        ISAPI Filters, ajoutez un nouveau filtre ISAPI. Utilisez
        &php; comme nom de filtre, et ajoutez simplement le chemin
        jusqu'à <filename>php4isapi.dll</filename>.
       </simpara>
      </listitem>
      <listitem>
       <simpara>
        Sous "Home Directory", cliquez sur le bouton "Configuration".
        Ajoutez une nouvelle entrée dans "Application Mappings". Utilisez le
        chemin jusqu'à <filename>php4isapi.dll</filename> /
        <filename>php5isapi.dll</filename> comme "Executable",
        indiquez <literal>.php</literal> comme extension, laissez 
        "<literal>Method exclusions</literal>" vide, et
        cochez "<literal>Script engine</literal>".
       </simpara>
      </listitem>
      <listitem>
       <simpara>
        Arrêtez totalement IIS (<literal>NET STOP iisadmin</literal>)
       </simpara>
      </listitem>
      <listitem>
       <simpara>
        Démarrez IIS (<literal>NET START w3svc</literal>)
       </simpara>
      </listitem>
     </itemizedlist>
    </para>
   </sect2>
  </sect1>

<!-- Keep this comment at the end of the file
Local variables:
mode: sgml
sgml-omittag:t
sgml-shorttag:t
sgml-minimize-attributes:nil
sgml-always-quote-attributes:t
sgml-indent-step:1
sgml-indent-data:t
indent-tabs-mode:nil
sgml-parent-document:nil
sgml-default-dtd-file:"../../manual.ced"
sgml-exposed-tags:nil
sgml-local-catalogs:nil
sgml-local-ecat-files:nil
End:
vim600: syn=xml fen fdm=syntax fdl=2 si
vim: et tw=78 syn=sgml
vi: ts=1 sw=1
-->
