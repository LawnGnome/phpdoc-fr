<?xml version="1.0" encoding="iso-8859-1"?>
<!-- $Revision: 1.1 $ -->
<!-- EN-Revision: 1.8 Maintainer: yannick Status: ready -->
   <sect1 id="install.windows.manual">
    <title>Installation manuelle sous Windows</title>
    
    <para>
     Ce guide d'installation vous aide à installer manuellement et configurer
     &php; sur votre serveur web Windows. 
     Vous devrez télécharger la distribution binaire Zip sur la page
     <ulink url="&url.php.downloads;">&url.php.downloads;</ulink>.
    </para>
    
    <para>
     Bien qu'il existe des installeurs et que nous fournissons également un installeur
     pour Microsoft Windows, nous vous recommandons de prendre le temps de lire ceci
     et d'installer &php; vous-même, ce qui est la meilleur façon d'apprendre le système,
     et vous permettera d'installer des extensions &php; facilement lorsque vous
     en aurez besoin.
    </para>
    
    <note id="install.windows.manual.upgrade">
     <title>Upgrading from a previous PHP version</title>
     <para>
      Les précédentes éditions de ce manuel vous suggéraient de déplacer les fichiers
      ini et les DLLs en dehors de vos répertoires et de ce fait, vous aviez des fichiers
      relatifs à &php; dans de multiples dossiers sur votre disque dur. Nous vous conseillons
      d'effacer tous ces fichiers (php.ini depuis le répertoire système de Windows, 
      les librairies DLLs relatives à &php; depuis le répertoire système de Windows),
      avant de commencer l'installation. Assurez vous que vous avez effectuer des 
      sauvegardes de ces librairies DLLs, sinon, vous risquez de corrompte la totalité de 
      votre système. L'ancien fichier ini peut également vous aider à configurer
      votre nouvelle installation de &php;.
     </para>
    </note>
    
    <note>
     <title>Pré-requis MDAC</title>
     <para>
      Si vous utilisez Microsoft <emphasis>Windows 9x/NT4</emphasis>, téléchargez
      la dernière version de Microsoft Data Access Components (MDAC) pour votre
      plate-forme. MDAC est disponible à <ulink url="&url.mdac;">&url.mdac;</ulink>.
     </para>
    </note>
    
    <para>
     Voici les différentes étapes d'installation avant les
     étapes spécifiques au serveur.
     <itemizedlist>
      <listitem>
       <para>
        Extrayez la distribution dans un dossier de votre choix,
        par exemple <filename class="directory">c:\</filename>. L'archive zip devient un
        dossier appelé <filename>php-4.3.7-Win32</filename> qui est supposé être
        renommé en <filename>php</filename>. Par sourci de clarté, nous supposerons
        alors que vous avez placé votre distribution dans le dossier 
        <filename class="directory">C:\php</filename>. 
        Vous pouvez choisir un autre dossier, mais vous
        serez prudents d'éviter les espaces dans le nom du chemin au dossier 
        (par exemple <filename class="directory">C:\program files\php</filename> 
        n'est pas une bonne idée), 
        car certains serveurs web vont crasher sinon. La structure du dossier que vous
        avez extrait ressemble à ceci :
       </para>
       <example>
        <title>Structure de la distribution Windows de &php; 4</title>
        <programlisting>
<![CDATA[

c:\php
   |
   +--cli
   |  |
   |  |-php.exe           -- Executable CLI - UNIQUEMENT pour la ligne de commande
   |
   +--dlls                -- DLL de support des extensions  --> dossier systeme Windows
   |  |
   |  |-expat.dll
   |  |
   |  |-fdftk.dll
   |  |
   |  |-...
   |
   +--extensions          -- extensions DLL pour PHP
   |  |
   |  |-php_bz2.dll
   |  |
   |  |-php_cpdf.dll
   |  |
   |  |-..
   |
   +--mibs                -- fichiers de support de SNMP
   |
   +--openssl             -- fichiers de support de Openssl
   |
   +--pdf-related         -- fichiers de support de PDF
   |
   +--sapi                -- DLL SAPI
   |  |
   |  |-php4activescript.dll
   |  |
   |  |-php4apache.dll
   |  |
   |  |-php4apache2.dll
   |  |
   |  |-..
   |
   +--PEAR                -- copie initiale de PEAR
   |
   |
   |-go-pear.bat          -- script de configuration de PEAR
   |
   |-..
   |
   |-php.exe              -- exécutable CGI
   |
   |-..
   |
   |-php.ini-dist         -- paramètres par défaut du php.ini
   |
   |-php.ini-recommended  -- paramètres recommandés du php.ini
   | 
   |-php4ts.dll           -- DLL principale
   | 
   |-...

]]>
        </programlisting>
       </example> 
       <para>
        Dans le cas où vous avez téléchargé et extrait &php; 5, ce dossier aura une structure
        légèrement différente :
       </para>
       <example>
        <title>Structure du paquet &php; 5</title>
        <programlisting>
<![CDATA[

c:\php
   |
   +--dev
   |  |
   |  |-php5ts.lib
   |
   +--ext                 -- extension DLLs pour PHP
   |  |
   |  |-php_bz2.dll
   |  |
   |  |-php_cpdf.dll
   |  |
   |  |-..
   |
   +--extras
   |  |
   |  +--mibs             -- fichiers de support de SNMP
   |  |
   |  +--openssl          -- fichiers de support de Openssl
   |  |
   |  +--pdf-related      -- fichiers de support de PDF
   |  |
   |  |-mime.magic
   |
   +--pear                -- copie initiale de PEAR
   |
   |
   |-go-pear.bat          -- script de configuration de PEAR
   |
   |-fdftk.dll
   |
   |-..
   |
   |-php-cgi.exe          -- exécutable CGI
   |
   |-php-win.exe          -- permet d'exécuter des scripts sans ouvrir un fenêtre de prompt
   |
   |-php.exe              -- exécutable CLI - UNIQUEMENT pour du script en ligne de commande
   |
   |-..
   |
   |-php.ini-dist         -- paramètres par défaut du php.ini
   |
   |-php.ini-recommended  -- paramètres recommandés du php.ini
   | 
   |-php5activescript.dll
   | 
   |-..
   |
   |-php5ts.dll           -- DLL principale
   | 
   |-...

]]>
        </programlisting>
       </example> 
    
       <para>
        Notez que &php; 4 t &php; 5 pour Windows ont tous les deux un exécutable CGI,
        un exéctuable CLI et des modules serveurs, mais qu'ils sont situés dans des dossiers
        différents. En &php; 4, les modules serveurs se trouvent dans le dossier SAPI,
        tandis qu'ils se trouvent dans le répertoire PHP en &php; 5.
        Le support des DLLs pour les extensions de &php; sont également dans le dossier
        principal en &php; 5. Observez l'arborescence pour connaître l'emplacement
        des exécutables CGI et CLI.
       </para>
       <para>
        Voici une liste de modules serveur avec la correspondance entre &php; 4 et &php; 5.
        <simplelist>
         <member>
          <filename>sapi/php4activescript.dll (php5activescript.dll)</filename> -
          <link linkend="install.windows.activescript">moteur ActiveScript</link>,
          permet d'intégrer &php; dans vos applications Windows.
         </member>
         <member>
          <filename>sapi/php4apache.dll (php5apache.dll)</filename> - 
          module Apache 1.3.x.
         </member>
         <member>
          <filename>sapi/php4apache2.dll (php5apache2.dll)</filename> - 
          module Apache 2.0.x.
         </member>
         <member>
          <filename>sapi/php4isapi.dll (php5isapi.dll)</filename> - 
          module ISAPI pour les serveurs  ISAPI compliant comme IIS 4.0/PWS 4.0 ou autres.
         </member>
         <member>
          <filename>sapi/php4nsapi.dll (php5nsapi.dll)</filename> - 
          module serveur Sun/iPlanet/Netscape.
         </member>
         <member>
          <filename>sapi/php4pi3web.dll (aucun équivalent en &php; 5)</filename> - 
          module serveur Pi3Web.
         </member>
         <!-- TODO: servlets? -->
        </simplelist>
       </para>
       <para>
        Les modules serveurs permettent des gains de performances et quelques 
        fonctionnalités supplémentaires par rapport à la version CGI.
        La version CLI est destinée à être utilisée pour les scripts en ligne de commande.
        Plus d'informations sur la version CLI est disponible dans le chapitre à propos
        "<link linkend="features.commandline">utilisez &php; en ligne de 
        commande</link>".
       </para>
       <warning>
        <simpara>
         Les modules SAPI ont été significativement
         améliorés dans la version
         4.1, mais vous pourrez rencontrer des erreurs avec le serveur ou
         d'autres modules (tels ASP), dans les systèmes plus anciens.
        </simpara>
       </warning>

       <para>
        Les binaires CGI et CLI et les modules des serveurs web requierent tous la librairie
        <filename>php4ts.dll</filename> (<filename>php5ts.dll</filename>).
        Vous devez vous assurer que ce fichier peut être trouvé par votre installation
        de &php;. Le dossier où ce fichier sera recherché suivit ces règles :
        <simplelist>
         <member>
          Le même dossier où se trouve le fichier <filename>php.exe</filename>.
          Dans ce cas, vous utilisez pour le module SAPI le même dossier d'où sont
          chargés les librairies DLLs pour votre serveur web
          (e.g. <filename>php4apache.dll</filename>).
         </member>
         <member>
          N'importe quel dossier de votre <varname>PATH</varname> de votre 
          environnement de variables Windows.
         </member>
        </simplelist>
       </para>
       
<!--
 WARNING: the instructions presented below still need serious revision!!!!!!!
 Refer to http://lxr.php.net/source/php-src/main/php_ini.c#262 for more information
 on how the ini file is located on the system. This needs to be integrated to the
 ini part too!
 -->
       
       <para>
        The best bet is to make <filename>php4ts.dll</filename> available,
        regardless which interface (CGI or SAPI module) you plan to use. To do so,
        you have to copy this dll to a directory on your Windows path. The best
        place is your Windows system directory:
        <simplelist>
         <member>
          <filename class="directory">C:\Windows\System</filename> for Windows 9x/ME
         </member>
         <member>
          <filename class="directory">C:\WINNT\System32</filename> for Windows NT/2000 or
          <filename class="directory">C:\WINNT40\System32</filename> for NT/2000 server
         </member>
         <member>
          <filename class="directory">C:\Windows\System32</filename> for Windows XP
         </member>
        </simplelist>
        If you plan to use a SAPI module from <filename class="directory">c:\php\sapi</filename>
        and do not like to copy dlls to your Windows system directory, you have
        the alternative choice to simply copy <filename>php4ts.dll</filename> to
        the sapi folder of your extracted zip package,
        <filename class="directory">c:\php\sapi</filename>.
       </para>
      </listitem>
      <listitem>
       <para>
        The next step is to set up a valid configuration file for PHP, &php.ini;.
        There are two ini files distributed in the zip file,
        <filename>php.ini-dist</filename> and
        <filename>php.ini-recommended</filename>. We advise you to use
        <filename>php.ini-recommended</filename>, because we optimized the
        default settings in this file for performance, and security. Read this
        well documented file carefully and in addition study the
        <link linkend="configuration.file">ini settings</link> and set every
        element manually yourself. If you would like to achieve the best
        security, then this is the way for you, although PHP works fine with
        these default ini files. Copy your chosen ini-file to a directory where
        PHP is able to find and rename it to &php.ini;. By default PHP searches
        &php.ini; in your Windows directory:
        <simplelist>
         <member>
          On Windows 9x/ME/XP copy your chosen ini file to your
         <filename> %WINDIR%</filename>, which is typically
         <filename class="directory">C:\Windows</filename>.
         </member>
         <member>
          On Windows NT/2000 copy your chosen ini file to your
          <filename>%WINDIR%</filename> or <filename>%SYSTEMROOT%</filename>,
          which is typically <filename class="directory">C:\WINNT</filename> or
         <filename class="directory">C:\WINNT40</filename> for NT/2000 servers.
         </member>
        </simplelist>   
       </para>
      </listitem>
      <listitem>
       <simpara>
        If you're using NTFS on Windows NT, 2000 or XP, make sure that
        the user running the webserver has read permissions to your
        &php.ini; (e.g. make it readable by Everyone).
       </simpara>
      </listitem>     
     </itemizedlist>
    </para>
    <para>
     The following steps are optional.
     <itemizedlist>      
      <listitem>
       <para>
        Edit your new &php.ini; file.       
        If you plan to use <link linkend="install.windows.omnihttpd">OmniHTTPd</link>,
        do not follow the next step. Set the
        <link linkend="ini.doc-root">doc_root</link> to point to your webservers
        document_root. For example:
        <informalexample>
          <programlisting role="ini">
<![CDATA[
doc_root = c:\inetpub        // for IIS/PWS

doc_root = c:\apache\htdocs // for Apache
]]>
         </programlisting>
        </informalexample>
       </para>
      </listitem>
      <listitem>
       <simpara>
        Choose which extensions you would like to load when PHP starts. See
        the section about
        <link linkend="install.windows.extensions">Windows extensions</link>,
        about how to set up one, and what is already built in. Note that on
        a new installation it is advisable to first get PHP working and tested
        without any extensions before enabling them in &php.ini;.
       </simpara>
      </listitem>
      <listitem>
       <simpara>
        On PWS and IIS, you can set the
        <link linkend="ini.browscap">browscap</link> configuration setting
        to point to:
        <filename>c:\windows\system\inetsrv\browscap.ini</filename> on
        Windows 9x/Me,
        <filename>c:\winnt\system32\inetsrv\browscap.ini</filename> on
        NT/2000, and
        <filename>c:\windows\system32\inetsrv\browscap.ini</filename>
        on XP.
       </simpara>
      </listitem>
     </itemizedlist>
    </para> 
    <para>
     Following this instructions you are done with the basic steps to setup PHP
     on Windows. The next step is to choose a webserver and enable it to run
     PHP. Pick a webserver from the table of contents.
    </para>
   </sect1>

<!-- Keep this comment at the end of the file
Local variables:
mode: sgml
sgml-omittag:t
sgml-shorttag:t
sgml-minimize-attributes:nil
sgml-always-quote-attributes:t
sgml-indent-step:1
sgml-indent-data:t
indent-tabs-mode:nil
sgml-parent-document:nil
sgml-default-dtd-file:"../../manual.ced"
sgml-exposed-tags:nil
sgml-local-catalogs:nil
sgml-local-ecat-files:nil
End:
vim600: syn=xml fen fdm=syntax fdl=2 si
vim: et tw=78 syn=sgml
vi: ts=1 sw=1
-->
